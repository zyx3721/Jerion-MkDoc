
<!doctype html>
<html lang="zh" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="记录相关知识，沉淀生活，记录点滴。">
      
      
        <meta name="author" content="Jerion">
      
      
        <link rel="canonical" href="https://jerion.cn/docker/docker-deploy/docker%20%E9%83%A8%E7%BD%B2django/">
      
      
        <link rel="prev" href="../docker%20%E9%83%A8%E7%BD%B2IT-Tools/">
      
      
        <link rel="next" href="../docker%20%E9%83%A8%E7%BD%B2dockerNAS/">
      
      
        <link rel="alternate" type="application/rss+xml" title="RSS 订阅" href="../../../feed_rss_created.xml">
        <link rel="alternate" type="application/rss+xml" title="已更新内容的 RSS 订阅" href="../../../feed_rss_updated.xml">
      
      <link rel="icon" href="../../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.5.33">
    
    
      
        <title>docker 部署django - Jerion's Blog</title>
      
    
    
      <link rel="stylesheet" href="../../../assets/stylesheets/main.3cba04c6.min.css">
      
        
        <link rel="stylesheet" href="../../../assets/stylesheets/palette.06af60db.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Microsoft+Yahei:300,300i,400,400i,700,700i%7CConsolas,Courier,courier+new,stkaiti,kaiti,simkai,monospace:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Microsoft Yahei";--md-code-font:"Consolas,Courier,courier new,stkaiti,kaiti,simkai,monospace"}</style>
      
    
    
      <link rel="stylesheet" href="../../../css/extra.css">
    
    <script>__md_scope=new URL("../../..",location),__md_hash=e=>[...e].reduce((e,_)=>(e<<5)-e+_.charCodeAt(0),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      
  


  <script async src="https://umami.weiyan.cc/script.js" data-website-id="b713abc7-f5eb-4683-a132-9fda53e29198"></script>
<script charset="UTF-8" id="LA_COLLECT" src="//sdk.51.la/js-sdk-pro.min.js"></script>
<script>LA.init({id:"3JIbgFniDcGIaNP7",ck:"3JIbgFniDcGIaNP7",autoTrack:true})</script>
  
    <script>"undefined"!=typeof __md_analytics&&__md_analytics()</script>
  

    
    
    
   <meta name="baidu-site-verification" content="codeva-hJH2gPjZkn" />

   <link href="../../../assets/stylesheets/glightbox.min.css" rel="stylesheet"/><style>
    html.glightbox-open { overflow: initial; height: 100%; }
    .gslide-title { margin-top: 0px; user-select: text; }
    .gslide-desc { color: #666; user-select: text; }
    .gslide-image img { background: white; }
    .gscrollbar-fixer { padding-right: 15px; }
    .gdesc-inner { font-size: 0.75rem; }
    body[data-md-color-scheme="slate"] .gdesc-inner { background: var(--md-default-bg-color);}
    body[data-md-color-scheme="slate"] .gslide-title { color: var(--md-default-fg-color);}
    body[data-md-color-scheme="slate"] .gslide-desc { color: var(--md-default-fg-color);}</style> <script src="../../../assets/javascripts/glightbox.min.js"></script></head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="grey" data-md-color-accent="deep-orange">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#docker-部署django" class="md-skip">
          跳转至
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="页眉">
    <a href="../../.." title="Jerion&#39;s Blog" class="md-header__button md-logo" aria-label="Jerion's Blog" data-md-component="logo">
      
  <img src="../../../assets/octocat.jpg" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Jerion's Blog
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              docker 部署django
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="" data-md-color-scheme="default" data-md-color-primary="grey" data-md-color-accent="deep-orange"  aria-label="切换到暗色模式"  type="radio" name="__palette" id="__palette_0">
    
      <label class="md-header__button md-icon" title="切换到暗色模式" for="__palette_1" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="m17.75 4.09-2.53 1.94.91 3.06-2.63-1.81-2.63 1.81.91-3.06-2.53-1.94L12.44 4l1.06-3 1.06 3 3.19.09m3.5 6.91-1.64 1.25.59 1.98-1.7-1.17-1.7 1.17.59-1.98L15.75 11l2.06-.05L18.5 9l.69 1.95 2.06.05m-2.28 4.95c.83-.08 1.72 1.1 1.19 1.85-.32.45-.66.87-1.08 1.27C15.17 23 8.84 23 4.94 19.07c-3.91-3.9-3.91-10.24 0-14.14.4-.4.82-.76 1.27-1.08.75-.53 1.93.36 1.85 1.19-.27 2.86.69 5.83 2.89 8.02a9.96 9.96 0 0 0 8.02 2.89m-1.64 2.02a12.08 12.08 0 0 1-7.8-3.47c-2.17-2.19-3.33-5-3.49-7.82-2.81 3.14-2.7 7.96.31 10.98 3.02 3.01 7.84 3.12 10.98.31Z"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="" data-md-color-scheme="slate" data-md-color-primary="grey" data-md-color-accent="deep-orange"  aria-label="切换到亮色模式"  type="radio" name="__palette" id="__palette_1">
    
      <label class="md-header__button md-icon" title="切换到亮色模式" for="__palette_0" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 7a5 5 0 0 1 5 5 5 5 0 0 1-5 5 5 5 0 0 1-5-5 5 5 0 0 1 5-5m0 2a3 3 0 0 0-3 3 3 3 0 0 0 3 3 3 3 0 0 0 3-3 3 3 0 0 0-3-3m0-7 2.39 3.42C13.65 5.15 12.84 5 12 5c-.84 0-1.65.15-2.39.42L12 2M3.34 7l4.16-.35A7.2 7.2 0 0 0 5.94 8.5c-.44.74-.69 1.5-.83 2.29L3.34 7m.02 10 1.76-3.77a7.131 7.131 0 0 0 2.38 4.14L3.36 17M20.65 7l-1.77 3.79a7.023 7.023 0 0 0-2.38-4.15l4.15.36m-.01 10-4.14.36c.59-.51 1.12-1.14 1.54-1.86.42-.73.69-1.5.83-2.29L20.64 17M12 22l-2.41-3.44c.74.27 1.55.44 2.41.44.82 0 1.63-.17 2.37-.44L12 22Z"/></svg>
      </label>
    
  
</form>
      
    
    
      <script>var media,input,key,value,palette=__md_get("__palette");if(palette&&palette.color){"(prefers-color-scheme)"===palette.color.media&&(media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']"),palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent"));for([key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="搜索" placeholder="搜索" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="查找">
        
          <a href="javascript:void(0)" class="md-search__icon md-icon" title="分享" aria-label="分享" data-clipboard data-clipboard-text="" data-md-component="search-share" tabindex="-1">
            
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M18 16.08c-.76 0-1.44.3-1.96.77L8.91 12.7c.05-.23.09-.46.09-.7 0-.24-.04-.47-.09-.7l7.05-4.11c.54.5 1.25.81 2.04.81a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3c0 .24.04.47.09.7L8.04 9.81C7.5 9.31 6.79 9 6 9a3 3 0 0 0-3 3 3 3 0 0 0 3 3c.79 0 1.5-.31 2.04-.81l7.12 4.15c-.05.21-.08.43-.08.66 0 1.61 1.31 2.91 2.92 2.91 1.61 0 2.92-1.3 2.92-2.91A2.92 2.92 0 0 0 18 16.08Z"/></svg>
          </a>
        
        <button type="reset" class="md-search__icon md-icon" title="清空当前内容" aria-label="清空当前内容" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41Z"/></svg>
        </button>
      </nav>
      
        <div class="md-search__suggest" data-md-component="search-suggest"></div>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            正在初始化搜索引擎
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header__source">
        <a href="https://github.com/zyx3721/Jerion-MkDoc" title="前往仓库" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.6.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    Jerion-MkDoc
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
            
<nav class="md-tabs" aria-label="标签" data-md-component="tabs">
  <div class="md-grid">
    <ul class="md-tabs__list">
      
        
  
  
  
    <li class="md-tabs__item">
      <a href="../../.." class="md-tabs__link">
        
  
    
  
  首页

      </a>
    </li>
  

      
        
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../../blog/" class="md-tabs__link">
          
  
    
  
  博客

        </a>
      </li>
    
  

      
        
  
  
  
    
    
      
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../../linux/Ansible/Ansible%E5%AE%89%E8%A3%85%E9%83%A8%E7%BD%B2%E4%BD%BF%E7%94%A8/" class="md-tabs__link">
          
  
    
  
  Linux

        </a>
      </li>
    
  

    
  

      
        
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../../shell/" class="md-tabs__link">
          
  
    
  
  Shell

        </a>
      </li>
    
  

      
        
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../../vmware/Esxi6.7%E5%AE%89%E8%A3%85MacOS%2010.15.6/" class="md-tabs__link">
          
  
    
  
  VMware

        </a>
      </li>
    
  

      
        
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../../python/Python%E5%8F%8APycharm%E5%AE%89%E8%A3%85%E6%95%99%E7%A8%8B/" class="md-tabs__link">
          
  
    
  
  Python

        </a>
      </li>
    
  

      
        
  
  
    
  
  
    
    
      
  
  
    
  
  
    
    
      
  
  
    
  
  
    
    
      <li class="md-tabs__item md-tabs__item--active">
        <a href="../deploy-blog/docker%20%E5%AE%89%E8%A3%85typecho%E5%8D%9A%E5%AE%A2/" class="md-tabs__link">
          
  
    
  
  Docker

        </a>
      </li>
    
  

    
  

    
  

      
        
  
  
  
    
    
      
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../../routeswitch/Cisio/%E5%8D%95%E8%87%82%E8%B7%AF%E7%94%B1/" class="md-tabs__link">
          
  
    
  
  路由交换

        </a>
      </li>
    
  

    
  

      
        
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../../synology/VSP%20%E5%AE%89%E8%A3%85%E9%BB%91%E7%BE%A4%E6%99%96/" class="md-tabs__link">
          
  
    
  
  群晖

        </a>
      </li>
    
  

      
        
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../../sql/PostgreSQL%20%E6%95%B0%E6%8D%AE%E5%BA%93%E6%93%8D%E4%BD%9C/" class="md-tabs__link">
          
  
    
  
  数据库

        </a>
      </li>
    
  

      
        
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../../bat/git/" class="md-tabs__link">
          
  
    
  
  批处理

        </a>
      </li>
    
  

      
        
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../../k8s/" class="md-tabs__link">
          
  
    
  
  K8S

        </a>
      </li>
    
  

      
        
  
  
  
    
    
      
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../../git/Git/Git%20Extensions%E4%BD%BF%E7%94%A8%E6%96%87%E6%A1%A3/" class="md-tabs__link">
          
  
    
  
  Git

        </a>
      </li>
    
  

    
  

      
        
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../../essay/" class="md-tabs__link">
          
  
    
  
  随笔

        </a>
      </li>
    
  

      
    </ul>
  </div>
</nav>
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


  


<nav class="md-nav md-nav--primary md-nav--lifted" aria-label="导航栏" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../../.." title="Jerion&#39;s Blog" class="md-nav__button md-logo" aria-label="Jerion's Blog" data-md-component="logo">
      
  <img src="../../../assets/octocat.jpg" alt="logo">

    </a>
    Jerion's Blog
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/zyx3721/Jerion-MkDoc" title="前往仓库" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.6.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    Jerion-MkDoc
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../.." class="md-nav__link">
        
  
  <span class="md-ellipsis">
    首页
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
          
        
      
    
    
      
      
        
      
    
    
      
        
        
      
    
    <li class="md-nav__item md-nav__item--pruned md-nav__item--nested">
      
        
  
  
    <a href="../../../blog/" class="md-nav__link">
      
  
  <span class="md-ellipsis">
    博客
  </span>
  

      
        <span class="md-nav__icon md-icon"></span>
      
    </a>
  

      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
      
        
      
        
          
        
      
    
    
      
      
        
      
    
    
      
        
        
      
    
    <li class="md-nav__item md-nav__item--pruned md-nav__item--nested">
      
        
  
  
    
  
  
    <a href="../../../linux/Ansible/Ansible%E5%AE%89%E8%A3%85%E9%83%A8%E7%BD%B2%E4%BD%BF%E7%94%A8/" class="md-nav__link">
      
  
  <span class="md-ellipsis">
    Linux
  </span>
  

      
        <span class="md-nav__icon md-icon"></span>
      
    </a>
  

  

      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
          
        
      
        
      
        
      
    
    
      
      
        
      
    
    
      
        
        
      
    
    <li class="md-nav__item md-nav__item--pruned md-nav__item--nested">
      
        
  
  
    <a href="../../../shell/" class="md-nav__link">
      
  
  <span class="md-ellipsis">
    Shell
  </span>
  

      
        <span class="md-nav__icon md-icon"></span>
      
    </a>
  

      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
      
        
      
        
      
        
          
        
      
        
      
        
      
    
    
      
      
        
      
    
    
      
        
        
      
    
    <li class="md-nav__item md-nav__item--pruned md-nav__item--nested">
      
        
  
  
    <a href="../../../vmware/Esxi6.7%E5%AE%89%E8%A3%85MacOS%2010.15.6/" class="md-nav__link">
      
  
  <span class="md-ellipsis">
    VMware
  </span>
  

      
        <span class="md-nav__icon md-icon"></span>
      
    </a>
  

      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
      
        
      
        
      
        
          
        
      
        
      
        
      
        
      
    
    
      
      
        
      
    
    
      
        
        
      
    
    <li class="md-nav__item md-nav__item--pruned md-nav__item--nested">
      
        
  
  
    <a href="../../../python/Python%E5%8F%8APycharm%E5%AE%89%E8%A3%85%E6%95%99%E7%A8%8B/" class="md-nav__link">
      
  
  <span class="md-ellipsis">
    Python
  </span>
  

      
        <span class="md-nav__icon md-icon"></span>
      
    </a>
  

      
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
      
        
      
        
      
        
          
        
      
    
    
      
        
        
      
      
        
      
    
    
      
    
    <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_7" checked>
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../../" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    Docker
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_7" id="__nav_7_label" tabindex="">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_7_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_7">
            <span class="md-nav__icon md-icon"></span>
            Docker
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
    
  
  
  
    
    
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
      
      
        
          
          
        
      
    
    
      
    
    <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_7_1" checked>
        
          
          <label class="md-nav__link" for="__nav_7_1" id="__nav_7_1_label" tabindex="">
            
  
  <span class="md-ellipsis">
    Docker deploy
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_7_1_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_7_1">
            <span class="md-nav__icon md-icon"></span>
            Docker deploy
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    
    
      
        
      
        
      
        
      
        
      
    
    
      
      
        
      
    
    
      
        
        
      
    
    <li class="md-nav__item md-nav__item--pruned md-nav__item--nested">
      
        
  
  
    <a href="../deploy-blog/docker%20%E5%AE%89%E8%A3%85typecho%E5%8D%9A%E5%AE%A2/" class="md-nav__link">
      
  
  <span class="md-ellipsis">
    Deploy blog
  </span>
  

      
        <span class="md-nav__icon md-icon"></span>
      
    </a>
  

      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
        
      
        
      
        
      
        
      
    
    
      
      
        
      
    
    
      
        
        
      
    
    <li class="md-nav__item md-nav__item--pruned md-nav__item--nested">
      
        
  
  
    <a href="../deploy-reader%20%26%20music/docker%20%E9%83%A8%E7%BD%B2Koodo%20Reader/" class="md-nav__link">
      
  
  <span class="md-ellipsis">
    Deploy reader & music
  </span>
  

      
        <span class="md-nav__icon md-icon"></span>
      
    </a>
  

      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../docker%20compose%E5%AE%89%E8%A3%85%E5%8F%8A%E5%8F%82%E6%95%B0%E8%AF%B4%E6%98%8E/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    docker compose安装及参数说明
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../docker%20%E5%AE%89%E8%A3%85KeyManager/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    docker 安装KeyManager
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../docker%20%E9%83%A8%E7%BD%B2IT-Tools/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    docker 部署IT-Tools
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  <span class="md-ellipsis">
    docker 部署django
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  <span class="md-ellipsis">
    docker 部署django
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="目录">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      目录
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#1django安装目录结构" class="md-nav__link">
    <span class="md-ellipsis">
      （1）django安装目录结构
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#2dockerfile与各项配置" class="md-nav__link">
    <span class="md-ellipsis">
      （2）Dockerfile与各项配置
    </span>
  </a>
  
    <nav class="md-nav" aria-label="（2）Dockerfile与各项配置">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#1编写docker-composeyml" class="md-nav__link">
    <span class="md-ellipsis">
      （1）编写docker-compose.yml
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#2编写djangouwsgi的dockerfile" class="md-nav__link">
    <span class="md-ellipsis">
      （2）编写Django+Uwsgi的Dockerfile：
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#3编写startsh启动脚本文件" class="md-nav__link">
    <span class="md-ellipsis">
      （3）编写start.sh启动脚本文件
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#4配置-uwsgiini-配置文件" class="md-nav__link">
    <span class="md-ellipsis">
      （4）配置 uwsgi.ini 配置文件
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#5编辑env文件" class="md-nav__link">
    <span class="md-ellipsis">
      （5）编辑.env文件
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#6django项目所依赖requirementstxt" class="md-nav__link">
    <span class="md-ellipsis">
      （6）Django项目所依赖requirements.txt
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#7编写nginx镜像和容器所需文件" class="md-nav__link">
    <span class="md-ellipsis">
      （7）编写Nginx镜像和容器所需文件
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#1创建或编辑dockerfile" class="md-nav__link">
    <span class="md-ellipsis">
      1.创建或编辑Dockerfile：
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#2-创建nginx配置文件nginxconf" class="md-nav__link">
    <span class="md-ellipsis">
      2. 创建Nginx配置文件（nginx.conf）
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#8编写db-mysql容器配置文件" class="md-nav__link">
    <span class="md-ellipsis">
      （8）编写Db (MySQL)容器配置文件
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#9编写redis-容器配置文件" class="md-nav__link">
    <span class="md-ellipsis">
      （9）编写Redis 容器配置文件
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#1-创建redis配置文件" class="md-nav__link">
    <span class="md-ellipsis">
      1. 创建Redis配置文件
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#2-确保docker-compose使用redis配置文件" class="md-nav__link">
    <span class="md-ellipsis">
      2. 确保Docker-compose使用Redis配置文件
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#10配置pip" class="md-nav__link">
    <span class="md-ellipsis">
      （10）配置Pip
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#3构建镜像" class="md-nav__link">
    <span class="md-ellipsis">
      （3）构建镜像
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../docker%20%E9%83%A8%E7%BD%B2dockerNAS/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    docker 部署dockerNAS
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../docker%20%E9%83%A8%E7%BD%B2gitlab/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    docker 部署gitlab
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../docker%20%E9%83%A8%E7%BD%B2itops/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    docker 部署itops
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../docker%20%E9%83%A8%E7%BD%B2jumpserver/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    docker 部署jumpserver-v2.8.4
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../docker%20%E9%83%A8%E7%BD%B2jupyter/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    docker 部署jupyter
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../docker%20%E9%83%A8%E7%BD%B2nginx/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    docker 部署nginx
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../docker%20%E9%83%A8%E7%BD%B2redis%20-%20%E5%89%AF%E6%9C%AC/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    docker 部署redis - 副本
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../docker%20%E9%83%A8%E7%BD%B2redis/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    docker 部署redis
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../docker%20%E9%83%A8%E7%BD%B2smokeping/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    docker 部署SmokePing
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../docker%20%E9%83%A8%E7%BD%B2wizard/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    docker 部署wizard
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../docker%20%E9%83%A8%E7%BD%B2zabbix6/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    docker 部署zabbix6
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../shell%E4%B8%80%E9%94%AE%E9%83%A8%E7%BD%B2docker/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    shell一键部署docker
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
      
      
        
          
          
        
      
    
    
      
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_7_2" >
        
          
          <label class="md-nav__link" for="__nav_7_2" id="__nav_7_2_label" tabindex="">
            
  
  <span class="md-ellipsis">
    Docker note
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_7_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_7_2">
            <span class="md-nav__icon md-icon"></span>
            Docker note
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../docker-note/1%20docker%E6%A6%82%E5%BF%B5/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    docker概念
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../docker-note/2%20docker%E5%AE%89%E8%A3%85/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    docker安装
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../docker-note/3.1%20docker%E4%B8%8B%E8%BD%BD%E5%8A%A0%E9%80%9F/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    docker下载加速
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../docker-note/3.2%20Registry%E6%90%AD%E5%BB%BAdocker%E7%A7%81%E4%BB%93/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Registry搭建docker私仓
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../docker-note/3.3%20%E5%B0%86%E9%95%9C%E5%83%8F%E6%8E%A8%E9%80%81%E5%88%B0%E9%98%BF%E9%87%8C%E4%BA%91/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    将镜像推送到阿里云
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../docker-note/4%20%E9%95%9C%E5%83%8F%E5%91%BD%E4%BB%A4/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    镜像命令
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../docker-note/5%20%E5%AE%B9%E5%99%A8%E5%91%BD%E4%BB%A4/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    容器命令
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../docker-note/6%20%E9%83%A8%E7%BD%B2mysql/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    部署MySQL
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../docker-note/7%20%E9%83%A8%E7%BD%B2tomcat/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    部署Tomcat
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../docker-note/9%20Dockerfile/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Dockerfile
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../docker-note/19.1%20%E9%83%A8%E7%BD%B2OpenLDAP/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    部署OpenLDAP
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../docker-note/19.2%20%E9%83%A8%E7%BD%B2gogs/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    部署Gogs
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../docker-note/19.3%20%E9%83%A8%E7%BD%B2chatgpt/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    部署ChatGPT
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
      
        
      
        
      
        
      
        
          
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
      
      
        
      
    
    
      
        
        
      
    
    <li class="md-nav__item md-nav__item--pruned md-nav__item--nested">
      
        
  
  
    
  
  
    <a href="../../../routeswitch/Cisio/%E5%8D%95%E8%87%82%E8%B7%AF%E7%94%B1/" class="md-nav__link">
      
  
  <span class="md-ellipsis">
    路由交换
  </span>
  

      
        <span class="md-nav__icon md-icon"></span>
      
    </a>
  

  

      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
      
        
          
        
      
        
      
        
      
        
      
        
      
    
    
      
      
        
      
    
    
      
        
        
      
    
    <li class="md-nav__item md-nav__item--pruned md-nav__item--nested">
      
        
  
  
    <a href="../../../synology/VSP%20%E5%AE%89%E8%A3%85%E9%BB%91%E7%BE%A4%E6%99%96/" class="md-nav__link">
      
  
  <span class="md-ellipsis">
    群晖
  </span>
  

      
        <span class="md-nav__icon md-icon"></span>
      
    </a>
  

      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
      
        
          
        
      
    
    
      
      
        
      
    
    
      
        
        
      
    
    <li class="md-nav__item md-nav__item--pruned md-nav__item--nested">
      
        
  
  
    <a href="../../../sql/PostgreSQL%20%E6%95%B0%E6%8D%AE%E5%BA%93%E6%93%8D%E4%BD%9C/" class="md-nav__link">
      
  
  <span class="md-ellipsis">
    数据库
  </span>
  

      
        <span class="md-nav__icon md-icon"></span>
      
    </a>
  

      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
      
        
          
        
      
    
    
      
      
        
      
    
    
      
        
        
      
    
    <li class="md-nav__item md-nav__item--pruned md-nav__item--nested">
      
        
  
  
    <a href="../../../bat/git/" class="md-nav__link">
      
  
  <span class="md-ellipsis">
    批处理
  </span>
  

      
        <span class="md-nav__icon md-icon"></span>
      
    </a>
  

      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
          
        
      
        
      
        
      
    
    
      
      
        
      
    
    
      
        
        
      
    
    <li class="md-nav__item md-nav__item--pruned md-nav__item--nested">
      
        
  
  
    <a href="../../../k8s/" class="md-nav__link">
      
  
  <span class="md-ellipsis">
    K8S
  </span>
  

      
        <span class="md-nav__icon md-icon"></span>
      
    </a>
  

      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
      
        
      
        
      
        
          
        
      
    
    
      
      
        
      
    
    
      
        
        
      
    
    <li class="md-nav__item md-nav__item--pruned md-nav__item--nested">
      
        
  
  
    
  
  
    <a href="../../../git/Git/Git%20Extensions%E4%BD%BF%E7%94%A8%E6%96%87%E6%A1%A3/" class="md-nav__link">
      
  
  <span class="md-ellipsis">
    Git
  </span>
  

      
        <span class="md-nav__icon md-icon"></span>
      
    </a>
  

  

      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
          
        
      
        
      
    
    
      
      
        
      
    
    
      
        
        
      
    
    <li class="md-nav__item md-nav__item--pruned md-nav__item--nested">
      
        
  
  
    <a href="../../../essay/" class="md-nav__link">
      
  
  <span class="md-ellipsis">
    随笔
  </span>
  

      
        <span class="md-nav__icon md-icon"></span>
      
    </a>
  

      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="目录">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      目录
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#1django安装目录结构" class="md-nav__link">
    <span class="md-ellipsis">
      （1）django安装目录结构
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#2dockerfile与各项配置" class="md-nav__link">
    <span class="md-ellipsis">
      （2）Dockerfile与各项配置
    </span>
  </a>
  
    <nav class="md-nav" aria-label="（2）Dockerfile与各项配置">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#1编写docker-composeyml" class="md-nav__link">
    <span class="md-ellipsis">
      （1）编写docker-compose.yml
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#2编写djangouwsgi的dockerfile" class="md-nav__link">
    <span class="md-ellipsis">
      （2）编写Django+Uwsgi的Dockerfile：
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#3编写startsh启动脚本文件" class="md-nav__link">
    <span class="md-ellipsis">
      （3）编写start.sh启动脚本文件
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#4配置-uwsgiini-配置文件" class="md-nav__link">
    <span class="md-ellipsis">
      （4）配置 uwsgi.ini 配置文件
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#5编辑env文件" class="md-nav__link">
    <span class="md-ellipsis">
      （5）编辑.env文件
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#6django项目所依赖requirementstxt" class="md-nav__link">
    <span class="md-ellipsis">
      （6）Django项目所依赖requirements.txt
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#7编写nginx镜像和容器所需文件" class="md-nav__link">
    <span class="md-ellipsis">
      （7）编写Nginx镜像和容器所需文件
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#1创建或编辑dockerfile" class="md-nav__link">
    <span class="md-ellipsis">
      1.创建或编辑Dockerfile：
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#2-创建nginx配置文件nginxconf" class="md-nav__link">
    <span class="md-ellipsis">
      2. 创建Nginx配置文件（nginx.conf）
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#8编写db-mysql容器配置文件" class="md-nav__link">
    <span class="md-ellipsis">
      （8）编写Db (MySQL)容器配置文件
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#9编写redis-容器配置文件" class="md-nav__link">
    <span class="md-ellipsis">
      （9）编写Redis 容器配置文件
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#1-创建redis配置文件" class="md-nav__link">
    <span class="md-ellipsis">
      1. 创建Redis配置文件
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#2-确保docker-compose使用redis配置文件" class="md-nav__link">
    <span class="md-ellipsis">
      2. 确保Docker-compose使用Redis配置文件
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#10配置pip" class="md-nav__link">
    <span class="md-ellipsis">
      （10）配置Pip
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#3构建镜像" class="md-nav__link">
    <span class="md-ellipsis">
      （3）构建镜像
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  

  
  
    
      
    
    <a href="https://github.com/zyx3721/Jerion-MkDoc/raw/main/docs/docker/docker-deploy/docker 部署django.md" title="查看本页的源代码" class="md-content__button md-icon">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M17 18c.56 0 1 .44 1 1s-.44 1-1 1-1-.44-1-1 .44-1 1-1m0-3c-2.73 0-5.06 1.66-6 4 .94 2.34 3.27 4 6 4s5.06-1.66 6-4c-.94-2.34-3.27-4-6-4m0 6.5a2.5 2.5 0 0 1-2.5-2.5 2.5 2.5 0 0 1 2.5-2.5 2.5 2.5 0 0 1 2.5 2.5 2.5 2.5 0 0 1-2.5 2.5M9.27 20H6V4h7v5h5v4.07c.7.08 1.36.25 2 .49V8l-6-6H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h4.5a8.15 8.15 0 0 1-1.23-2Z"/></svg>
    </a>
  


<h1 id="docker-部署django">docker 部署django<a class="headerlink" href="#docker-部署django" title="Permanent link">&para;</a></h1>
<h2 id="1django安装目录结构">（1）django安装目录结构<a class="headerlink" href="#1django安装目录结构" title="Permanent link">&para;</a></h2>
<div class="language-python highlight"><span class="filename">Python</span><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1"></a><a href="#__codelineno-0-1"><span class="linenos" data-linenos=" 1 "></span></a><span class="p">[</span><span class="n">root</span><span class="nd">@zhongjl</span><span class="o">-</span><span class="n">test</span><span class="o">-</span><span class="mi">02</span> <span class="o">/</span><span class="p">]</span><span class="c1"># tree /data/compose </span>
<a id="__codelineno-0-2" name="__codelineno-0-2"></a><a href="#__codelineno-0-2"><span class="linenos" data-linenos=" 2 "></span></a><span class="o">/</span><span class="n">data</span><span class="o">/</span><span class="n">compose</span>
<a id="__codelineno-0-3" name="__codelineno-0-3"></a><a href="#__codelineno-0-3"><span class="linenos" data-linenos=" 3 "></span></a><span class="err">├──</span> <span class="n">deploy</span><span class="o">.</span><span class="n">sh</span>
<a id="__codelineno-0-4" name="__codelineno-0-4"></a><a href="#__codelineno-0-4"><span class="linenos" data-linenos=" 4 "></span></a><span class="err">├──</span> <span class="n">myproject</span>                   <span class="c1">#django启动目录</span>
<a id="__codelineno-0-5" name="__codelineno-0-5"></a><a href="#__codelineno-0-5"><span class="linenos" data-linenos=" 5 "></span></a><span class="err">│</span>   <span class="err">├──</span> <span class="n">docker</span><span class="o">-</span><span class="n">compose</span><span class="o">.</span><span class="n">yml</span>
<a id="__codelineno-0-6" name="__codelineno-0-6"></a><a href="#__codelineno-0-6"><span class="linenos" data-linenos=" 6 "></span></a><span class="err">│</span>   <span class="err">├──</span> <span class="n">Dockerfile</span>
<a id="__codelineno-0-7" name="__codelineno-0-7"></a><a href="#__codelineno-0-7"><span class="linenos" data-linenos=" 7 "></span></a><span class="err">│</span>   <span class="err">├──</span> <span class="n">media</span>
<a id="__codelineno-0-8" name="__codelineno-0-8"></a><a href="#__codelineno-0-8"><span class="linenos" data-linenos=" 8 "></span></a><span class="err">│</span>   <span class="err">├──</span> <span class="n">myproject</span>               <span class="c1">#django项目目录</span>
<a id="__codelineno-0-9" name="__codelineno-0-9"></a><a href="#__codelineno-0-9"><span class="linenos" data-linenos=" 9 "></span></a><span class="err">│</span>   <span class="err">│</span>   <span class="err">├──</span> <span class="n">manage</span><span class="o">.</span><span class="n">py</span>           <span class="c1">#启动脚本</span>
<a id="__codelineno-0-10" name="__codelineno-0-10"></a><a href="#__codelineno-0-10"><span class="linenos" data-linenos="10 "></span></a><span class="err">│</span>   <span class="err">│</span>   <span class="err">└──</span> <span class="n">myproject</span>
<a id="__codelineno-0-11" name="__codelineno-0-11"></a><a href="#__codelineno-0-11"><span class="linenos" data-linenos="11 "></span></a><span class="err">│</span>   <span class="err">│</span>       <span class="err">├──</span> <span class="n">asgi</span><span class="o">.</span><span class="n">py</span>
<a id="__codelineno-0-12" name="__codelineno-0-12"></a><a href="#__codelineno-0-12"><span class="linenos" data-linenos="12 "></span></a><span class="err">│</span>   <span class="err">│</span>       <span class="err">├──</span> <span class="fm">__init__</span><span class="o">.</span><span class="n">py</span>
<a id="__codelineno-0-13" name="__codelineno-0-13"></a><a href="#__codelineno-0-13"><span class="linenos" data-linenos="13 "></span></a><span class="err">│</span>   <span class="err">│</span>       <span class="err">├──</span> <span class="n">settings</span><span class="o">.</span><span class="n">py</span>
<a id="__codelineno-0-14" name="__codelineno-0-14"></a><a href="#__codelineno-0-14"><span class="linenos" data-linenos="14 "></span></a><span class="err">│</span>   <span class="err">│</span>       <span class="err">├──</span> <span class="n">urls</span><span class="o">.</span><span class="n">py</span>
<a id="__codelineno-0-15" name="__codelineno-0-15"></a><a href="#__codelineno-0-15"><span class="linenos" data-linenos="15 "></span></a><span class="err">│</span>   <span class="err">│</span>       <span class="err">└──</span> <span class="n">wsgi</span><span class="o">.</span><span class="n">py</span>
<a id="__codelineno-0-16" name="__codelineno-0-16"></a><a href="#__codelineno-0-16"><span class="linenos" data-linenos="16 "></span></a><span class="err">│</span>   <span class="err">├──</span> <span class="n">pip</span><span class="o">.</span><span class="n">conf</span>
<a id="__codelineno-0-17" name="__codelineno-0-17"></a><a href="#__codelineno-0-17"><span class="linenos" data-linenos="17 "></span></a><span class="err">│</span>   <span class="err">├──</span> <span class="n">requirements</span><span class="o">.</span><span class="n">txt</span>        <span class="c1">#安装依赖</span>
<a id="__codelineno-0-18" name="__codelineno-0-18"></a><a href="#__codelineno-0-18"><span class="linenos" data-linenos="18 "></span></a><span class="err">│</span>   <span class="err">├──</span> <span class="n">start</span><span class="o">.</span><span class="n">sh</span>
<a id="__codelineno-0-19" name="__codelineno-0-19"></a><a href="#__codelineno-0-19"><span class="linenos" data-linenos="19 "></span></a><span class="err">│</span>   <span class="err">├──</span> <span class="n">static</span>
<a id="__codelineno-0-20" name="__codelineno-0-20"></a><a href="#__codelineno-0-20"><span class="linenos" data-linenos="20 "></span></a><span class="err">│</span>   <span class="err">└──</span> <span class="n">uwsgi</span><span class="o">.</span><span class="n">ini</span>
<a id="__codelineno-0-21" name="__codelineno-0-21"></a><a href="#__codelineno-0-21"><span class="linenos" data-linenos="21 "></span></a><span class="err">├──</span> <span class="n">mysql</span>                       <span class="c1">#数据库</span>
<a id="__codelineno-0-22" name="__codelineno-0-22"></a><a href="#__codelineno-0-22"><span class="linenos" data-linenos="22 "></span></a><span class="err">│</span>   <span class="err">├──</span> <span class="n">conf</span>
<a id="__codelineno-0-23" name="__codelineno-0-23"></a><a href="#__codelineno-0-23"><span class="linenos" data-linenos="23 "></span></a><span class="err">│</span>   <span class="err">│</span>   <span class="err">└──</span> <span class="n">my</span><span class="o">.</span><span class="n">cnf</span>
<a id="__codelineno-0-24" name="__codelineno-0-24"></a><a href="#__codelineno-0-24"><span class="linenos" data-linenos="24 "></span></a><span class="err">│</span>   <span class="err">└──</span> <span class="n">init</span>
<a id="__codelineno-0-25" name="__codelineno-0-25"></a><a href="#__codelineno-0-25"><span class="linenos" data-linenos="25 "></span></a><span class="err">│</span>       <span class="err">└──</span> <span class="n">init</span><span class="o">.</span><span class="n">sql</span>
<a id="__codelineno-0-26" name="__codelineno-0-26"></a><a href="#__codelineno-0-26"><span class="linenos" data-linenos="26 "></span></a><span class="err">├──</span> <span class="n">nginx</span>
<a id="__codelineno-0-27" name="__codelineno-0-27"></a><a href="#__codelineno-0-27"><span class="linenos" data-linenos="27 "></span></a><span class="err">│</span>   <span class="err">├──</span> <span class="n">Dockerfile</span>
<a id="__codelineno-0-28" name="__codelineno-0-28"></a><a href="#__codelineno-0-28"><span class="linenos" data-linenos="28 "></span></a><span class="err">│</span>   <span class="err">├──</span> <span class="n">log</span>
<a id="__codelineno-0-29" name="__codelineno-0-29"></a><a href="#__codelineno-0-29"><span class="linenos" data-linenos="29 "></span></a><span class="err">│</span>   <span class="err">│</span>   <span class="err">├──</span> <span class="n">access</span><span class="o">.</span><span class="n">log</span>
<a id="__codelineno-0-30" name="__codelineno-0-30"></a><a href="#__codelineno-0-30"><span class="linenos" data-linenos="30 "></span></a><span class="err">│</span>   <span class="err">│</span>   <span class="err">└──</span> <span class="n">error</span><span class="o">.</span><span class="n">log</span>
<a id="__codelineno-0-31" name="__codelineno-0-31"></a><a href="#__codelineno-0-31"><span class="linenos" data-linenos="31 "></span></a><span class="err">│</span>   <span class="err">├──</span> <span class="n">nginx</span><span class="o">.</span><span class="n">conf</span>
<a id="__codelineno-0-32" name="__codelineno-0-32"></a><a href="#__codelineno-0-32"><span class="linenos" data-linenos="32 "></span></a><span class="err">│</span>   <span class="err">└──</span> <span class="n">ssl</span>
<a id="__codelineno-0-33" name="__codelineno-0-33"></a><a href="#__codelineno-0-33"><span class="linenos" data-linenos="33 "></span></a><span class="err">├──</span> <span class="n">recruitment</span>
<a id="__codelineno-0-34" name="__codelineno-0-34"></a><a href="#__codelineno-0-34"><span class="linenos" data-linenos="34 "></span></a><span class="err">│</span>   <span class="err">├──</span> <span class="n">docker</span><span class="o">-</span><span class="n">compose</span><span class="o">.</span><span class="n">yml</span>
<a id="__codelineno-0-35" name="__codelineno-0-35"></a><a href="#__codelineno-0-35"><span class="linenos" data-linenos="35 "></span></a><span class="err">│</span>   <span class="err">├──</span> <span class="n">Dockerfile</span>
<a id="__codelineno-0-36" name="__codelineno-0-36"></a><a href="#__codelineno-0-36"><span class="linenos" data-linenos="36 "></span></a><span class="err">│</span>   <span class="err">├──</span> <span class="n">media</span>
<a id="__codelineno-0-37" name="__codelineno-0-37"></a><a href="#__codelineno-0-37"><span class="linenos" data-linenos="37 "></span></a><span class="err">│</span>   <span class="err">├──</span> <span class="n">pip</span><span class="o">.</span><span class="n">conf</span>
<a id="__codelineno-0-38" name="__codelineno-0-38"></a><a href="#__codelineno-0-38"><span class="linenos" data-linenos="38 "></span></a><span class="err">│</span>   <span class="err">├──</span> <span class="n">requirements</span><span class="o">.</span><span class="n">txt</span>
<a id="__codelineno-0-39" name="__codelineno-0-39"></a><a href="#__codelineno-0-39"><span class="linenos" data-linenos="39 "></span></a><span class="err">│</span>   <span class="err">├──</span> <span class="n">start</span><span class="o">.</span><span class="n">sh</span>
<a id="__codelineno-0-40" name="__codelineno-0-40"></a><a href="#__codelineno-0-40"><span class="linenos" data-linenos="40 "></span></a><span class="err">│</span>   <span class="err">├──</span> <span class="n">static</span>
<a id="__codelineno-0-41" name="__codelineno-0-41"></a><a href="#__codelineno-0-41"><span class="linenos" data-linenos="41 "></span></a><span class="err">│</span>   <span class="err">└──</span> <span class="n">uwsgi</span><span class="o">.</span><span class="n">ini</span>
<a id="__codelineno-0-42" name="__codelineno-0-42"></a><a href="#__codelineno-0-42"><span class="linenos" data-linenos="42 "></span></a><span class="err">├──</span> <span class="n">redis</span>
<a id="__codelineno-0-43" name="__codelineno-0-43"></a><a href="#__codelineno-0-43"><span class="linenos" data-linenos="43 "></span></a><span class="err">│</span>   <span class="err">└──</span> <span class="n">redis</span><span class="o">.</span><span class="n">conf</span>
<a id="__codelineno-0-44" name="__codelineno-0-44"></a><a href="#__codelineno-0-44"><span class="linenos" data-linenos="44 "></span></a><span class="err">└──</span> <span class="n">uwsgi</span>
</code></pre></div>
<h2 id="2dockerfile与各项配置">（2）Dockerfile与各项配置<a class="headerlink" href="#2dockerfile与各项配置" title="Permanent link">&para;</a></h2>
<h4 id="1编写docker-composeyml">（1）编写docker-compose.yml<a class="headerlink" href="#1编写docker-composeyml" title="Permanent link">&para;</a></h4>
<p>修改过的docker-compose.yml的内容:</p>
<div class="language-text highlight"><span class="filename">Text Only</span><pre><span></span><code><a id="__codelineno-1-1" name="__codelineno-1-1"></a><a href="#__codelineno-1-1"><span class="linenos" data-linenos="1 "></span></a>mkdir -p /data/compose/myproject
<a id="__codelineno-1-2" name="__codelineno-1-2"></a><a href="#__codelineno-1-2"><span class="linenos" data-linenos="2 "></span></a>vim /data/compose/myproject/docker-compose.yml
</code></pre></div>
<p>内容如下：</p>
<div class="language-python highlight"><span class="filename">Python</span><pre><span></span><code><a id="__codelineno-2-1" name="__codelineno-2-1"></a><a href="#__codelineno-2-1"><span class="linenos" data-linenos=" 1 "></span></a><span class="n">version</span><span class="p">:</span> <span class="s2">&quot;3&quot;</span>
<a id="__codelineno-2-2" name="__codelineno-2-2"></a><a href="#__codelineno-2-2"><span class="linenos" data-linenos=" 2 "></span></a>
<a id="__codelineno-2-3" name="__codelineno-2-3"></a><a href="#__codelineno-2-3"><span class="linenos" data-linenos=" 3 "></span></a><span class="n">volumes</span><span class="p">:</span> <span class="c1"># 自定义数据卷</span>
<a id="__codelineno-2-4" name="__codelineno-2-4"></a><a href="#__codelineno-2-4"><span class="linenos" data-linenos=" 4 "></span></a>  <span class="n">db_vol</span><span class="p">:</span> <span class="c1">#定义数据卷同步存放容器内mysql数据</span>
<a id="__codelineno-2-5" name="__codelineno-2-5"></a><a href="#__codelineno-2-5"><span class="linenos" data-linenos=" 5 "></span></a>  <span class="n">redis_vol</span><span class="p">:</span> <span class="c1">#定义数据卷同步存放redis数据</span>
<a id="__codelineno-2-6" name="__codelineno-2-6"></a><a href="#__codelineno-2-6"><span class="linenos" data-linenos=" 6 "></span></a>  <span class="n">media_vol</span><span class="p">:</span> <span class="c1">#定义数据卷同步存放web项目用户上传到media文件夹的数据</span>
<a id="__codelineno-2-7" name="__codelineno-2-7"></a><a href="#__codelineno-2-7"><span class="linenos" data-linenos=" 7 "></span></a>  <span class="n">static_vol</span><span class="p">:</span> <span class="c1">#定义数据卷同步存放web项目static文件夹的数据</span>
<a id="__codelineno-2-8" name="__codelineno-2-8"></a><a href="#__codelineno-2-8"><span class="linenos" data-linenos=" 8 "></span></a>
<a id="__codelineno-2-9" name="__codelineno-2-9"></a><a href="#__codelineno-2-9"><span class="linenos" data-linenos=" 9 "></span></a><span class="n">networks</span><span class="p">:</span> <span class="c1"># 自定义网络(默认桥接), 不使用links通信</span>
<a id="__codelineno-2-10" name="__codelineno-2-10"></a><a href="#__codelineno-2-10"><span class="linenos" data-linenos="10 "></span></a>  <span class="n">nginx_network</span><span class="p">:</span>
<a id="__codelineno-2-11" name="__codelineno-2-11"></a><a href="#__codelineno-2-11"><span class="linenos" data-linenos="11 "></span></a>    <span class="n">driver</span><span class="p">:</span> <span class="n">bridge</span>
<a id="__codelineno-2-12" name="__codelineno-2-12"></a><a href="#__codelineno-2-12"><span class="linenos" data-linenos="12 "></span></a>  <span class="n">db_network</span><span class="p">:</span>
<a id="__codelineno-2-13" name="__codelineno-2-13"></a><a href="#__codelineno-2-13"><span class="linenos" data-linenos="13 "></span></a>    <span class="n">driver</span><span class="p">:</span> <span class="n">bridge</span>
<a id="__codelineno-2-14" name="__codelineno-2-14"></a><a href="#__codelineno-2-14"><span class="linenos" data-linenos="14 "></span></a>  <span class="n">redis_network</span><span class="p">:</span> 
<a id="__codelineno-2-15" name="__codelineno-2-15"></a><a href="#__codelineno-2-15"><span class="linenos" data-linenos="15 "></span></a>    <span class="n">driver</span><span class="p">:</span> <span class="n">bridge</span>
<a id="__codelineno-2-16" name="__codelineno-2-16"></a><a href="#__codelineno-2-16"><span class="linenos" data-linenos="16 "></span></a>
<a id="__codelineno-2-17" name="__codelineno-2-17"></a><a href="#__codelineno-2-17"><span class="linenos" data-linenos="17 "></span></a><span class="n">services</span><span class="p">:</span>
<a id="__codelineno-2-18" name="__codelineno-2-18"></a><a href="#__codelineno-2-18"><span class="linenos" data-linenos="18 "></span></a>  <span class="n">redis</span><span class="p">:</span>
<a id="__codelineno-2-19" name="__codelineno-2-19"></a><a href="#__codelineno-2-19"><span class="linenos" data-linenos="19 "></span></a>    <span class="n">image</span><span class="p">:</span> <span class="n">redis</span><span class="p">:</span><span class="n">latest</span>
<a id="__codelineno-2-20" name="__codelineno-2-20"></a><a href="#__codelineno-2-20"><span class="linenos" data-linenos="20 "></span></a>    <span class="n">command</span><span class="p">:</span> <span class="n">redis</span><span class="o">-</span><span class="n">server</span> <span class="o">/</span><span class="n">etc</span><span class="o">/</span><span class="n">redis</span><span class="o">/</span><span class="n">redis</span><span class="o">.</span><span class="n">conf</span> <span class="c1"># 容器启动后启动redis服务器</span>
<a id="__codelineno-2-21" name="__codelineno-2-21"></a><a href="#__codelineno-2-21"><span class="linenos" data-linenos="21 "></span></a>    <span class="n">networks</span><span class="p">:</span>
<a id="__codelineno-2-22" name="__codelineno-2-22"></a><a href="#__codelineno-2-22"><span class="linenos" data-linenos="22 "></span></a>      <span class="o">-</span> <span class="n">redis_network</span>
<a id="__codelineno-2-23" name="__codelineno-2-23"></a><a href="#__codelineno-2-23"><span class="linenos" data-linenos="23 "></span></a>    <span class="n">volumes</span><span class="p">:</span>
<a id="__codelineno-2-24" name="__codelineno-2-24"></a><a href="#__codelineno-2-24"><span class="linenos" data-linenos="24 "></span></a>      <span class="o">-</span> <span class="n">redis_vol</span><span class="p">:</span><span class="o">/</span><span class="n">data</span> <span class="c1"># 通过挂载给redis数据备份</span>
<a id="__codelineno-2-25" name="__codelineno-2-25"></a><a href="#__codelineno-2-25"><span class="linenos" data-linenos="25 "></span></a>      <span class="o">-</span> <span class="o">/</span><span class="n">data</span><span class="o">/</span><span class="n">compose</span><span class="o">/</span><span class="n">redis</span><span class="o">/</span><span class="n">redis</span><span class="o">.</span><span class="n">conf</span><span class="p">:</span><span class="o">/</span><span class="n">etc</span><span class="o">/</span><span class="n">redis</span><span class="o">/</span><span class="n">redis</span><span class="o">.</span><span class="n">conf</span> <span class="c1"># 挂载redis配置文件</span>
<a id="__codelineno-2-26" name="__codelineno-2-26"></a><a href="#__codelineno-2-26"><span class="linenos" data-linenos="26 "></span></a>    <span class="n">ports</span><span class="p">:</span>
<a id="__codelineno-2-27" name="__codelineno-2-27"></a><a href="#__codelineno-2-27"><span class="linenos" data-linenos="27 "></span></a>      <span class="o">-</span> <span class="s2">&quot;6379:6379&quot;</span>
<a id="__codelineno-2-28" name="__codelineno-2-28"></a><a href="#__codelineno-2-28"><span class="linenos" data-linenos="28 "></span></a>    <span class="n">restart</span><span class="p">:</span> <span class="n">always</span> <span class="c1"># always表容器运行发生错误时一直重启</span>
<a id="__codelineno-2-29" name="__codelineno-2-29"></a><a href="#__codelineno-2-29"><span class="linenos" data-linenos="29 "></span></a>
<a id="__codelineno-2-30" name="__codelineno-2-30"></a><a href="#__codelineno-2-30"><span class="linenos" data-linenos="30 "></span></a>  <span class="n">db</span><span class="p">:</span>
<a id="__codelineno-2-31" name="__codelineno-2-31"></a><a href="#__codelineno-2-31"><span class="linenos" data-linenos="31 "></span></a>    <span class="n">image</span><span class="p">:</span> <span class="n">mysql</span>
<a id="__codelineno-2-32" name="__codelineno-2-32"></a><a href="#__codelineno-2-32"><span class="linenos" data-linenos="32 "></span></a>    <span class="n">env_file</span><span class="p">:</span>  
<a id="__codelineno-2-33" name="__codelineno-2-33"></a><a href="#__codelineno-2-33"><span class="linenos" data-linenos="33 "></span></a>      <span class="o">-</span> <span class="o">/</span><span class="n">data</span><span class="o">/</span><span class="n">compose</span><span class="o">/</span><span class="n">myproject</span><span class="o">/.</span><span class="n">env</span> <span class="c1"># 使用了环境变量文件</span>
<a id="__codelineno-2-34" name="__codelineno-2-34"></a><a href="#__codelineno-2-34"><span class="linenos" data-linenos="34 "></span></a>    <span class="n">networks</span><span class="p">:</span>  
<a id="__codelineno-2-35" name="__codelineno-2-35"></a><a href="#__codelineno-2-35"><span class="linenos" data-linenos="35 "></span></a>      <span class="o">-</span> <span class="n">db_network</span>
<a id="__codelineno-2-36" name="__codelineno-2-36"></a><a href="#__codelineno-2-36"><span class="linenos" data-linenos="36 "></span></a>    <span class="n">volumes</span><span class="p">:</span>
<a id="__codelineno-2-37" name="__codelineno-2-37"></a><a href="#__codelineno-2-37"><span class="linenos" data-linenos="37 "></span></a>      <span class="o">-</span> <span class="n">db_vol</span><span class="p">:</span><span class="o">/</span><span class="n">var</span><span class="o">/</span><span class="n">lib</span><span class="o">/</span><span class="n">mysql</span><span class="p">:</span><span class="n">rw</span> <span class="c1"># 挂载数据库数据, 可读可写</span>
<a id="__codelineno-2-38" name="__codelineno-2-38"></a><a href="#__codelineno-2-38"><span class="linenos" data-linenos="38 "></span></a>      <span class="o">-</span> <span class="o">/</span><span class="n">data</span><span class="o">/</span><span class="n">compose</span><span class="o">/</span><span class="n">mysql</span><span class="o">/</span><span class="n">conf</span><span class="o">/</span><span class="n">my</span><span class="o">.</span><span class="n">cnf</span><span class="p">:</span><span class="o">/</span><span class="n">etc</span><span class="o">/</span><span class="n">mysql</span><span class="o">/</span><span class="n">my</span><span class="o">.</span><span class="n">cnf</span> <span class="c1"># 挂载配置文件</span>
<a id="__codelineno-2-39" name="__codelineno-2-39"></a><a href="#__codelineno-2-39"><span class="linenos" data-linenos="39 "></span></a>      <span class="o">-</span> <span class="o">/</span><span class="n">data</span><span class="o">/</span><span class="n">compose</span><span class="o">/</span><span class="n">mysql</span><span class="o">/</span><span class="n">init</span><span class="p">:</span><span class="o">/</span><span class="n">docker</span><span class="o">-</span><span class="n">entrypoint</span><span class="o">-</span><span class="n">initdb</span><span class="o">.</span><span class="n">d</span><span class="o">/</span> <span class="c1"># 挂载数据初始化sql脚本</span>
<a id="__codelineno-2-40" name="__codelineno-2-40"></a><a href="#__codelineno-2-40"><span class="linenos" data-linenos="40 "></span></a>    <span class="n">ports</span><span class="p">:</span>
<a id="__codelineno-2-41" name="__codelineno-2-41"></a><a href="#__codelineno-2-41"><span class="linenos" data-linenos="41 "></span></a>      <span class="o">-</span> <span class="s2">&quot;3306:3306&quot;</span> <span class="c1"># 与配置文件保持一致</span>
<a id="__codelineno-2-42" name="__codelineno-2-42"></a><a href="#__codelineno-2-42"><span class="linenos" data-linenos="42 "></span></a>    <span class="n">restart</span><span class="p">:</span> <span class="n">always</span>
<a id="__codelineno-2-43" name="__codelineno-2-43"></a><a href="#__codelineno-2-43"><span class="linenos" data-linenos="43 "></span></a>
<a id="__codelineno-2-44" name="__codelineno-2-44"></a><a href="#__codelineno-2-44"><span class="linenos" data-linenos="44 "></span></a>  <span class="n">web</span><span class="p">:</span>
<a id="__codelineno-2-45" name="__codelineno-2-45"></a><a href="#__codelineno-2-45"><span class="linenos" data-linenos="45 "></span></a>    <span class="n">build</span><span class="p">:</span> <span class="o">/</span><span class="n">data</span><span class="o">/</span><span class="n">compose</span><span class="o">/</span><span class="n">myproject</span>
<a id="__codelineno-2-46" name="__codelineno-2-46"></a><a href="#__codelineno-2-46"><span class="linenos" data-linenos="46 "></span></a>    <span class="n">ports</span><span class="p">:</span>
<a id="__codelineno-2-47" name="__codelineno-2-47"></a><a href="#__codelineno-2-47"><span class="linenos" data-linenos="47 "></span></a>      <span class="o">-</span> <span class="s2">&quot;8000:8000&quot;</span>
<a id="__codelineno-2-48" name="__codelineno-2-48"></a><a href="#__codelineno-2-48"><span class="linenos" data-linenos="48 "></span></a>    <span class="n">volumes</span><span class="p">:</span>
<a id="__codelineno-2-49" name="__codelineno-2-49"></a><a href="#__codelineno-2-49"><span class="linenos" data-linenos="49 "></span></a>      <span class="o">-</span> <span class="o">/</span><span class="n">data</span><span class="o">/</span><span class="n">compose</span><span class="o">/</span><span class="n">myproject</span><span class="p">:</span><span class="o">/</span><span class="n">var</span><span class="o">/</span><span class="n">www</span><span class="o">/</span><span class="n">html</span><span class="o">/</span><span class="n">myproject</span> <span class="c1"># 挂载项目代码</span>
<a id="__codelineno-2-50" name="__codelineno-2-50"></a><a href="#__codelineno-2-50"><span class="linenos" data-linenos="50 "></span></a>      <span class="o">-</span> <span class="n">static_vol</span><span class="p">:</span><span class="o">/</span><span class="n">var</span><span class="o">/</span><span class="n">www</span><span class="o">/</span><span class="n">html</span><span class="o">/</span><span class="n">myproject</span><span class="o">/</span><span class="n">static</span> <span class="c1"># 以数据卷挂载容器内static文件</span>
<a id="__codelineno-2-51" name="__codelineno-2-51"></a><a href="#__codelineno-2-51"><span class="linenos" data-linenos="51 "></span></a>      <span class="o">-</span> <span class="n">media_vol</span><span class="p">:</span><span class="o">/</span><span class="n">var</span><span class="o">/</span><span class="n">www</span><span class="o">/</span><span class="n">html</span><span class="o">/</span><span class="n">myproject</span><span class="o">/</span><span class="n">media</span> <span class="c1"># 以数据卷挂载容器内用户上传媒体文件</span>
<a id="__codelineno-2-52" name="__codelineno-2-52"></a><a href="#__codelineno-2-52"><span class="linenos" data-linenos="52 "></span></a>      <span class="o">-</span> <span class="o">/</span><span class="n">data</span><span class="o">/</span><span class="n">compose</span><span class="o">/</span><span class="n">uwsgi</span><span class="p">:</span><span class="o">/</span><span class="n">tmp</span> <span class="c1"># 挂载uwsgi日志</span>
<a id="__codelineno-2-53" name="__codelineno-2-53"></a><a href="#__codelineno-2-53"><span class="linenos" data-linenos="53 "></span></a>    <span class="n">networks</span><span class="p">:</span>
<a id="__codelineno-2-54" name="__codelineno-2-54"></a><a href="#__codelineno-2-54"><span class="linenos" data-linenos="54 "></span></a>      <span class="o">-</span> <span class="n">nginx_network</span>
<a id="__codelineno-2-55" name="__codelineno-2-55"></a><a href="#__codelineno-2-55"><span class="linenos" data-linenos="55 "></span></a>      <span class="o">-</span> <span class="n">db_network</span>  
<a id="__codelineno-2-56" name="__codelineno-2-56"></a><a href="#__codelineno-2-56"><span class="linenos" data-linenos="56 "></span></a>      <span class="o">-</span> <span class="n">redis_network</span> 
<a id="__codelineno-2-57" name="__codelineno-2-57"></a><a href="#__codelineno-2-57"><span class="linenos" data-linenos="57 "></span></a>    <span class="n">depends_on</span><span class="p">:</span>
<a id="__codelineno-2-58" name="__codelineno-2-58"></a><a href="#__codelineno-2-58"><span class="linenos" data-linenos="58 "></span></a>      <span class="o">-</span> <span class="n">db</span>
<a id="__codelineno-2-59" name="__codelineno-2-59"></a><a href="#__codelineno-2-59"><span class="linenos" data-linenos="59 "></span></a>      <span class="o">-</span> <span class="n">redis</span>
<a id="__codelineno-2-60" name="__codelineno-2-60"></a><a href="#__codelineno-2-60"><span class="linenos" data-linenos="60 "></span></a>    <span class="n">restart</span><span class="p">:</span> <span class="n">always</span>
<a id="__codelineno-2-61" name="__codelineno-2-61"></a><a href="#__codelineno-2-61"><span class="linenos" data-linenos="61 "></span></a>    <span class="n">tty</span><span class="p">:</span> <span class="n">true</span>
<a id="__codelineno-2-62" name="__codelineno-2-62"></a><a href="#__codelineno-2-62"><span class="linenos" data-linenos="62 "></span></a>    <span class="n">stdin_open</span><span class="p">:</span> <span class="n">true</span>
<a id="__codelineno-2-63" name="__codelineno-2-63"></a><a href="#__codelineno-2-63"><span class="linenos" data-linenos="63 "></span></a>
<a id="__codelineno-2-64" name="__codelineno-2-64"></a><a href="#__codelineno-2-64"><span class="linenos" data-linenos="64 "></span></a>  <span class="n">nginx</span><span class="p">:</span>
<a id="__codelineno-2-65" name="__codelineno-2-65"></a><a href="#__codelineno-2-65"><span class="linenos" data-linenos="65 "></span></a>    <span class="n">build</span><span class="p">:</span> <span class="o">/</span><span class="n">data</span><span class="o">/</span><span class="n">compose</span><span class="o">/</span><span class="n">nginx</span>
<a id="__codelineno-2-66" name="__codelineno-2-66"></a><a href="#__codelineno-2-66"><span class="linenos" data-linenos="66 "></span></a>    <span class="n">ports</span><span class="p">:</span>
<a id="__codelineno-2-67" name="__codelineno-2-67"></a><a href="#__codelineno-2-67"><span class="linenos" data-linenos="67 "></span></a>      <span class="o">-</span> <span class="s2">&quot;80:80&quot;</span>
<a id="__codelineno-2-68" name="__codelineno-2-68"></a><a href="#__codelineno-2-68"><span class="linenos" data-linenos="68 "></span></a>      <span class="o">-</span> <span class="s2">&quot;443:443&quot;</span>
<a id="__codelineno-2-69" name="__codelineno-2-69"></a><a href="#__codelineno-2-69"><span class="linenos" data-linenos="69 "></span></a>    <span class="n">expose</span><span class="p">:</span>
<a id="__codelineno-2-70" name="__codelineno-2-70"></a><a href="#__codelineno-2-70"><span class="linenos" data-linenos="70 "></span></a>      <span class="o">-</span> <span class="s2">&quot;80&quot;</span>
<a id="__codelineno-2-71" name="__codelineno-2-71"></a><a href="#__codelineno-2-71"><span class="linenos" data-linenos="71 "></span></a>    <span class="n">volumes</span><span class="p">:</span>
<a id="__codelineno-2-72" name="__codelineno-2-72"></a><a href="#__codelineno-2-72"><span class="linenos" data-linenos="72 "></span></a>      <span class="o">-</span> <span class="o">/</span><span class="n">data</span><span class="o">/</span><span class="n">compose</span><span class="o">/</span><span class="n">nginx</span><span class="o">/</span><span class="n">nginx</span><span class="o">.</span><span class="n">conf</span><span class="p">:</span><span class="o">/</span><span class="n">etc</span><span class="o">/</span><span class="n">nginx</span><span class="o">/</span><span class="n">conf</span><span class="o">.</span><span class="n">d</span><span class="o">/</span><span class="n">nginx</span><span class="o">.</span><span class="n">conf</span> <span class="c1"># 挂载nginx配置文件</span>
<a id="__codelineno-2-73" name="__codelineno-2-73"></a><a href="#__codelineno-2-73"><span class="linenos" data-linenos="73 "></span></a>      <span class="o">-</span> <span class="o">/</span><span class="n">data</span><span class="o">/</span><span class="n">compose</span><span class="o">/</span><span class="n">nginx</span><span class="o">/</span><span class="n">ssl</span><span class="p">:</span><span class="o">/</span><span class="n">usr</span><span class="o">/</span><span class="n">share</span><span class="o">/</span><span class="n">nginx</span><span class="o">/</span><span class="n">ssl</span> <span class="c1"># 挂载ssl证书目录</span>
<a id="__codelineno-2-74" name="__codelineno-2-74"></a><a href="#__codelineno-2-74"><span class="linenos" data-linenos="74 "></span></a>      <span class="o">-</span> <span class="o">/</span><span class="n">data</span><span class="o">/</span><span class="n">compose</span><span class="o">/</span><span class="n">nginx</span><span class="o">/</span><span class="n">log</span><span class="p">:</span><span class="o">/</span><span class="n">var</span><span class="o">/</span><span class="n">log</span><span class="o">/</span><span class="n">nginx</span> <span class="c1"># 挂载日志</span>
<a id="__codelineno-2-75" name="__codelineno-2-75"></a><a href="#__codelineno-2-75"><span class="linenos" data-linenos="75 "></span></a>      <span class="o">-</span> <span class="n">static_vol</span><span class="p">:</span><span class="o">/</span><span class="n">usr</span><span class="o">/</span><span class="n">share</span><span class="o">/</span><span class="n">nginx</span><span class="o">/</span><span class="n">html</span><span class="o">/</span><span class="n">static</span> <span class="c1"># 挂载静态文件</span>
<a id="__codelineno-2-76" name="__codelineno-2-76"></a><a href="#__codelineno-2-76"><span class="linenos" data-linenos="76 "></span></a>      <span class="o">-</span> <span class="n">media_vol</span><span class="p">:</span><span class="o">/</span><span class="n">usr</span><span class="o">/</span><span class="n">share</span><span class="o">/</span><span class="n">nginx</span><span class="o">/</span><span class="n">html</span><span class="o">/</span><span class="n">media</span> <span class="c1"># 挂载用户上传媒体文件</span>
<a id="__codelineno-2-77" name="__codelineno-2-77"></a><a href="#__codelineno-2-77"><span class="linenos" data-linenos="77 "></span></a>    <span class="n">networks</span><span class="p">:</span>
<a id="__codelineno-2-78" name="__codelineno-2-78"></a><a href="#__codelineno-2-78"><span class="linenos" data-linenos="78 "></span></a>      <span class="o">-</span> <span class="n">nginx_network</span>
<a id="__codelineno-2-79" name="__codelineno-2-79"></a><a href="#__codelineno-2-79"><span class="linenos" data-linenos="79 "></span></a>    <span class="n">depends_on</span><span class="p">:</span>
<a id="__codelineno-2-80" name="__codelineno-2-80"></a><a href="#__codelineno-2-80"><span class="linenos" data-linenos="80 "></span></a>      <span class="o">-</span> <span class="n">web</span>
<a id="__codelineno-2-81" name="__codelineno-2-81"></a><a href="#__codelineno-2-81"><span class="linenos" data-linenos="81 "></span></a>    <span class="n">restart</span><span class="p">:</span> <span class="n">always</span>
</code></pre></div>
<p>1、定义了4个数据卷，用于挂载各个容器内动态生成的数据，比如MySQL的存储数据，redis生成的快照、django+uwsgi容器中收集的静态文件以及用户上传的媒体资源。这样即使删除容器，容器内产生的数据也不会丢失。</p>
<p>2、定义了3个网络，分别为<code>nginx_network</code>(用于nginx和web容器间的通信)，<code>db_network</code>(用于db和web容器间的通信)和<code>redis_network</code>(用于redis和web容器间的通信)。</p>
<p>创建文件之后，确保你的<code>docker-compose.yml</code>文件路径与服务中定义的构建路径和卷挂载路径相匹配。如果你的<code>web</code>服务中有<code>build: /data/compose/myproject</code>，那么你的Django项目应该位于<code>/data/compose/myproject</code>路径下。</p>
<h4 id="2编写djangouwsgi的dockerfile">（2）编写Django+Uwsgi的Dockerfile：<a class="headerlink" href="#2编写djangouwsgi的dockerfile" title="Permanent link">&para;</a></h4>
<ul>
<li>在<code>/data/compose/myproject</code>目录下创建一个名为<code>Dockerfile</code>的文件。</li>
<li>复制你之前提供的Django+Uwsgi Dockerfile内容到这个文件中。</li>
</ul>
<div class="language-text highlight"><span class="filename">Text Only</span><pre><span></span><code><a id="__codelineno-3-1" name="__codelineno-3-1"></a><a href="#__codelineno-3-1"><span class="linenos" data-linenos="1 "></span></a>vim /data/compose/myproject/Dockerfile
</code></pre></div>
<p>构建Web镜像(Django+Uwsgi)的所使用的Dockerfile如下所示:</p>
<div class="language-text highlight"><span class="filename">Text Only</span><pre><span></span><code><a id="__codelineno-4-1" name="__codelineno-4-1"></a><a href="#__codelineno-4-1"><span class="linenos" data-linenos=" 1 "></span></a># 基于CentOS 7的Python 3.9环境
<a id="__codelineno-4-2" name="__codelineno-4-2"></a><a href="#__codelineno-4-2"><span class="linenos" data-linenos=" 2 "></span></a>FROM centos:7
<a id="__codelineno-4-3" name="__codelineno-4-3"></a><a href="#__codelineno-4-3"><span class="linenos" data-linenos=" 3 "></span></a>
<a id="__codelineno-4-4" name="__codelineno-4-4"></a><a href="#__codelineno-4-4"><span class="linenos" data-linenos=" 4 "></span></a># 安装必要的软件和开发工具
<a id="__codelineno-4-5" name="__codelineno-4-5"></a><a href="#__codelineno-4-5"><span class="linenos" data-linenos=" 5 "></span></a>RUN yum -y update &amp;&amp; \
<a id="__codelineno-4-6" name="__codelineno-4-6"></a><a href="#__codelineno-4-6"><span class="linenos" data-linenos=" 6 "></span></a>    yum -y install epel-release &amp;&amp; \
<a id="__codelineno-4-7" name="__codelineno-4-7"></a><a href="#__codelineno-4-7"><span class="linenos" data-linenos=" 7 "></span></a>    yum -y install python3 python3-pip nc mysql-devel gcc-c++ python3-devel libjpeg-devel zlib-devel libffi-devel openssl-devel &amp;&amp; \
<a id="__codelineno-4-8" name="__codelineno-4-8"></a><a href="#__codelineno-4-8"><span class="linenos" data-linenos=" 8 "></span></a>    yum -y groupinstall &quot;Development Tools&quot; &amp;&amp; \
<a id="__codelineno-4-9" name="__codelineno-4-9"></a><a href="#__codelineno-4-9"><span class="linenos" data-linenos=" 9 "></span></a>    yum clean all
<a id="__codelineno-4-10" name="__codelineno-4-10"></a><a href="#__codelineno-4-10"><span class="linenos" data-linenos="10 "></span></a>
<a id="__codelineno-4-11" name="__codelineno-4-11"></a><a href="#__codelineno-4-11"><span class="linenos" data-linenos="11 "></span></a># 设置 python 环境变量
<a id="__codelineno-4-12" name="__codelineno-4-12"></a><a href="#__codelineno-4-12"><span class="linenos" data-linenos="12 "></span></a>ENV PYTHONDONTWRITEBYTECODE 1
<a id="__codelineno-4-13" name="__codelineno-4-13"></a><a href="#__codelineno-4-13"><span class="linenos" data-linenos="13 "></span></a>ENV PYTHONUNBUFFERED 1
<a id="__codelineno-4-14" name="__codelineno-4-14"></a><a href="#__codelineno-4-14"><span class="linenos" data-linenos="14 "></span></a>
<a id="__codelineno-4-15" name="__codelineno-4-15"></a><a href="#__codelineno-4-15"><span class="linenos" data-linenos="15 "></span></a># 可选：设置镜像源为国内
<a id="__codelineno-4-16" name="__codelineno-4-16"></a><a href="#__codelineno-4-16"><span class="linenos" data-linenos="16 "></span></a>COPY pip.conf /root/.pip/pip.conf
<a id="__codelineno-4-17" name="__codelineno-4-17"></a><a href="#__codelineno-4-17"><span class="linenos" data-linenos="17 "></span></a>
<a id="__codelineno-4-18" name="__codelineno-4-18"></a><a href="#__codelineno-4-18"><span class="linenos" data-linenos="18 "></span></a># 容器内创建 myproject 文件夹
<a id="__codelineno-4-19" name="__codelineno-4-19"></a><a href="#__codelineno-4-19"><span class="linenos" data-linenos="19 "></span></a>ENV APP_HOME=/var/www/html/myproject
<a id="__codelineno-4-20" name="__codelineno-4-20"></a><a href="#__codelineno-4-20"><span class="linenos" data-linenos="20 "></span></a>RUN mkdir -p $APP_HOME
<a id="__codelineno-4-21" name="__codelineno-4-21"></a><a href="#__codelineno-4-21"><span class="linenos" data-linenos="21 "></span></a>WORKDIR $APP_HOME
<a id="__codelineno-4-22" name="__codelineno-4-22"></a><a href="#__codelineno-4-22"><span class="linenos" data-linenos="22 "></span></a>
<a id="__codelineno-4-23" name="__codelineno-4-23"></a><a href="#__codelineno-4-23"><span class="linenos" data-linenos="23 "></span></a># 将当前目录加入到工作目录中
<a id="__codelineno-4-24" name="__codelineno-4-24"></a><a href="#__codelineno-4-24"><span class="linenos" data-linenos="24 "></span></a>ADD . $APP_HOME
<a id="__codelineno-4-25" name="__codelineno-4-25"></a><a href="#__codelineno-4-25"><span class="linenos" data-linenos="25 "></span></a>
<a id="__codelineno-4-26" name="__codelineno-4-26"></a><a href="#__codelineno-4-26"><span class="linenos" data-linenos="26 "></span></a># 更新pip版本
<a id="__codelineno-4-27" name="__codelineno-4-27"></a><a href="#__codelineno-4-27"><span class="linenos" data-linenos="27 "></span></a>RUN python3 -m pip install --upgrade pip
<a id="__codelineno-4-28" name="__codelineno-4-28"></a><a href="#__codelineno-4-28"><span class="linenos" data-linenos="28 "></span></a>
<a id="__codelineno-4-29" name="__codelineno-4-29"></a><a href="#__codelineno-4-29"><span class="linenos" data-linenos="29 "></span></a># 安装项目依赖
<a id="__codelineno-4-30" name="__codelineno-4-30"></a><a href="#__codelineno-4-30"><span class="linenos" data-linenos="30 "></span></a>RUN pip install -r requirements.txt
<a id="__codelineno-4-31" name="__codelineno-4-31"></a><a href="#__codelineno-4-31"><span class="linenos" data-linenos="31 "></span></a>
<a id="__codelineno-4-32" name="__codelineno-4-32"></a><a href="#__codelineno-4-32"><span class="linenos" data-linenos="32 "></span></a># 复制 start.sh 到 /data/compose 并确保文件权限和格式
<a id="__codelineno-4-33" name="__codelineno-4-33"></a><a href="#__codelineno-4-33"><span class="linenos" data-linenos="33 "></span></a>COPY start.sh /data/compose/start.sh
<a id="__codelineno-4-34" name="__codelineno-4-34"></a><a href="#__codelineno-4-34"><span class="linenos" data-linenos="34 "></span></a>RUN chmod +x /data/compose/start.sh &amp;&amp; sed -i &#39;s/\r$//&#39; /data/compose/start.sh
<a id="__codelineno-4-35" name="__codelineno-4-35"></a><a href="#__codelineno-4-35"><span class="linenos" data-linenos="35 "></span></a>
<a id="__codelineno-4-36" name="__codelineno-4-36"></a><a href="#__codelineno-4-36"><span class="linenos" data-linenos="36 "></span></a># 复制 uwsgi.ini 配置文件
<a id="__codelineno-4-37" name="__codelineno-4-37"></a><a href="#__codelineno-4-37"><span class="linenos" data-linenos="37 "></span></a>COPY uwsgi.ini $APP_HOME/uwsgi.ini
<a id="__codelineno-4-38" name="__codelineno-4-38"></a><a href="#__codelineno-4-38"><span class="linenos" data-linenos="38 "></span></a>
<a id="__codelineno-4-39" name="__codelineno-4-39"></a><a href="#__codelineno-4-39"><span class="linenos" data-linenos="39 "></span></a># 设置工作目录并启动服务
<a id="__codelineno-4-40" name="__codelineno-4-40"></a><a href="#__codelineno-4-40"><span class="linenos" data-linenos="40 "></span></a>WORKDIR /data/compose
<a id="__codelineno-4-41" name="__codelineno-4-41"></a><a href="#__codelineno-4-41"><span class="linenos" data-linenos="41 "></span></a>ENTRYPOINT [&quot;/bin/bash&quot;, &quot;/data/compose/start.sh&quot;]
</code></pre></div>
<h4 id="3编写startsh启动脚本文件">（3）编写<code>start.sh</code>启动脚本文件<a class="headerlink" href="#3编写startsh启动脚本文件" title="Permanent link">&para;</a></h4>
<p>使用uwsgi.ini配置文件启动Django服务。</p>
<div class="language-text highlight"><span class="filename">Text Only</span><pre><span></span><code><a id="__codelineno-5-1" name="__codelineno-5-1"></a><a href="#__codelineno-5-1"><span class="linenos" data-linenos="1 "></span></a>vim /data/compose/myproject/start.sh
</code></pre></div>
<p>内容如下所示：</p>
<div class="language-text highlight"><span class="filename">Text Only</span><pre><span></span><code><a id="__codelineno-6-1" name="__codelineno-6-1"></a><a href="#__codelineno-6-1"><span class="linenos" data-linenos=" 1 "></span></a>#!/bin/bash
<a id="__codelineno-6-2" name="__codelineno-6-2"></a><a href="#__codelineno-6-2"><span class="linenos" data-linenos=" 2 "></span></a># 定义 MySQL 主机和端口
<a id="__codelineno-6-3" name="__codelineno-6-3"></a><a href="#__codelineno-6-3"><span class="linenos" data-linenos=" 3 "></span></a>MYSQL_HOST=db
<a id="__codelineno-6-4" name="__codelineno-6-4"></a><a href="#__codelineno-6-4"><span class="linenos" data-linenos=" 4 "></span></a>MYSQL_PORT=3306
<a id="__codelineno-6-5" name="__codelineno-6-5"></a><a href="#__codelineno-6-5"><span class="linenos" data-linenos=" 5 "></span></a>
<a id="__codelineno-6-6" name="__codelineno-6-6"></a><a href="#__codelineno-6-6"><span class="linenos" data-linenos=" 6 "></span></a># 等待 MySQL 服务启动
<a id="__codelineno-6-7" name="__codelineno-6-7"></a><a href="#__codelineno-6-7"><span class="linenos" data-linenos=" 7 "></span></a>while ! nc -z $MYSQL_HOST $MYSQL_PORT; do
<a id="__codelineno-6-8" name="__codelineno-6-8"></a><a href="#__codelineno-6-8"><span class="linenos" data-linenos=" 8 "></span></a>    echo &quot;Waiting for the MySQL Server&quot;
<a id="__codelineno-6-9" name="__codelineno-6-9"></a><a href="#__codelineno-6-9"><span class="linenos" data-linenos=" 9 "></span></a>    sleep 3
<a id="__codelineno-6-10" name="__codelineno-6-10"></a><a href="#__codelineno-6-10"><span class="linenos" data-linenos="10 "></span></a>done
<a id="__codelineno-6-11" name="__codelineno-6-11"></a><a href="#__codelineno-6-11"><span class="linenos" data-linenos="11 "></span></a>
<a id="__codelineno-6-12" name="__codelineno-6-12"></a><a href="#__codelineno-6-12"><span class="linenos" data-linenos="12 "></span></a># 如果需要初始化Django应用或执行数据迁移，这里可以执行相关命令
<a id="__codelineno-6-13" name="__codelineno-6-13"></a><a href="#__codelineno-6-13"><span class="linenos" data-linenos="13 "></span></a># 示例：python manage.py migrate --noinput
<a id="__codelineno-6-14" name="__codelineno-6-14"></a><a href="#__codelineno-6-14"><span class="linenos" data-linenos="14 "></span></a># 示例：python manage.py collectstatic --noinput
<a id="__codelineno-6-15" name="__codelineno-6-15"></a><a href="#__codelineno-6-15"><span class="linenos" data-linenos="15 "></span></a>python manage.py migrate --noinput
<a id="__codelineno-6-16" name="__codelineno-6-16"></a><a href="#__codelineno-6-16"><span class="linenos" data-linenos="16 "></span></a>python manage.py collectstatic --noinput
<a id="__codelineno-6-17" name="__codelineno-6-17"></a><a href="#__codelineno-6-17"><span class="linenos" data-linenos="17 "></span></a>
<a id="__codelineno-6-18" name="__codelineno-6-18"></a><a href="#__codelineno-6-18"><span class="linenos" data-linenos="18 "></span></a>
<a id="__codelineno-6-19" name="__codelineno-6-19"></a><a href="#__codelineno-6-19"><span class="linenos" data-linenos="19 "></span></a># 启动 UWSGI 服务
<a id="__codelineno-6-20" name="__codelineno-6-20"></a><a href="#__codelineno-6-20"><span class="linenos" data-linenos="20 "></span></a>uwsgi --ini /var/www/html/myproject/uwsgi.ini
<a id="__codelineno-6-21" name="__codelineno-6-21"></a><a href="#__codelineno-6-21"><span class="linenos" data-linenos="21 "></span></a>
<a id="__codelineno-6-22" name="__codelineno-6-22"></a><a href="#__codelineno-6-22"><span class="linenos" data-linenos="22 "></span></a># 保持容器运行
<a id="__codelineno-6-23" name="__codelineno-6-23"></a><a href="#__codelineno-6-23"><span class="linenos" data-linenos="23 "></span></a>tail -f /dev/null
<a id="__codelineno-6-24" name="__codelineno-6-24"></a><a href="#__codelineno-6-24"><span class="linenos" data-linenos="24 "></span></a>
<a id="__codelineno-6-25" name="__codelineno-6-25"></a><a href="#__codelineno-6-25"><span class="linenos" data-linenos="25 "></span></a>exec &quot;$@&quot;
</code></pre></div>
<p>赋权</p>
<div class="language-text highlight"><span class="filename">Text Only</span><pre><span></span><code><a id="__codelineno-7-1" name="__codelineno-7-1"></a><a href="#__codelineno-7-1"><span class="linenos" data-linenos="1 "></span></a>chmod +x /data/compose/myproject/start.sh
</code></pre></div>
<h4 id="4配置-uwsgiini-配置文件">（4）配置 <code>uwsgi.ini</code> 配置文件<a class="headerlink" href="#4配置-uwsgiini-配置文件" title="Permanent link">&para;</a></h4>
<p><strong>创建 <code>uwsgi.ini</code></strong>：</p>
<ul>
<li>在 <code>/data/compose/myproject</code> 目录中创建一个名为 <code>uwsgi.ini</code> 的文件。</li>
<li>编辑该文件，填入以下内容：<code>vim /data/compose/myproject/uwsgi.ini</code></li>
</ul>
<div class="language-python highlight"><span class="filename">Python</span><pre><span></span><code><a id="__codelineno-8-1" name="__codelineno-8-1"></a><a href="#__codelineno-8-1"><span class="linenos" data-linenos=" 1 "></span></a><span class="p">[</span><span class="n">uwsgi</span><span class="p">]</span>
<a id="__codelineno-8-2" name="__codelineno-8-2"></a><a href="#__codelineno-8-2"><span class="linenos" data-linenos=" 2 "></span></a>
<a id="__codelineno-8-3" name="__codelineno-8-3"></a><a href="#__codelineno-8-3"><span class="linenos" data-linenos=" 3 "></span></a><span class="n">project</span><span class="o">=</span><span class="n">myproject</span>
<a id="__codelineno-8-4" name="__codelineno-8-4"></a><a href="#__codelineno-8-4"><span class="linenos" data-linenos=" 4 "></span></a><span class="n">uid</span><span class="o">=</span><span class="n">www</span><span class="o">-</span><span class="n">data</span>
<a id="__codelineno-8-5" name="__codelineno-8-5"></a><a href="#__codelineno-8-5"><span class="linenos" data-linenos=" 5 "></span></a><span class="n">gid</span><span class="o">=</span><span class="n">www</span><span class="o">-</span><span class="n">data</span>
<a id="__codelineno-8-6" name="__codelineno-8-6"></a><a href="#__codelineno-8-6"><span class="linenos" data-linenos=" 6 "></span></a><span class="n">base</span><span class="o">=/</span><span class="n">var</span><span class="o">/</span><span class="n">www</span><span class="o">/</span><span class="n">html</span>
<a id="__codelineno-8-7" name="__codelineno-8-7"></a><a href="#__codelineno-8-7"><span class="linenos" data-linenos=" 7 "></span></a>
<a id="__codelineno-8-8" name="__codelineno-8-8"></a><a href="#__codelineno-8-8"><span class="linenos" data-linenos=" 8 "></span></a><span class="n">chdir</span><span class="o">=%</span><span class="p">(</span><span class="n">base</span><span class="p">)</span><span class="o">/%</span><span class="p">(</span><span class="n">project</span><span class="p">)</span>
<a id="__codelineno-8-9" name="__codelineno-8-9"></a><a href="#__codelineno-8-9"><span class="linenos" data-linenos=" 9 "></span></a><span class="n">module</span><span class="o">=%</span><span class="p">(</span><span class="n">project</span><span class="p">)</span><span class="o">.</span><span class="n">wsgi</span><span class="p">:</span><span class="n">application</span>
<a id="__codelineno-8-10" name="__codelineno-8-10"></a><a href="#__codelineno-8-10"><span class="linenos" data-linenos="10 "></span></a><span class="n">master</span><span class="o">=</span><span class="kc">True</span>
<a id="__codelineno-8-11" name="__codelineno-8-11"></a><a href="#__codelineno-8-11"><span class="linenos" data-linenos="11 "></span></a><span class="n">processes</span><span class="o">=</span><span class="mi">2</span>
<a id="__codelineno-8-12" name="__codelineno-8-12"></a><a href="#__codelineno-8-12"><span class="linenos" data-linenos="12 "></span></a>
<a id="__codelineno-8-13" name="__codelineno-8-13"></a><a href="#__codelineno-8-13"><span class="linenos" data-linenos="13 "></span></a><span class="n">socket</span><span class="o">=</span><span class="mf">0.0.0.0</span><span class="p">:</span><span class="mi">8000</span>
<a id="__codelineno-8-14" name="__codelineno-8-14"></a><a href="#__codelineno-8-14"><span class="linenos" data-linenos="14 "></span></a><span class="n">chown</span><span class="o">-</span><span class="n">socket</span><span class="o">=%</span><span class="p">(</span><span class="n">uid</span><span class="p">):</span><span class="n">www</span><span class="o">-</span><span class="n">data</span>
<a id="__codelineno-8-15" name="__codelineno-8-15"></a><a href="#__codelineno-8-15"><span class="linenos" data-linenos="15 "></span></a><span class="n">chmod</span><span class="o">-</span><span class="n">socket</span><span class="o">=</span><span class="mi">664</span>
<a id="__codelineno-8-16" name="__codelineno-8-16"></a><a href="#__codelineno-8-16"><span class="linenos" data-linenos="16 "></span></a>
<a id="__codelineno-8-17" name="__codelineno-8-17"></a><a href="#__codelineno-8-17"><span class="linenos" data-linenos="17 "></span></a><span class="n">vacuum</span><span class="o">=</span><span class="kc">True</span>
<a id="__codelineno-8-18" name="__codelineno-8-18"></a><a href="#__codelineno-8-18"><span class="linenos" data-linenos="18 "></span></a><span class="nb">max</span><span class="o">-</span><span class="n">requests</span><span class="o">=</span><span class="mi">5000</span>
<a id="__codelineno-8-19" name="__codelineno-8-19"></a><a href="#__codelineno-8-19"><span class="linenos" data-linenos="19 "></span></a>
<a id="__codelineno-8-20" name="__codelineno-8-20"></a><a href="#__codelineno-8-20"><span class="linenos" data-linenos="20 "></span></a><span class="n">pidfile</span><span class="o">=/</span><span class="n">tmp</span><span class="o">/%</span><span class="p">(</span><span class="n">project</span><span class="p">)</span><span class="o">-</span><span class="n">master</span><span class="o">.</span><span class="n">pid</span>
<a id="__codelineno-8-21" name="__codelineno-8-21"></a><a href="#__codelineno-8-21"><span class="linenos" data-linenos="21 "></span></a><span class="n">daemonize</span><span class="o">=/</span><span class="n">tmp</span><span class="o">/%</span><span class="p">(</span><span class="n">project</span><span class="p">)</span><span class="o">-</span><span class="n">uwsgi</span><span class="o">.</span><span class="n">log</span>
<a id="__codelineno-8-22" name="__codelineno-8-22"></a><a href="#__codelineno-8-22"><span class="linenos" data-linenos="22 "></span></a>
<a id="__codelineno-8-23" name="__codelineno-8-23"></a><a href="#__codelineno-8-23"><span class="linenos" data-linenos="23 "></span></a><span class="c1">#设置一个请求的超时时间(秒)，如果一个请求超过了这个时间，则请求被丢弃</span>
<a id="__codelineno-8-24" name="__codelineno-8-24"></a><a href="#__codelineno-8-24"><span class="linenos" data-linenos="24 "></span></a><span class="n">harakiri</span> <span class="o">=</span> <span class="mi">60</span>
<a id="__codelineno-8-25" name="__codelineno-8-25"></a><a href="#__codelineno-8-25"><span class="linenos" data-linenos="25 "></span></a><span class="n">post</span> <span class="n">buffering</span> <span class="o">=</span> <span class="mi">8192</span>
<a id="__codelineno-8-26" name="__codelineno-8-26"></a><a href="#__codelineno-8-26"><span class="linenos" data-linenos="26 "></span></a><span class="n">buffer</span><span class="o">-</span><span class="n">size</span><span class="o">=</span> <span class="mi">65535</span>
<a id="__codelineno-8-27" name="__codelineno-8-27"></a><a href="#__codelineno-8-27"><span class="linenos" data-linenos="27 "></span></a><span class="c1">#当一个请求被harakiri杀掉会，会输出一条日志</span>
<a id="__codelineno-8-28" name="__codelineno-8-28"></a><a href="#__codelineno-8-28"><span class="linenos" data-linenos="28 "></span></a><span class="n">harakiri</span><span class="o">-</span><span class="n">verbose</span> <span class="o">=</span> <span class="n">true</span>
<a id="__codelineno-8-29" name="__codelineno-8-29"></a><a href="#__codelineno-8-29"><span class="linenos" data-linenos="29 "></span></a>
<a id="__codelineno-8-30" name="__codelineno-8-30"></a><a href="#__codelineno-8-30"><span class="linenos" data-linenos="30 "></span></a><span class="c1">#开启内存使用情况报告</span>
<a id="__codelineno-8-31" name="__codelineno-8-31"></a><a href="#__codelineno-8-31"><span class="linenos" data-linenos="31 "></span></a><span class="n">memory</span><span class="o">-</span><span class="n">report</span> <span class="o">=</span> <span class="n">true</span>
<a id="__codelineno-8-32" name="__codelineno-8-32"></a><a href="#__codelineno-8-32"><span class="linenos" data-linenos="32 "></span></a>
<a id="__codelineno-8-33" name="__codelineno-8-33"></a><a href="#__codelineno-8-33"><span class="linenos" data-linenos="33 "></span></a><span class="c1">#设置平滑的重启（直到处理完接收到的请求）的长等待时间(秒)</span>
<a id="__codelineno-8-34" name="__codelineno-8-34"></a><a href="#__codelineno-8-34"><span class="linenos" data-linenos="34 "></span></a><span class="n">reload</span><span class="o">-</span><span class="n">mercy</span> <span class="o">=</span> <span class="mi">10</span>
<a id="__codelineno-8-35" name="__codelineno-8-35"></a><a href="#__codelineno-8-35"><span class="linenos" data-linenos="35 "></span></a>
<a id="__codelineno-8-36" name="__codelineno-8-36"></a><a href="#__codelineno-8-36"><span class="linenos" data-linenos="36 "></span></a><span class="c1">#设置工作进程使用虚拟内存超过N MB就回收重启</span>
<a id="__codelineno-8-37" name="__codelineno-8-37"></a><a href="#__codelineno-8-37"><span class="linenos" data-linenos="37 "></span></a><span class="n">reload</span><span class="o">-</span><span class="n">on</span><span class="o">-</span><span class="k">as</span><span class="o">=</span> <span class="mi">1024</span>
</code></pre></div>
<h4 id="5编辑env文件">（5）编辑.env文件<a class="headerlink" href="#5编辑env文件" title="Permanent link">&para;</a></h4>
<p>创建.env文件：</p>
<div class="language-text highlight"><span class="filename">Text Only</span><pre><span></span><code><a id="__codelineno-9-1" name="__codelineno-9-1"></a><a href="#__codelineno-9-1"><span class="linenos" data-linenos="1 "></span></a>vim /data/compose/myproject/.env
</code></pre></div>
<p><code>.env</code>文件内容如下所示：</p>
<div class="language-text highlight"><span class="filename">Text Only</span><pre><span></span><code><a id="__codelineno-10-1" name="__codelineno-10-1"></a><a href="#__codelineno-10-1"><span class="linenos" data-linenos="1 "></span></a>MYSQL_ROOT_PASSWORD=123456
<a id="__codelineno-10-2" name="__codelineno-10-2"></a><a href="#__codelineno-10-2"><span class="linenos" data-linenos="2 "></span></a>MYSQL_USER=dbuser
<a id="__codelineno-10-3" name="__codelineno-10-3"></a><a href="#__codelineno-10-3"><span class="linenos" data-linenos="3 "></span></a>MYSQL_DATABASE=myproject
<a id="__codelineno-10-4" name="__codelineno-10-4"></a><a href="#__codelineno-10-4"><span class="linenos" data-linenos="4 "></span></a>MYSQL_PASSWORD=password
</code></pre></div>
<p><strong>确保在<code>docker-compose.yml</code>中使用env的这些环境变量</strong></p>
<p>通常在服务的定义中通过<code>env_file</code>或直接使用<code>environment</code>属性来实现。例如，对于MySQL服务，你可以这样配置：</p>
<div class="language-python highlight"><span class="filename">Python</span><pre><span></span><code><a id="__codelineno-11-1" name="__codelineno-11-1"></a><a href="#__codelineno-11-1"><span class="linenos" data-linenos=" 1 "></span></a><span class="n">yamlCopy</span> <span class="n">codedb</span><span class="p">:</span>
<a id="__codelineno-11-2" name="__codelineno-11-2"></a><a href="#__codelineno-11-2"><span class="linenos" data-linenos=" 2 "></span></a>  <span class="n">image</span><span class="p">:</span> <span class="n">mysql</span>
<a id="__codelineno-11-3" name="__codelineno-11-3"></a><a href="#__codelineno-11-3"><span class="linenos" data-linenos=" 3 "></span></a>  <span class="n">env_file</span><span class="p">:</span>
<a id="__codelineno-11-4" name="__codelineno-11-4"></a><a href="#__codelineno-11-4"><span class="linenos" data-linenos=" 4 "></span></a>    <span class="o">-</span> <span class="o">/</span><span class="n">data</span><span class="o">/</span><span class="n">compose</span><span class="o">/</span><span class="n">project</span><span class="o">/.</span><span class="n">env</span>
<a id="__codelineno-11-5" name="__codelineno-11-5"></a><a href="#__codelineno-11-5"><span class="linenos" data-linenos=" 5 "></span></a>  <span class="n">volumes</span><span class="p">:</span>
<a id="__codelineno-11-6" name="__codelineno-11-6"></a><a href="#__codelineno-11-6"><span class="linenos" data-linenos=" 6 "></span></a>    <span class="o">-</span> <span class="n">db_vol</span><span class="p">:</span><span class="o">/</span><span class="n">var</span><span class="o">/</span><span class="n">lib</span><span class="o">/</span><span class="n">mysql</span>
<a id="__codelineno-11-7" name="__codelineno-11-7"></a><a href="#__codelineno-11-7"><span class="linenos" data-linenos=" 7 "></span></a>    <span class="o">-</span> <span class="o">/</span><span class="n">data</span><span class="o">/</span><span class="n">compose</span><span class="o">/</span><span class="n">mysql</span><span class="o">/</span><span class="n">conf</span><span class="o">/</span><span class="n">my</span><span class="o">.</span><span class="n">cnf</span><span class="p">:</span><span class="o">/</span><span class="n">etc</span><span class="o">/</span><span class="n">mysql</span><span class="o">/</span><span class="n">my</span><span class="o">.</span><span class="n">cnf</span>
<a id="__codelineno-11-8" name="__codelineno-11-8"></a><a href="#__codelineno-11-8"><span class="linenos" data-linenos=" 8 "></span></a>    <span class="o">-</span> <span class="o">/</span><span class="n">data</span><span class="o">/</span><span class="n">compose</span><span class="o">/</span><span class="n">mysql</span><span class="o">/</span><span class="n">init</span><span class="p">:</span><span class="o">/</span><span class="n">docker</span><span class="o">-</span><span class="n">entrypoint</span><span class="o">-</span><span class="n">initdb</span><span class="o">.</span><span class="n">d</span><span class="o">/</span>
<a id="__codelineno-11-9" name="__codelineno-11-9"></a><a href="#__codelineno-11-9"><span class="linenos" data-linenos=" 9 "></span></a>  <span class="n">ports</span><span class="p">:</span>
<a id="__codelineno-11-10" name="__codelineno-11-10"></a><a href="#__codelineno-11-10"><span class="linenos" data-linenos="10 "></span></a>    <span class="o">-</span> <span class="s2">&quot;3306:3306&quot;</span>
</code></pre></div>
<h4 id="6django项目所依赖requirementstxt">（6）Django项目所依赖requirements.txt<a class="headerlink" href="#6django项目所依赖requirementstxt" title="Permanent link">&para;</a></h4>
<p>Django项目所依赖的<code>requirements.txt</code> 文件位于你的项目目录中，并且与 Dockerfile 处在同一目录下。</p>
<p>执行命令<code>vim /data/compose/myproject/requirements.txt</code></p>
<div class="language-python highlight"><span class="filename">Python</span><pre><span></span><code><a id="__codelineno-12-1" name="__codelineno-12-1"></a><a href="#__codelineno-12-1"><span class="linenos" data-linenos=" 1 "></span></a><span class="c1"># django</span>
<a id="__codelineno-12-2" name="__codelineno-12-2"></a><a href="#__codelineno-12-2"><span class="linenos" data-linenos=" 2 "></span></a><span class="n">django</span><span class="o">==</span><span class="mf">3.2</span>
<a id="__codelineno-12-3" name="__codelineno-12-3"></a><a href="#__codelineno-12-3"><span class="linenos" data-linenos=" 3 "></span></a><span class="c1"># uwsgi</span>
<a id="__codelineno-12-4" name="__codelineno-12-4"></a><a href="#__codelineno-12-4"><span class="linenos" data-linenos=" 4 "></span></a><span class="n">uwsgi</span><span class="o">==</span><span class="mf">2.0.18</span>
<a id="__codelineno-12-5" name="__codelineno-12-5"></a><a href="#__codelineno-12-5"><span class="linenos" data-linenos=" 5 "></span></a><span class="c1"># mysql</span>
<a id="__codelineno-12-6" name="__codelineno-12-6"></a><a href="#__codelineno-12-6"><span class="linenos" data-linenos=" 6 "></span></a><span class="n">mysqlclient</span><span class="o">==</span><span class="mf">1.4.6</span>
<a id="__codelineno-12-7" name="__codelineno-12-7"></a><a href="#__codelineno-12-7"><span class="linenos" data-linenos=" 7 "></span></a><span class="c1"># redis</span>
<a id="__codelineno-12-8" name="__codelineno-12-8"></a><a href="#__codelineno-12-8"><span class="linenos" data-linenos=" 8 "></span></a><span class="n">django</span><span class="o">-</span><span class="n">redis</span><span class="o">==</span><span class="mf">4.12.1</span>
<a id="__codelineno-12-9" name="__codelineno-12-9"></a><a href="#__codelineno-12-9"><span class="linenos" data-linenos=" 9 "></span></a><span class="n">redis</span><span class="o">==</span><span class="mf">3.5.3</span>
<a id="__codelineno-12-10" name="__codelineno-12-10"></a><a href="#__codelineno-12-10"><span class="linenos" data-linenos="10 "></span></a><span class="c1"># for images</span>
<a id="__codelineno-12-11" name="__codelineno-12-11"></a><a href="#__codelineno-12-11"><span class="linenos" data-linenos="11 "></span></a><span class="n">Pillow</span><span class="o">==</span><span class="mf">8.2.0</span> 
</code></pre></div>
<h4 id="7编写nginx镜像和容器所需文件">（7）编写Nginx镜像和容器所需文件<a class="headerlink" href="#7编写nginx镜像和容器所需文件" title="Permanent link">&para;</a></h4>
<p>需要为Nginx创建一个Dockerfile。这个文件定义了如何构建Nginx的Docker镜像。</p>
<div class="language-text highlight"><span class="filename">Text Only</span><pre><span></span><code><a id="__codelineno-13-1" name="__codelineno-13-1"></a><a href="#__codelineno-13-1"><span class="linenos" data-linenos="1 "></span></a>mkdir -p /data/compose/nginx
</code></pre></div>
<h4 id="1创建或编辑dockerfile">1.<strong>创建或编辑Dockerfile</strong>：<a class="headerlink" href="#1创建或编辑dockerfile" title="Permanent link">&para;</a></h4>
<p>创建或编辑<code>/data/compose/nginx/Dockerfile</code>，</p>
<div class="language-text highlight"><span class="filename">Text Only</span><pre><span></span><code><a id="__codelineno-14-1" name="__codelineno-14-1"></a><a href="#__codelineno-14-1"><span class="linenos" data-linenos="1 "></span></a>vim /data/compose/nginx/Dockerfile
</code></pre></div>
<p>复制并粘贴以下内容：</p>
<div class="language-text highlight"><span class="filename">Text Only</span><pre><span></span><code><a id="__codelineno-15-1" name="__codelineno-15-1"></a><a href="#__codelineno-15-1"><span class="linenos" data-linenos=" 1 "></span></a># nginx镜像compose/nginx/Dockerfile
<a id="__codelineno-15-2" name="__codelineno-15-2"></a><a href="#__codelineno-15-2"><span class="linenos" data-linenos=" 2 "></span></a>
<a id="__codelineno-15-3" name="__codelineno-15-3"></a><a href="#__codelineno-15-3"><span class="linenos" data-linenos=" 3 "></span></a>FROM nginx:latest
<a id="__codelineno-15-4" name="__codelineno-15-4"></a><a href="#__codelineno-15-4"><span class="linenos" data-linenos=" 4 "></span></a>
<a id="__codelineno-15-5" name="__codelineno-15-5"></a><a href="#__codelineno-15-5"><span class="linenos" data-linenos=" 5 "></span></a># 删除原有配置文件，创建静态资源文件夹和ssl证书保存文件夹
<a id="__codelineno-15-6" name="__codelineno-15-6"></a><a href="#__codelineno-15-6"><span class="linenos" data-linenos=" 6 "></span></a>RUN rm /etc/nginx/conf.d/default.conf \
<a id="__codelineno-15-7" name="__codelineno-15-7"></a><a href="#__codelineno-15-7"><span class="linenos" data-linenos=" 7 "></span></a>&amp;&amp; mkdir -p /usr/share/nginx/html/static \
<a id="__codelineno-15-8" name="__codelineno-15-8"></a><a href="#__codelineno-15-8"><span class="linenos" data-linenos=" 8 "></span></a>&amp;&amp; mkdir -p /usr/share/nginx/html/media \
<a id="__codelineno-15-9" name="__codelineno-15-9"></a><a href="#__codelineno-15-9"><span class="linenos" data-linenos=" 9 "></span></a>&amp;&amp; mkdir -p /usr/share/nginx/ssl
<a id="__codelineno-15-10" name="__codelineno-15-10"></a><a href="#__codelineno-15-10"><span class="linenos" data-linenos="10 "></span></a>
<a id="__codelineno-15-11" name="__codelineno-15-11"></a><a href="#__codelineno-15-11"><span class="linenos" data-linenos="11 "></span></a># 设置Media文件夹用户和用户组为Linux默认www-data, 并给予可读和可执行权限,
<a id="__codelineno-15-12" name="__codelineno-15-12"></a><a href="#__codelineno-15-12"><span class="linenos" data-linenos="12 "></span></a># 否则用户上传的图片无法正确显示。
<a id="__codelineno-15-13" name="__codelineno-15-13"></a><a href="#__codelineno-15-13"><span class="linenos" data-linenos="13 "></span></a>RUN chown -R www-data:www-data /usr/share/nginx/html/media \
<a id="__codelineno-15-14" name="__codelineno-15-14"></a><a href="#__codelineno-15-14"><span class="linenos" data-linenos="14 "></span></a>&amp;&amp; chmod -R 775 /usr/share/nginx/html/media
<a id="__codelineno-15-15" name="__codelineno-15-15"></a><a href="#__codelineno-15-15"><span class="linenos" data-linenos="15 "></span></a>
<a id="__codelineno-15-16" name="__codelineno-15-16"></a><a href="#__codelineno-15-16"><span class="linenos" data-linenos="16 "></span></a># 添加配置文件
<a id="__codelineno-15-17" name="__codelineno-15-17"></a><a href="#__codelineno-15-17"><span class="linenos" data-linenos="17 "></span></a>ADD ./nginx.conf /etc/nginx/conf.d/
<a id="__codelineno-15-18" name="__codelineno-15-18"></a><a href="#__codelineno-15-18"><span class="linenos" data-linenos="18 "></span></a>
<a id="__codelineno-15-19" name="__codelineno-15-19"></a><a href="#__codelineno-15-19"><span class="linenos" data-linenos="19 "></span></a># 关闭守护模式
<a id="__codelineno-15-20" name="__codelineno-15-20"></a><a href="#__codelineno-15-20"><span class="linenos" data-linenos="20 "></span></a>CMD [&quot;nginx&quot;, &quot;-g&quot;, &quot;daemon off;&quot;]
</code></pre></div>
<h4 id="2-创建nginx配置文件nginxconf">2. 创建Nginx配置文件（nginx.conf）<a class="headerlink" href="#2-创建nginx配置文件nginxconf" title="Permanent link">&para;</a></h4>
<ol>
<li>创建或编辑nginx.conf配置文件，确保正确地代理到你的Django应用。</li>
</ol>
<div class="language-text highlight"><span class="filename">Text Only</span><pre><span></span><code><a id="__codelineno-16-1" name="__codelineno-16-1"></a><a href="#__codelineno-16-1"><span class="linenos" data-linenos="1 "></span></a>vim /data/compose/nginx/nginx.conf
</code></pre></div>
<ul>
<li>在<code>/data/compose/nginx</code>目录下创建或编辑<code>nginx.conf</code>文件。</li>
<li>复制并粘贴以下内容：</li>
</ul>
<div class="language-python highlight"><span class="filename">Python</span><pre><span></span><code><a id="__codelineno-17-1" name="__codelineno-17-1"></a><a href="#__codelineno-17-1"><span class="linenos" data-linenos=" 1 "></span></a><span class="c1"># nginx配置文件</span>
<a id="__codelineno-17-2" name="__codelineno-17-2"></a><a href="#__codelineno-17-2"><span class="linenos" data-linenos=" 2 "></span></a><span class="c1"># compose/nginx/nginx.conf</span>
<a id="__codelineno-17-3" name="__codelineno-17-3"></a><a href="#__codelineno-17-3"><span class="linenos" data-linenos=" 3 "></span></a>
<a id="__codelineno-17-4" name="__codelineno-17-4"></a><a href="#__codelineno-17-4"><span class="linenos" data-linenos=" 4 "></span></a><span class="n">upstream</span> <span class="n">django</span> <span class="p">{</span>
<a id="__codelineno-17-5" name="__codelineno-17-5"></a><a href="#__codelineno-17-5"><span class="linenos" data-linenos=" 5 "></span></a>    <span class="n">ip_hash</span><span class="p">;</span>
<a id="__codelineno-17-6" name="__codelineno-17-6"></a><a href="#__codelineno-17-6"><span class="linenos" data-linenos=" 6 "></span></a>    <span class="n">server</span> <span class="n">web</span><span class="p">:</span><span class="mi">8000</span><span class="p">;</span> <span class="c1"># Docker-compose web服务端口</span>
<a id="__codelineno-17-7" name="__codelineno-17-7"></a><a href="#__codelineno-17-7"><span class="linenos" data-linenos=" 7 "></span></a><span class="p">}</span>
<a id="__codelineno-17-8" name="__codelineno-17-8"></a><a href="#__codelineno-17-8"><span class="linenos" data-linenos=" 8 "></span></a>
<a id="__codelineno-17-9" name="__codelineno-17-9"></a><a href="#__codelineno-17-9"><span class="linenos" data-linenos=" 9 "></span></a><span class="c1"># 配置http请求，80端口</span>
<a id="__codelineno-17-10" name="__codelineno-17-10"></a><a href="#__codelineno-17-10"><span class="linenos" data-linenos="10 "></span></a><span class="n">server</span> <span class="p">{</span>
<a id="__codelineno-17-11" name="__codelineno-17-11"></a><a href="#__codelineno-17-11"><span class="linenos" data-linenos="11 "></span></a>    <span class="n">listen</span> <span class="mi">80</span><span class="p">;</span> <span class="c1"># 监听80端口</span>
<a id="__codelineno-17-12" name="__codelineno-17-12"></a><a href="#__codelineno-17-12"><span class="linenos" data-linenos="12 "></span></a>    <span class="n">server_name</span> <span class="mf">127.0.0.1</span><span class="p">;</span> <span class="c1"># 可以是nginx容器所在ip地址或127.0.0.1，不能写宿主机外网ip地址</span>
<a id="__codelineno-17-13" name="__codelineno-17-13"></a><a href="#__codelineno-17-13"><span class="linenos" data-linenos="13 "></span></a>
<a id="__codelineno-17-14" name="__codelineno-17-14"></a><a href="#__codelineno-17-14"><span class="linenos" data-linenos="14 "></span></a>    <span class="n">charset</span> <span class="n">utf</span><span class="o">-</span><span class="mi">8</span><span class="p">;</span>
<a id="__codelineno-17-15" name="__codelineno-17-15"></a><a href="#__codelineno-17-15"><span class="linenos" data-linenos="15 "></span></a>    <span class="n">client_max_body_size</span> <span class="mi">10</span><span class="n">M</span><span class="p">;</span> <span class="c1"># 限制用户上传文件大小</span>
<a id="__codelineno-17-16" name="__codelineno-17-16"></a><a href="#__codelineno-17-16"><span class="linenos" data-linenos="16 "></span></a>
<a id="__codelineno-17-17" name="__codelineno-17-17"></a><a href="#__codelineno-17-17"><span class="linenos" data-linenos="17 "></span></a>    <span class="n">access_log</span> <span class="o">/</span><span class="n">var</span><span class="o">/</span><span class="n">log</span><span class="o">/</span><span class="n">nginx</span><span class="o">/</span><span class="n">access</span><span class="o">.</span><span class="n">log</span> <span class="n">main</span><span class="p">;</span>
<a id="__codelineno-17-18" name="__codelineno-17-18"></a><a href="#__codelineno-17-18"><span class="linenos" data-linenos="18 "></span></a>    <span class="n">error_log</span> <span class="o">/</span><span class="n">var</span><span class="o">/</span><span class="n">log</span><span class="o">/</span><span class="n">nginx</span><span class="o">/</span><span class="n">error</span><span class="o">.</span><span class="n">log</span> <span class="n">warn</span><span class="p">;</span>
<a id="__codelineno-17-19" name="__codelineno-17-19"></a><a href="#__codelineno-17-19"><span class="linenos" data-linenos="19 "></span></a>
<a id="__codelineno-17-20" name="__codelineno-17-20"></a><a href="#__codelineno-17-20"><span class="linenos" data-linenos="20 "></span></a>    <span class="n">location</span> <span class="o">/</span><span class="n">static</span> <span class="p">{</span>
<a id="__codelineno-17-21" name="__codelineno-17-21"></a><a href="#__codelineno-17-21"><span class="linenos" data-linenos="21 "></span></a>        <span class="n">alias</span> <span class="o">/</span><span class="n">usr</span><span class="o">/</span><span class="n">share</span><span class="o">/</span><span class="n">nginx</span><span class="o">/</span><span class="n">html</span><span class="o">/</span><span class="n">static</span><span class="p">;</span> <span class="c1"># 静态资源路径</span>
<a id="__codelineno-17-22" name="__codelineno-17-22"></a><a href="#__codelineno-17-22"><span class="linenos" data-linenos="22 "></span></a>    <span class="p">}</span>
<a id="__codelineno-17-23" name="__codelineno-17-23"></a><a href="#__codelineno-17-23"><span class="linenos" data-linenos="23 "></span></a>
<a id="__codelineno-17-24" name="__codelineno-17-24"></a><a href="#__codelineno-17-24"><span class="linenos" data-linenos="24 "></span></a>    <span class="n">location</span> <span class="o">/</span><span class="n">media</span> <span class="p">{</span>
<a id="__codelineno-17-25" name="__codelineno-17-25"></a><a href="#__codelineno-17-25"><span class="linenos" data-linenos="25 "></span></a>        <span class="n">alias</span> <span class="o">/</span><span class="n">usr</span><span class="o">/</span><span class="n">share</span><span class="o">/</span><span class="n">nginx</span><span class="o">/</span><span class="n">html</span><span class="o">/</span><span class="n">media</span><span class="p">;</span> <span class="c1"># 媒体资源，用户上传文件路径</span>
<a id="__codelineno-17-26" name="__codelineno-17-26"></a><a href="#__codelineno-17-26"><span class="linenos" data-linenos="26 "></span></a>    <span class="p">}</span>
<a id="__codelineno-17-27" name="__codelineno-17-27"></a><a href="#__codelineno-17-27"><span class="linenos" data-linenos="27 "></span></a>
<a id="__codelineno-17-28" name="__codelineno-17-28"></a><a href="#__codelineno-17-28"><span class="linenos" data-linenos="28 "></span></a>    <span class="n">location</span> <span class="o">/</span> <span class="p">{</span>
<a id="__codelineno-17-29" name="__codelineno-17-29"></a><a href="#__codelineno-17-29"><span class="linenos" data-linenos="29 "></span></a>        <span class="n">include</span> <span class="o">/</span><span class="n">etc</span><span class="o">/</span><span class="n">nginx</span><span class="o">/</span><span class="n">uwsgi_params</span><span class="p">;</span>
<a id="__codelineno-17-30" name="__codelineno-17-30"></a><a href="#__codelineno-17-30"><span class="linenos" data-linenos="30 "></span></a>        <span class="n">uwsgi_pass</span> <span class="n">django</span><span class="p">;</span>
<a id="__codelineno-17-31" name="__codelineno-17-31"></a><a href="#__codelineno-17-31"><span class="linenos" data-linenos="31 "></span></a>        <span class="n">uwsgi_read_timeout</span> <span class="mi">600</span><span class="p">;</span>
<a id="__codelineno-17-32" name="__codelineno-17-32"></a><a href="#__codelineno-17-32"><span class="linenos" data-linenos="32 "></span></a>        <span class="n">uwsgi_connect_timeout</span> <span class="mi">600</span><span class="p">;</span>
<a id="__codelineno-17-33" name="__codelineno-17-33"></a><a href="#__codelineno-17-33"><span class="linenos" data-linenos="33 "></span></a>        <span class="n">uwsgi_send_timeout</span> <span class="mi">600</span><span class="p">;</span>
<a id="__codelineno-17-34" name="__codelineno-17-34"></a><a href="#__codelineno-17-34"><span class="linenos" data-linenos="34 "></span></a>
<a id="__codelineno-17-35" name="__codelineno-17-35"></a><a href="#__codelineno-17-35"><span class="linenos" data-linenos="35 "></span></a>        <span class="n">proxy_set_header</span> <span class="n">X</span><span class="o">-</span><span class="n">Forwarded</span><span class="o">-</span><span class="n">For</span> <span class="err">$</span><span class="n">proxy_add_x_forwarded_for</span><span class="p">;</span>
<a id="__codelineno-17-36" name="__codelineno-17-36"></a><a href="#__codelineno-17-36"><span class="linenos" data-linenos="36 "></span></a>        <span class="n">proxy_redirect</span> <span class="n">off</span><span class="p">;</span>
<a id="__codelineno-17-37" name="__codelineno-17-37"></a><a href="#__codelineno-17-37"><span class="linenos" data-linenos="37 "></span></a>        <span class="n">proxy_set_header</span> <span class="n">X</span><span class="o">-</span><span class="n">Real</span><span class="o">-</span><span class="n">IP</span>  <span class="err">$</span><span class="n">remote_addr</span><span class="p">;</span>
<a id="__codelineno-17-38" name="__codelineno-17-38"></a><a href="#__codelineno-17-38"><span class="linenos" data-linenos="38 "></span></a>    <span class="p">}</span>
<a id="__codelineno-17-39" name="__codelineno-17-39"></a><a href="#__codelineno-17-39"><span class="linenos" data-linenos="39 "></span></a><span class="p">}</span>
</code></pre></div>
<h4 id="8编写db-mysql容器配置文件">（8）编写Db (MySQL)容器配置文件<a class="headerlink" href="#8编写db-mysql容器配置文件" title="Permanent link">&para;</a></h4>
<ol>
<li><strong>创建配置文件目录</strong>：</li>
</ol>
<div class="language-text highlight"><span class="filename">Text Only</span><pre><span></span><code><a id="__codelineno-18-1" name="__codelineno-18-1"></a><a href="#__codelineno-18-1"><span class="linenos" data-linenos="1 "></span></a>mkdir -p /data/compose/mysql/conf
</code></pre></div>
<ol>
<li><strong>创建或编辑MySQL的配置文件 (<code>my.cnf</code>)</strong>：</li>
</ol>
<p>在<code>/data/compose/mysql/conf</code>目录下创建或编辑名为<code>my.cnf</code>的文件。</p>
<div class="language-text highlight"><span class="filename">Text Only</span><pre><span></span><code><a id="__codelineno-19-1" name="__codelineno-19-1"></a><a href="#__codelineno-19-1"><span class="linenos" data-linenos="1 "></span></a>vim /data/compose/mysql/conf/my.cnf
</code></pre></div>
<ul>
<li>复制并粘贴以下配置内容：</li>
</ul>
<div class="language-text highlight"><span class="filename">Text Only</span><pre><span></span><code><a id="__codelineno-20-1" name="__codelineno-20-1"></a><a href="#__codelineno-20-1"><span class="linenos" data-linenos=" 1 "></span></a>#/data/compose/mysql/conf/my.cnf
<a id="__codelineno-20-2" name="__codelineno-20-2"></a><a href="#__codelineno-20-2"><span class="linenos" data-linenos=" 2 "></span></a>[mysqld]
<a id="__codelineno-20-3" name="__codelineno-20-3"></a><a href="#__codelineno-20-3"><span class="linenos" data-linenos=" 3 "></span></a>user=mysql
<a id="__codelineno-20-4" name="__codelineno-20-4"></a><a href="#__codelineno-20-4"><span class="linenos" data-linenos=" 4 "></span></a>default-storage-engine=INNODB
<a id="__codelineno-20-5" name="__codelineno-20-5"></a><a href="#__codelineno-20-5"><span class="linenos" data-linenos=" 5 "></span></a>character-set-server=utf8
<a id="__codelineno-20-6" name="__codelineno-20-6"></a><a href="#__codelineno-20-6"><span class="linenos" data-linenos=" 6 "></span></a>secure-file-priv=NULL # mysql 8 新增这行配置
<a id="__codelineno-20-7" name="__codelineno-20-7"></a><a href="#__codelineno-20-7"><span class="linenos" data-linenos=" 7 "></span></a>default-authentication-plugin=mysql_native_password  # mysql 8 新增这行配置
<a id="__codelineno-20-8" name="__codelineno-20-8"></a><a href="#__codelineno-20-8"><span class="linenos" data-linenos=" 8 "></span></a>
<a id="__codelineno-20-9" name="__codelineno-20-9"></a><a href="#__codelineno-20-9"><span class="linenos" data-linenos=" 9 "></span></a>port            = 3306 # 端口与docker-compose里映射端口保持一致
<a id="__codelineno-20-10" name="__codelineno-20-10"></a><a href="#__codelineno-20-10"><span class="linenos" data-linenos="10 "></span></a>#bind-address= localhost #一定要注释掉，mysql所在容器和django所在容器不同IP
<a id="__codelineno-20-11" name="__codelineno-20-11"></a><a href="#__codelineno-20-11"><span class="linenos" data-linenos="11 "></span></a>
<a id="__codelineno-20-12" name="__codelineno-20-12"></a><a href="#__codelineno-20-12"><span class="linenos" data-linenos="12 "></span></a>basedir         = /usr
<a id="__codelineno-20-13" name="__codelineno-20-13"></a><a href="#__codelineno-20-13"><span class="linenos" data-linenos="13 "></span></a>datadir         = /var/lib/mysql
<a id="__codelineno-20-14" name="__codelineno-20-14"></a><a href="#__codelineno-20-14"><span class="linenos" data-linenos="14 "></span></a>tmpdir          = /tmp
<a id="__codelineno-20-15" name="__codelineno-20-15"></a><a href="#__codelineno-20-15"><span class="linenos" data-linenos="15 "></span></a>pid-file        = /var/run/mysqld/mysqld.pid
<a id="__codelineno-20-16" name="__codelineno-20-16"></a><a href="#__codelineno-20-16"><span class="linenos" data-linenos="16 "></span></a>socket          = /var/run/mysqld/mysqld.sock
<a id="__codelineno-20-17" name="__codelineno-20-17"></a><a href="#__codelineno-20-17"><span class="linenos" data-linenos="17 "></span></a>skip-name-resolve  # 这个参数是禁止域名解析的，远程访问推荐开启skip_name_resolve。
<a id="__codelineno-20-18" name="__codelineno-20-18"></a><a href="#__codelineno-20-18"><span class="linenos" data-linenos="18 "></span></a>
<a id="__codelineno-20-19" name="__codelineno-20-19"></a><a href="#__codelineno-20-19"><span class="linenos" data-linenos="19 "></span></a>[client]
<a id="__codelineno-20-20" name="__codelineno-20-20"></a><a href="#__codelineno-20-20"><span class="linenos" data-linenos="20 "></span></a>port = 3306
<a id="__codelineno-20-21" name="__codelineno-20-21"></a><a href="#__codelineno-20-21"><span class="linenos" data-linenos="21 "></span></a>default-character-set=utf8
<a id="__codelineno-20-22" name="__codelineno-20-22"></a><a href="#__codelineno-20-22"><span class="linenos" data-linenos="22 "></span></a>
<a id="__codelineno-20-23" name="__codelineno-20-23"></a><a href="#__codelineno-20-23"><span class="linenos" data-linenos="23 "></span></a>[mysql]
<a id="__codelineno-20-24" name="__codelineno-20-24"></a><a href="#__codelineno-20-24"><span class="linenos" data-linenos="24 "></span></a>no-auto-rehash
<a id="__codelineno-20-25" name="__codelineno-20-25"></a><a href="#__codelineno-20-25"><span class="linenos" data-linenos="25 "></span></a>default-character-set=utf8
</code></pre></div>
<ol>
<li>准备MySQL初始化脚本</li>
</ol>
<p>初始化脚本在MySQL第一次启动时运行，用于设置数据库的初始状态，包括用户权限等。</p>
<ol>
<li><strong>创建初始化脚本目录</strong>：</li>
</ol>
<p><code>mkdir -p /data/compose/mysql/init</code></p>
<ol>
<li>
<p><strong>创建或编辑初始化脚本 (<code>init.sql</code>)</strong>：</p>
</li>
<li>
<p>在<code>/data/compose/mysql/init</code>目录下创建或编辑名为<code>init.sql</code>的文件。</p>
<div class="language-vim highlight"><span class="filename">VimL</span><pre><span></span><code><a id="__codelineno-21-1" name="__codelineno-21-1"></a><a href="#__codelineno-21-1"><span class="linenos" data-linenos="1 "></span></a><span class="k">vim</span> <span class="sr">/data/</span>compose<span class="sr">/mysql/</span>init/init.sql
</code></pre></div>
</li>
<li>
<p>我们还需设置MySQL服务启动时需要执行的脚本命令, 注意这里的用户名和password必需和myproject目录下<code>.env</code>文件中的环境变量保持一致。复制并粘贴以下内容，保存文件：</p>
</li>
</ol>
<div class="language-text highlight"><span class="filename">Text Only</span><pre><span></span><code><a id="__codelineno-22-1" name="__codelineno-22-1"></a><a href="#__codelineno-22-1"><span class="linenos" data-linenos="1 "></span></a># compose/mysql/init/init.sql
<a id="__codelineno-22-2" name="__codelineno-22-2"></a><a href="#__codelineno-22-2"><span class="linenos" data-linenos="2 "></span></a>ALTER USER &#39;dbuser&#39;@&#39;%&#39; IDENTIFIED WITH mysql_native_password BY &#39;password&#39;;
<a id="__codelineno-22-3" name="__codelineno-22-3"></a><a href="#__codelineno-22-3"><span class="linenos" data-linenos="3 "></span></a>GRANT ALL PRIVILEGES ON myproject.* TO &#39;dbuser&#39;@&#39;%&#39;;
<a id="__codelineno-22-4" name="__codelineno-22-4"></a><a href="#__codelineno-22-4"><span class="linenos" data-linenos="4 "></span></a>FLUSH PRIVILEGES;
</code></pre></div>
<p>确保已经正确创建和配置了MySQL的<code>my.cnf</code>和<code>init.sql</code>文件。这些设置将确保你的MySQL数据库按预期运行，并具有适当的安全配置。</p>
<h4 id="9编写redis-容器配置文件">（9）编写Redis 容器配置文件<a class="headerlink" href="#9编写redis-容器配置文件" title="Permanent link">&para;</a></h4>
<p>为了确保Redis服务正常运行并满足Django项目的需要，我们将配置Redis的配置文件，并确保它能够与Django顺利集成。</p>
<h4 id="1-创建redis配置文件">1. 创建Redis配置文件<a class="headerlink" href="#1-创建redis配置文件" title="Permanent link">&para;</a></h4>
<p>Redis配置文件允许你自定义各种设置，例如持久化选项、密码保护等。</p>
<ol>
<li><strong>创建配置文件目录</strong>（如果尚未创建）：</li>
</ol>
<div class="language-text highlight"><span class="filename">Text Only</span><pre><span></span><code><a id="__codelineno-23-1" name="__codelineno-23-1"></a><a href="#__codelineno-23-1"><span class="linenos" data-linenos="1 "></span></a>mkdir -p /data/compose/redis
</code></pre></div>
<ol>
<li>
<p><strong>创建或编辑Redis的配置文件</strong>：</p>
</li>
<li>
<p>在<code>/data/compose/redis</code>目录下创建或编辑名为<code>redis.conf</code>的文件。</p>
<div class="language-text highlight"><span class="filename">Text Only</span><pre><span></span><code><a id="__codelineno-24-1" name="__codelineno-24-1"></a><a href="#__codelineno-24-1"><span class="linenos" data-linenos="1 "></span></a>vim /data/compose/redis/redis.conf
</code></pre></div>
</li>
<li>
<p>复制并粘贴以下内容（包括设置密码，这很重要，因为它将与Django设置中的密码相匹配）：</p>
</li>
</ol>
<div class="language-text highlight"><span class="filename">Text Only</span><pre><span></span><code><a id="__codelineno-25-1" name="__codelineno-25-1"></a><a href="#__codelineno-25-1"><span class="linenos" data-linenos="1 "></span></a># Redis配置文件
<a id="__codelineno-25-2" name="__codelineno-25-2"></a><a href="#__codelineno-25-2"><span class="linenos" data-linenos="2 "></span></a># compose/redis/redis.conf
<a id="__codelineno-25-3" name="__codelineno-25-3"></a><a href="#__codelineno-25-3"><span class="linenos" data-linenos="3 "></span></a>
<a id="__codelineno-25-4" name="__codelineno-25-4"></a><a href="#__codelineno-25-4"><span class="linenos" data-linenos="4 "></span></a># 请注释掉下面一行，变成#bind 127.0.0.1,这样其它机器或容器也可访问
<a id="__codelineno-25-5" name="__codelineno-25-5"></a><a href="#__codelineno-25-5"><span class="linenos" data-linenos="5 "></span></a>bind 127.0.0.1
<a id="__codelineno-25-6" name="__codelineno-25-6"></a><a href="#__codelineno-25-6"><span class="linenos" data-linenos="6 "></span></a>
<a id="__codelineno-25-7" name="__codelineno-25-7"></a><a href="#__codelineno-25-7"><span class="linenos" data-linenos="7 "></span></a># 取消下行注释，给redis设置登录密码。这个密码django settings.py会用到。
<a id="__codelineno-25-8" name="__codelineno-25-8"></a><a href="#__codelineno-25-8"><span class="linenos" data-linenos="8 "></span></a>requirepass yourpassword
</code></pre></div>
<ul>
<li>在<code>yourpassword</code>处替换为你实际想使用的密码，确保它与Django配置中的密码相匹配。</li>
<li>保存文件。</li>
</ul>
<h4 id="2-确保docker-compose使用redis配置文件">2. 确保Docker-compose使用Redis配置文件<a class="headerlink" href="#2-确保docker-compose使用redis配置文件" title="Permanent link">&para;</a></h4>
<p>在<code>docker-compose.yml</code>中配置Redis服务，确保它使用了刚才编辑的配置文件：</p>
<div class="language-text highlight"><span class="filename">Text Only</span><pre><span></span><code><a id="__codelineno-26-1" name="__codelineno-26-1"></a><a href="#__codelineno-26-1"><span class="linenos" data-linenos="1 "></span></a>redis:
<a id="__codelineno-26-2" name="__codelineno-26-2"></a><a href="#__codelineno-26-2"><span class="linenos" data-linenos="2 "></span></a>  image: redis:latest
<a id="__codelineno-26-3" name="__codelineno-26-3"></a><a href="#__codelineno-26-3"><span class="linenos" data-linenos="3 "></span></a>  command: redis-server /usr/local/etc/redis/redis.conf
<a id="__codelineno-26-4" name="__codelineno-26-4"></a><a href="#__codelineno-26-4"><span class="linenos" data-linenos="4 "></span></a>  volumes:
<a id="__codelineno-26-5" name="__codelineno-26-5"></a><a href="#__codelineno-26-5"><span class="linenos" data-linenos="5 "></span></a>    - redis_vol:/data
<a id="__codelineno-26-6" name="__codelineno-26-6"></a><a href="#__codelineno-26-6"><span class="linenos" data-linenos="6 "></span></a>    - /data/compose/redis/redis.conf:/usr/local/etc/redis/redis.conf
<a id="__codelineno-26-7" name="__codelineno-26-7"></a><a href="#__codelineno-26-7"><span class="linenos" data-linenos="7 "></span></a>  ports:
<a id="__codelineno-26-8" name="__codelineno-26-8"></a><a href="#__codelineno-26-8"><span class="linenos" data-linenos="8 "></span></a>    - &quot;6379:6379&quot;
</code></pre></div>
<p>这将确保Redis在启动时加载你指定的配置文件。</p>
<h4 id="10配置pip">（10）配置Pip<a class="headerlink" href="#10配置pip" title="Permanent link">&para;</a></h4>
<ol>
<li><strong>选择位置</strong>：为了方便管理，应该将 <code>pip.conf</code> 放置在包含Dockerfile的同一目录下。</li>
<li><strong>创建文件</strong>：在 <code>/data/compose/myproject</code> 目录（即你的Dockerfile所在的目录）中创建 <code>pip.conf</code> 文件。</li>
</ol>
<p>创建<code>pip.conf</code>文件</p>
<div class="language-text highlight"><span class="filename">Text Only</span><pre><span></span><code><a id="__codelineno-27-1" name="__codelineno-27-1"></a><a href="#__codelineno-27-1"><span class="linenos" data-linenos="1 "></span></a>vim /data/compose/myproject/pip.conf
</code></pre></div>
<p><strong>填充文件内容</strong>：在编辑器中，输入以下内容，这里以阿里云的Python镜像源为例，当然你也可以选择其他如清华大学等镜像源：</p>
<div class="language-text highlight"><span class="filename">Text Only</span><pre><span></span><code><a id="__codelineno-28-1" name="__codelineno-28-1"></a><a href="#__codelineno-28-1"><span class="linenos" data-linenos="1 "></span></a>[global]
<a id="__codelineno-28-2" name="__codelineno-28-2"></a><a href="#__codelineno-28-2"><span class="linenos" data-linenos="2 "></span></a>index-url = https://mirrors.aliyun.com/pypi/simple/
<a id="__codelineno-28-3" name="__codelineno-28-3"></a><a href="#__codelineno-28-3"><span class="linenos" data-linenos="3 "></span></a>
<a id="__codelineno-28-4" name="__codelineno-28-4"></a><a href="#__codelineno-28-4"><span class="linenos" data-linenos="4 "></span></a>[install]
<a id="__codelineno-28-5" name="__codelineno-28-5"></a><a href="#__codelineno-28-5"><span class="linenos" data-linenos="5 "></span></a>trusted-host = mirrors.aliyun.com
</code></pre></div>
<p><strong>完成这些步骤后，所有的配置就配置好了。</strong></p>
<h2 id="3构建镜像">（3）构建镜像<a class="headerlink" href="#3构建镜像" title="Permanent link">&para;</a></h2>
<h1 id="进入到包含-docker-composeyml的目录">进入到包含 docker-compose.yml的目录<a class="headerlink" href="#进入到包含-docker-composeyml的目录" title="Permanent link">&para;</a></h1>
<div class="language-text highlight"><span class="filename">Text Only</span><pre><span></span><code><a id="__codelineno-29-1" name="__codelineno-29-1"></a><a href="#__codelineno-29-1"><span class="linenos" data-linenos="1 "></span></a>cd /data/compose/myproject       
</code></pre></div>
<h1 id="构建镜像">构建镜像<a class="headerlink" href="#构建镜像" title="Permanent link">&para;</a></h1>
<div class="language-text highlight"><span class="filename">Text Only</span><pre><span></span><code><a id="__codelineno-30-1" name="__codelineno-30-1"></a><a href="#__codelineno-30-1"><span class="linenos" data-linenos="1 "></span></a>docker-compose build
</code></pre></div>
<p>如果构建没有出错，可以查看已生成的镜像</p>
<h1 id="查看已生成的镜像">查看已生成的镜像<a class="headerlink" href="#查看已生成的镜像" title="Permanent link">&para;</a></h1>
<div class="language-text highlight"><span class="filename">Text Only</span><pre><span></span><code><a id="__codelineno-31-1" name="__codelineno-31-1"></a><a href="#__codelineno-31-1"><span class="linenos" data-linenos="1 "></span></a>docker images
</code></pre></div>
<div class="language-text highlight"><span class="filename">Text Only</span><pre><span></span><code><a id="__codelineno-32-1" name="__codelineno-32-1"></a><a href="#__codelineno-32-1"><span class="linenos" data-linenos="1 "></span></a>REPOSITORY                     TAG       IMAGE ID       CREATED         SIZE
<a id="__codelineno-32-2" name="__codelineno-32-2"></a><a href="#__codelineno-32-2"><span class="linenos" data-linenos="2 "></span></a>myproject_nginx                latest    4754c26b94db   2 hours ago     188MB
<a id="__codelineno-32-3" name="__codelineno-32-3"></a><a href="#__codelineno-32-3"><span class="linenos" data-linenos="3 "></span></a>myproject_web                  latest    2d7f60435555   2 hours ago     757MB
<a id="__codelineno-32-4" name="__codelineno-32-4"></a><a href="#__codelineno-32-4"><span class="linenos" data-linenos="4 "></span></a>redis                          latest    7fc37b47acde   2 weeks ago     116MB
<a id="__codelineno-32-5" name="__codelineno-32-5"></a><a href="#__codelineno-32-5"><span class="linenos" data-linenos="5 "></span></a>mysql                          latest    6f343283ab56   4 weeks ago     632MB
</code></pre></div>
<h2 id="4启动django容器">（4）启动django容器<a class="headerlink" href="#4启动django容器" title="Permanent link">&para;</a></h2>
<p>进入docker-compose.yml所在文件夹，输入以下命令：</p>
<div class="language-text highlight"><span class="filename">Text Only</span><pre><span></span><code><a id="__codelineno-33-1" name="__codelineno-33-1"></a><a href="#__codelineno-33-1"><span class="linenos" data-linenos="1 "></span></a>#启动容器组服务
<a id="__codelineno-33-2" name="__codelineno-33-2"></a><a href="#__codelineno-33-2"><span class="linenos" data-linenos="2 "></span></a>docker-compose up
<a id="__codelineno-33-3" name="__codelineno-33-3"></a><a href="#__codelineno-33-3"><span class="linenos" data-linenos="3 "></span></a>
<a id="__codelineno-33-4" name="__codelineno-33-4"></a><a href="#__codelineno-33-4"><span class="linenos" data-linenos="4 "></span></a>docker-compose down         # 停止并移除当前容器
<a id="__codelineno-33-5" name="__codelineno-33-5"></a><a href="#__codelineno-33-5"><span class="linenos" data-linenos="5 "></span></a>docker-compose up -d        # 以分离模式重新启动容器
<a id="__codelineno-33-6" name="__codelineno-33-6"></a><a href="#__codelineno-33-6"><span class="linenos" data-linenos="6 "></span></a>docker-compose logs         # 查看所有服务的日志
<a id="__codelineno-33-7" name="__codelineno-33-7"></a><a href="#__codelineno-33-7"><span class="linenos" data-linenos="7 "></span></a>docker-compose logs web     # 只查看 web 服务的日志
</code></pre></div>
<p>启动进程如下：</p>
<div class="language-text highlight"><span class="filename">Text Only</span><pre><span></span><code><a id="__codelineno-34-1" name="__codelineno-34-1"></a><a href="#__codelineno-34-1"><span class="linenos" data-linenos="1 "></span></a>[root@zhongjl-test-02 /data/compose/myproject]# docker ps
<a id="__codelineno-34-2" name="__codelineno-34-2"></a><a href="#__codelineno-34-2"><span class="linenos" data-linenos="2 "></span></a>CONTAINER ID   IMAGE               COMMAND                  CREATED          STATUS                PORTS                                                                      NAMES
<a id="__codelineno-34-3" name="__codelineno-34-3"></a><a href="#__codelineno-34-3"><span class="linenos" data-linenos="3 "></span></a>2c8dffdea778   myproject_nginx     &quot;/docker-entrypoint.…&quot;   37 minutes ago   Up 37 minutes         0.0.0.0:80-&gt;80/tcp, :::80-&gt;80/tcp, 0.0.0.0:443-&gt;443/tcp, :::443-&gt;443/tcp   myproject_nginx_1
<a id="__codelineno-34-4" name="__codelineno-34-4"></a><a href="#__codelineno-34-4"><span class="linenos" data-linenos="4 "></span></a>f8fa4584492a   myproject_web       &quot;/bin/bash /data/com…&quot;   37 minutes ago   Up 37 minutes         0.0.0.0:8000-&gt;8000/tcp, :::8000-&gt;8000/tcp                                  myproject_web_1
<a id="__codelineno-34-5" name="__codelineno-34-5"></a><a href="#__codelineno-34-5"><span class="linenos" data-linenos="5 "></span></a>9ed8a88e19cf   redis:latest        &quot;docker-entrypoint.s…&quot;   37 minutes ago   Up 37 minutes         0.0.0.0:6379-&gt;6379/tcp, :::6379-&gt;6379/tcp                                  myproject_redis_1
<a id="__codelineno-34-6" name="__codelineno-34-6"></a><a href="#__codelineno-34-6"><span class="linenos" data-linenos="6 "></span></a>1c1c7224efee   mysql               &quot;docker-entrypoint.s…&quot;   37 minutes ago   Up 37 minutes         0.0.0.0:3306-&gt;3306/tcp, :::3306-&gt;3306/tcp, 33060/tcp                       myproject_db_1
</code></pre></div>
<h2 id="5创建django项目">（5）创建Django项目<a class="headerlink" href="#5创建django项目" title="Permanent link">&para;</a></h2>
<p>django项目（myproject）的目录结构</p>
<div class="language-text highlight"><span class="filename">Text Only</span><pre><span></span><code><a id="__codelineno-35-1" name="__codelineno-35-1"></a><a href="#__codelineno-35-1"><span class="linenos" data-linenos=" 1 "></span></a>[root@zhongjl-test-02 /data/compose/myproject]# tree myproject/
<a id="__codelineno-35-2" name="__codelineno-35-2"></a><a href="#__codelineno-35-2"><span class="linenos" data-linenos=" 2 "></span></a>myproject/
<a id="__codelineno-35-3" name="__codelineno-35-3"></a><a href="#__codelineno-35-3"><span class="linenos" data-linenos=" 3 "></span></a>├── manage.py
<a id="__codelineno-35-4" name="__codelineno-35-4"></a><a href="#__codelineno-35-4"><span class="linenos" data-linenos=" 4 "></span></a>└── myproject
<a id="__codelineno-35-5" name="__codelineno-35-5"></a><a href="#__codelineno-35-5"><span class="linenos" data-linenos=" 5 "></span></a>    ├── asgi.py
<a id="__codelineno-35-6" name="__codelineno-35-6"></a><a href="#__codelineno-35-6"><span class="linenos" data-linenos=" 6 "></span></a>    ├── __init__.py
<a id="__codelineno-35-7" name="__codelineno-35-7"></a><a href="#__codelineno-35-7"><span class="linenos" data-linenos=" 7 "></span></a>    ├── settings.py
<a id="__codelineno-35-8" name="__codelineno-35-8"></a><a href="#__codelineno-35-8"><span class="linenos" data-linenos=" 8 "></span></a>    ├── urls.py
<a id="__codelineno-35-9" name="__codelineno-35-9"></a><a href="#__codelineno-35-9"><span class="linenos" data-linenos=" 9 "></span></a>    └── wsgi.py
<a id="__codelineno-35-10" name="__codelineno-35-10"></a><a href="#__codelineno-35-10"><span class="linenos" data-linenos="10 "></span></a>
<a id="__codelineno-35-11" name="__codelineno-35-11"></a><a href="#__codelineno-35-11"><span class="linenos" data-linenos="11 "></span></a>1 directory, 6 files
</code></pre></div>
<h4 id="1连接容器web">1.连接容器web<a class="headerlink" href="#1连接容器web" title="Permanent link">&para;</a></h4>
<div class="language-python highlight"><span class="filename">Python</span><pre><span></span><code><a id="__codelineno-36-1" name="__codelineno-36-1"></a><a href="#__codelineno-36-1"><span class="linenos" data-linenos="1 "></span></a><span class="n">docker</span> <span class="n">exec</span> <span class="o">-</span><span class="n">it</span> <span class="n">f8fa4584492a</span> <span class="n">bash</span>
</code></pre></div>
<h4 id="2查看django版本">2.查看django版本<a class="headerlink" href="#2查看django版本" title="Permanent link">&para;</a></h4>
<div class="language-text highlight"><span class="filename">Text Only</span><pre><span></span><code><a id="__codelineno-37-1" name="__codelineno-37-1"></a><a href="#__codelineno-37-1"><span class="linenos" data-linenos="1 "></span></a>python3 -m django --version
</code></pre></div>
<h4 id="3创建django项目项目名称">3.创建django项目，项目名称<a class="headerlink" href="#3创建django项目项目名称" title="Permanent link">&para;</a></h4>
<div class="language-text highlight"><span class="filename">Text Only</span><pre><span></span><code><a id="__codelineno-38-1" name="__codelineno-38-1"></a><a href="#__codelineno-38-1"><span class="linenos" data-linenos="1 "></span></a>django-admin startproject myproject
</code></pre></div>
<p>创建后，项目文件夹内，会有django的文件</p>
<div class="language-text highlight"><span class="filename">Text Only</span><pre><span></span><code><a id="__codelineno-39-1" name="__codelineno-39-1"></a><a href="#__codelineno-39-1"><span class="linenos" data-linenos="1 "></span></a>[root@zhongjl-test-02 /data/compose/myproject/myproject/myproject]# ll
<a id="__codelineno-39-2" name="__codelineno-39-2"></a><a href="#__codelineno-39-2"><span class="linenos" data-linenos="2 "></span></a>total 16
<a id="__codelineno-39-3" name="__codelineno-39-3"></a><a href="#__codelineno-39-3"><span class="linenos" data-linenos="3 "></span></a>-rw-r--r-- 1 root root  395 Apr 25 15:54 asgi.py
<a id="__codelineno-39-4" name="__codelineno-39-4"></a><a href="#__codelineno-39-4"><span class="linenos" data-linenos="4 "></span></a>-rw-r--r-- 1 root root    0 Apr 25 15:54 __init__.py
<a id="__codelineno-39-5" name="__codelineno-39-5"></a><a href="#__codelineno-39-5"><span class="linenos" data-linenos="5 "></span></a>-rw-r--r-- 1 root root 3407 Apr 25 16:15 settings.py
<a id="__codelineno-39-6" name="__codelineno-39-6"></a><a href="#__codelineno-39-6"><span class="linenos" data-linenos="6 "></span></a>-rw-r--r-- 1 root root  751 Apr 25 15:54 urls.py
<a id="__codelineno-39-7" name="__codelineno-39-7"></a><a href="#__codelineno-39-7"><span class="linenos" data-linenos="7 "></span></a>-rw-r--r-- 1 root root  395 Apr 25 15:54 wsgi.py
</code></pre></div>
<p>而mange.py文件则在：<code>/data/compose/myproject/myproject</code></p>
<h4 id="4运行django项目">4.运行django项目<a class="headerlink" href="#4运行django项目" title="Permanent link">&para;</a></h4>
<p><strong>注意：在运行django项目前，请先django项目目录下的settings的mysql配置信息</strong>(redis暂不需修改)</p>
<p><code>vim /data/compose/myproject/myproject/myproject/settings.py</code></p>
<div class="language-text highlight"><span class="filename">Text Only</span><pre><span></span><code><a id="__codelineno-40-1" name="__codelineno-40-1"></a><a href="#__codelineno-40-1"><span class="linenos" data-linenos=" 1 "></span></a>DATABASES = {
<a id="__codelineno-40-2" name="__codelineno-40-2"></a><a href="#__codelineno-40-2"><span class="linenos" data-linenos=" 2 "></span></a>    &#39;default&#39;: {
<a id="__codelineno-40-3" name="__codelineno-40-3"></a><a href="#__codelineno-40-3"><span class="linenos" data-linenos=" 3 "></span></a>        &#39;ENGINE&#39;: &#39;django.db.backends.mysql&#39;,
<a id="__codelineno-40-4" name="__codelineno-40-4"></a><a href="#__codelineno-40-4"><span class="linenos" data-linenos=" 4 "></span></a>        &#39;NAME&#39;: &#39;myproject&#39;,
<a id="__codelineno-40-5" name="__codelineno-40-5"></a><a href="#__codelineno-40-5"><span class="linenos" data-linenos=" 5 "></span></a>        &#39;USER&#39;: &#39;dbuser&#39;,
<a id="__codelineno-40-6" name="__codelineno-40-6"></a><a href="#__codelineno-40-6"><span class="linenos" data-linenos=" 6 "></span></a>        &#39;PASSWORD&#39;: &#39;password&#39;,
<a id="__codelineno-40-7" name="__codelineno-40-7"></a><a href="#__codelineno-40-7"><span class="linenos" data-linenos=" 7 "></span></a>        &#39;HOST&#39;: &#39;db&#39;,  # Use the Docker service name as the hostname
<a id="__codelineno-40-8" name="__codelineno-40-8"></a><a href="#__codelineno-40-8"><span class="linenos" data-linenos=" 8 "></span></a>        &#39;PORT&#39;: &#39;3306&#39;,
<a id="__codelineno-40-9" name="__codelineno-40-9"></a><a href="#__codelineno-40-9"><span class="linenos" data-linenos=" 9 "></span></a>    }
<a id="__codelineno-40-10" name="__codelineno-40-10"></a><a href="#__codelineno-40-10"><span class="linenos" data-linenos="10 "></span></a>}
</code></pre></div>
<p>启动django</p>
<div class="language-text highlight"><span class="filename">Text Only</span><pre><span></span><code><a id="__codelineno-41-1" name="__codelineno-41-1"></a><a href="#__codelineno-41-1"><span class="linenos" data-linenos="1 "></span></a>前台启动
<a id="__codelineno-41-2" name="__codelineno-41-2"></a><a href="#__codelineno-41-2"><span class="linenos" data-linenos="2 "></span></a>python3 /var/www/html/myproject/manage.py runserver 0.0.0.0:8000
<a id="__codelineno-41-3" name="__codelineno-41-3"></a><a href="#__codelineno-41-3"><span class="linenos" data-linenos="3 "></span></a>
<a id="__codelineno-41-4" name="__codelineno-41-4"></a><a href="#__codelineno-41-4"><span class="linenos" data-linenos="4 "></span></a>
<a id="__codelineno-41-5" name="__codelineno-41-5"></a><a href="#__codelineno-41-5"><span class="linenos" data-linenos="5 "></span></a>后台启动
<a id="__codelineno-41-6" name="__codelineno-41-6"></a><a href="#__codelineno-41-6"><span class="linenos" data-linenos="6 "></span></a>nohup python3 /var/www/html/myproject/manage.py runserver 0.0.0.0:8000 &amp;
</code></pre></div>
<ul>
<li><code>nohup</code>: 表示忽略挂起信号，允许进程在后台运行。</li>
<li><code>&amp;</code>: 在命令末尾加上 <code>&amp;</code> 表示将进程放到后台运行。</li>
</ul>
<p>使用 <code>ps</code> 命令查找进程 ID（PID）</p>
<div class="language-bash highlight"><span class="filename">Bash</span><pre><span></span><code><a id="__codelineno-42-1" name="__codelineno-42-1"></a><a href="#__codelineno-42-1"><span class="linenos" data-linenos="1 "></span></a>ps<span class="w"> </span>aux<span class="w"> </span><span class="p">|</span><span class="w"> </span>grep<span class="w"> </span>python3
</code></pre></div>
<p>使用 <code>kill</code> 命令终止进程：</p>
<div class="language-bash highlight"><span class="filename">Bash</span><pre><span></span><code><a id="__codelineno-43-1" name="__codelineno-43-1"></a><a href="#__codelineno-43-1"><span class="linenos" data-linenos="1 "></span></a><span class="nb">kill</span><span class="w"> </span>-9<span class="w"> </span>&lt;PID&gt;
</code></pre></div>
<p><strong>如果启动遇到报错，可以根据错误文件python项目调整配置，也可以对照以下django的项目文件修改，修改的文件可以在容器内，也可以在宿主机，有映射存储，是共通的。</strong></p>
<h2 id="6django项目文件参考">（6）django项目文件参考<a class="headerlink" href="#6django项目文件参考" title="Permanent link">&para;</a></h2>
<h4 id="1__init__py">1.<strong><code>__init__.py</code></strong>：<a class="headerlink" href="#1__init__py" title="Permanent link">&para;</a></h4>
<p>项目的早期阶段，一般就是空文件</p>
<h4 id="2vim-wsgipy">2.vim wsgi.py<a class="headerlink" href="#2vim-wsgipy" title="Permanent link">&para;</a></h4>
<div class="language-text highlight"><span class="filename">Text Only</span><pre><span></span><code><a id="__codelineno-44-1" name="__codelineno-44-1"></a><a href="#__codelineno-44-1"><span class="linenos" data-linenos=" 1 "></span></a>&quot;&quot;&quot;
<a id="__codelineno-44-2" name="__codelineno-44-2"></a><a href="#__codelineno-44-2"><span class="linenos" data-linenos=" 2 "></span></a>WSGI config for myproject project.
<a id="__codelineno-44-3" name="__codelineno-44-3"></a><a href="#__codelineno-44-3"><span class="linenos" data-linenos=" 3 "></span></a>
<a id="__codelineno-44-4" name="__codelineno-44-4"></a><a href="#__codelineno-44-4"><span class="linenos" data-linenos=" 4 "></span></a>It exposes the WSGI callable as a module-level variable named ``application``.
<a id="__codelineno-44-5" name="__codelineno-44-5"></a><a href="#__codelineno-44-5"><span class="linenos" data-linenos=" 5 "></span></a>
<a id="__codelineno-44-6" name="__codelineno-44-6"></a><a href="#__codelineno-44-6"><span class="linenos" data-linenos=" 6 "></span></a>For more information on this file, see
<a id="__codelineno-44-7" name="__codelineno-44-7"></a><a href="#__codelineno-44-7"><span class="linenos" data-linenos=" 7 "></span></a>https://docs.djangoproject.com/en/4.0/howto/deployment/wsgi/
<a id="__codelineno-44-8" name="__codelineno-44-8"></a><a href="#__codelineno-44-8"><span class="linenos" data-linenos=" 8 "></span></a>&quot;&quot;&quot;
<a id="__codelineno-44-9" name="__codelineno-44-9"></a><a href="#__codelineno-44-9"><span class="linenos" data-linenos=" 9 "></span></a>
<a id="__codelineno-44-10" name="__codelineno-44-10"></a><a href="#__codelineno-44-10"><span class="linenos" data-linenos="10 "></span></a>import os
<a id="__codelineno-44-11" name="__codelineno-44-11"></a><a href="#__codelineno-44-11"><span class="linenos" data-linenos="11 "></span></a>
<a id="__codelineno-44-12" name="__codelineno-44-12"></a><a href="#__codelineno-44-12"><span class="linenos" data-linenos="12 "></span></a>from django.core.wsgi import get_wsgi_application
<a id="__codelineno-44-13" name="__codelineno-44-13"></a><a href="#__codelineno-44-13"><span class="linenos" data-linenos="13 "></span></a>
<a id="__codelineno-44-14" name="__codelineno-44-14"></a><a href="#__codelineno-44-14"><span class="linenos" data-linenos="14 "></span></a># Set the settings module for the &#39;myproject&#39; project:
<a id="__codelineno-44-15" name="__codelineno-44-15"></a><a href="#__codelineno-44-15"><span class="linenos" data-linenos="15 "></span></a>os.environ.setdefault(&#39;DJANGO_SETTINGS_MODULE&#39;, &#39;myproject.settings&#39;)
<a id="__codelineno-44-16" name="__codelineno-44-16"></a><a href="#__codelineno-44-16"><span class="linenos" data-linenos="16 "></span></a>
<a id="__codelineno-44-17" name="__codelineno-44-17"></a><a href="#__codelineno-44-17"><span class="linenos" data-linenos="17 "></span></a>application = get_wsgi_application()
</code></pre></div>
<h4 id="3settingspy">3.settings.py<a class="headerlink" href="#3settingspy" title="Permanent link">&para;</a></h4>
<p>修改mysql和redis服务的配置信息。最重要的几项配置如下所示：</p>
<div class="language-text highlight"><span class="filename">Text Only</span><pre><span></span><code><a id="__codelineno-45-1" name="__codelineno-45-1"></a><a href="#__codelineno-45-1"><span class="linenos" data-linenos="  1 "></span></a>&quot;&quot;&quot;
<a id="__codelineno-45-2" name="__codelineno-45-2"></a><a href="#__codelineno-45-2"><span class="linenos" data-linenos="  2 "></span></a>Django settings for myproject project.
<a id="__codelineno-45-3" name="__codelineno-45-3"></a><a href="#__codelineno-45-3"><span class="linenos" data-linenos="  3 "></span></a>
<a id="__codelineno-45-4" name="__codelineno-45-4"></a><a href="#__codelineno-45-4"><span class="linenos" data-linenos="  4 "></span></a>For more information on this file, see
<a id="__codelineno-45-5" name="__codelineno-45-5"></a><a href="#__codelineno-45-5"><span class="linenos" data-linenos="  5 "></span></a>https://docs.djangoproject.com/en/4.0/topics/settings/
<a id="__codelineno-45-6" name="__codelineno-45-6"></a><a href="#__codelineno-45-6"><span class="linenos" data-linenos="  6 "></span></a>
<a id="__codelineno-45-7" name="__codelineno-45-7"></a><a href="#__codelineno-45-7"><span class="linenos" data-linenos="  7 "></span></a>For the full list of settings and their values, see
<a id="__codelineno-45-8" name="__codelineno-45-8"></a><a href="#__codelineno-45-8"><span class="linenos" data-linenos="  8 "></span></a>https://docs.djangoproject.com/en/4.0/ref/settings/
<a id="__codelineno-45-9" name="__codelineno-45-9"></a><a href="#__codelineno-45-9"><span class="linenos" data-linenos="  9 "></span></a>&quot;&quot;&quot;
<a id="__codelineno-45-10" name="__codelineno-45-10"></a><a href="#__codelineno-45-10"><span class="linenos" data-linenos=" 10 "></span></a>
<a id="__codelineno-45-11" name="__codelineno-45-11"></a><a href="#__codelineno-45-11"><span class="linenos" data-linenos=" 11 "></span></a>import os
<a id="__codelineno-45-12" name="__codelineno-45-12"></a><a href="#__codelineno-45-12"><span class="linenos" data-linenos=" 12 "></span></a>
<a id="__codelineno-45-13" name="__codelineno-45-13"></a><a href="#__codelineno-45-13"><span class="linenos" data-linenos=" 13 "></span></a># Build paths inside the project like this: BASE_DIR / &#39;subdir&#39;.
<a id="__codelineno-45-14" name="__codelineno-45-14"></a><a href="#__codelineno-45-14"><span class="linenos" data-linenos=" 14 "></span></a>BASE_DIR = os.path.dirname(os.path.dirname(os.path.abspath(__file__)))
<a id="__codelineno-45-15" name="__codelineno-45-15"></a><a href="#__codelineno-45-15"><span class="linenos" data-linenos=" 15 "></span></a>
<a id="__codelineno-45-16" name="__codelineno-45-16"></a><a href="#__codelineno-45-16"><span class="linenos" data-linenos=" 16 "></span></a># SECURITY WARNING: keep the secret key used in production secret!
<a id="__codelineno-45-17" name="__codelineno-45-17"></a><a href="#__codelineno-45-17"><span class="linenos" data-linenos=" 17 "></span></a>SECRET_KEY = &#39;your-secret-key&#39;  # Replace &#39;your-secret-key&#39; with your actual Django secret key
<a id="__codelineno-45-18" name="__codelineno-45-18"></a><a href="#__codelineno-45-18"><span class="linenos" data-linenos=" 18 "></span></a>
<a id="__codelineno-45-19" name="__codelineno-45-19"></a><a href="#__codelineno-45-19"><span class="linenos" data-linenos=" 19 "></span></a># SECURITY WARNING: don&#39;t run with debug turned on in production!
<a id="__codelineno-45-20" name="__codelineno-45-20"></a><a href="#__codelineno-45-20"><span class="linenos" data-linenos=" 20 "></span></a>
<a id="__codelineno-45-21" name="__codelineno-45-21"></a><a href="#__codelineno-45-21"><span class="linenos" data-linenos=" 21 "></span></a>#根据需要自行修改
<a id="__codelineno-45-22" name="__codelineno-45-22"></a><a href="#__codelineno-45-22"><span class="linenos" data-linenos=" 22 "></span></a>DEBUG = False
<a id="__codelineno-45-23" name="__codelineno-45-23"></a><a href="#__codelineno-45-23"><span class="linenos" data-linenos=" 23 "></span></a>
<a id="__codelineno-45-24" name="__codelineno-45-24"></a><a href="#__codelineno-45-24"><span class="linenos" data-linenos=" 24 "></span></a>#填写服务器本机iP,域名可不填写
<a id="__codelineno-45-25" name="__codelineno-45-25"></a><a href="#__codelineno-45-25"><span class="linenos" data-linenos=" 25 "></span></a>ALLOWED_HOSTS = [&#39;10.22.51.65&#39;, &#39;josh.com&#39;]  
<a id="__codelineno-45-26" name="__codelineno-45-26"></a><a href="#__codelineno-45-26"><span class="linenos" data-linenos=" 26 "></span></a>
<a id="__codelineno-45-27" name="__codelineno-45-27"></a><a href="#__codelineno-45-27"><span class="linenos" data-linenos=" 27 "></span></a># Application definition
<a id="__codelineno-45-28" name="__codelineno-45-28"></a><a href="#__codelineno-45-28"><span class="linenos" data-linenos=" 28 "></span></a>#APP引入，暂时没有可不改
<a id="__codelineno-45-29" name="__codelineno-45-29"></a><a href="#__codelineno-45-29"><span class="linenos" data-linenos=" 29 "></span></a>INSTALLED_APPS = [
<a id="__codelineno-45-30" name="__codelineno-45-30"></a><a href="#__codelineno-45-30"><span class="linenos" data-linenos=" 30 "></span></a>    &#39;django.contrib.admin&#39;,
<a id="__codelineno-45-31" name="__codelineno-45-31"></a><a href="#__codelineno-45-31"><span class="linenos" data-linenos=" 31 "></span></a>    &#39;django.contrib.auth&#39;,
<a id="__codelineno-45-32" name="__codelineno-45-32"></a><a href="#__codelineno-45-32"><span class="linenos" data-linenos=" 32 "></span></a>    &#39;django.contrib.contenttypes&#39;,
<a id="__codelineno-45-33" name="__codelineno-45-33"></a><a href="#__codelineno-45-33"><span class="linenos" data-linenos=" 33 "></span></a>    &#39;django.contrib.sessions&#39;,
<a id="__codelineno-45-34" name="__codelineno-45-34"></a><a href="#__codelineno-45-34"><span class="linenos" data-linenos=" 34 "></span></a>    &#39;django.contrib.messages&#39;,
<a id="__codelineno-45-35" name="__codelineno-45-35"></a><a href="#__codelineno-45-35"><span class="linenos" data-linenos=" 35 "></span></a>    &#39;django.contrib.staticfiles&#39;,
<a id="__codelineno-45-36" name="__codelineno-45-36"></a><a href="#__codelineno-45-36"><span class="linenos" data-linenos=" 36 "></span></a>]
<a id="__codelineno-45-37" name="__codelineno-45-37"></a><a href="#__codelineno-45-37"><span class="linenos" data-linenos=" 37 "></span></a>
<a id="__codelineno-45-38" name="__codelineno-45-38"></a><a href="#__codelineno-45-38"><span class="linenos" data-linenos=" 38 "></span></a>MIDDLEWARE = [
<a id="__codelineno-45-39" name="__codelineno-45-39"></a><a href="#__codelineno-45-39"><span class="linenos" data-linenos=" 39 "></span></a>    &#39;django.middleware.security.SecurityMiddleware&#39;,
<a id="__codelineno-45-40" name="__codelineno-45-40"></a><a href="#__codelineno-45-40"><span class="linenos" data-linenos=" 40 "></span></a>    &#39;django.contrib.sessions.middleware.SessionMiddleware&#39;,
<a id="__codelineno-45-41" name="__codelineno-45-41"></a><a href="#__codelineno-45-41"><span class="linenos" data-linenos=" 41 "></span></a>    &#39;django.middleware.common.CommonMiddleware&#39;,
<a id="__codelineno-45-42" name="__codelineno-45-42"></a><a href="#__codelineno-45-42"><span class="linenos" data-linenos=" 42 "></span></a>    &#39;django.middleware.csrf.CsrfViewMiddleware&#39;,
<a id="__codelineno-45-43" name="__codelineno-45-43"></a><a href="#__codelineno-45-43"><span class="linenos" data-linenos=" 43 "></span></a>    &#39;django.contrib.auth.middleware.AuthenticationMiddleware&#39;,
<a id="__codelineno-45-44" name="__codelineno-45-44"></a><a href="#__codelineno-45-44"><span class="linenos" data-linenos=" 44 "></span></a>    &#39;django.contrib.messages.middleware.MessageMiddleware&#39;,
<a id="__codelineno-45-45" name="__codelineno-45-45"></a><a href="#__codelineno-45-45"><span class="linenos" data-linenos=" 45 "></span></a>    &#39;django.middleware.clickjacking.XFrameOptionsMiddleware&#39;,
<a id="__codelineno-45-46" name="__codelineno-45-46"></a><a href="#__codelineno-45-46"><span class="linenos" data-linenos=" 46 "></span></a>]
<a id="__codelineno-45-47" name="__codelineno-45-47"></a><a href="#__codelineno-45-47"><span class="linenos" data-linenos=" 47 "></span></a>
<a id="__codelineno-45-48" name="__codelineno-45-48"></a><a href="#__codelineno-45-48"><span class="linenos" data-linenos=" 48 "></span></a>ROOT_URLCONF = &#39;myproject.urls&#39;
<a id="__codelineno-45-49" name="__codelineno-45-49"></a><a href="#__codelineno-45-49"><span class="linenos" data-linenos=" 49 "></span></a>
<a id="__codelineno-45-50" name="__codelineno-45-50"></a><a href="#__codelineno-45-50"><span class="linenos" data-linenos=" 50 "></span></a>TEMPLATES = [
<a id="__codelineno-45-51" name="__codelineno-45-51"></a><a href="#__codelineno-45-51"><span class="linenos" data-linenos=" 51 "></span></a>    {
<a id="__codelineno-45-52" name="__codelineno-45-52"></a><a href="#__codelineno-45-52"><span class="linenos" data-linenos=" 52 "></span></a>        &#39;BACKEND&#39;: &#39;django.template.backends.django.DjangoTemplates&#39;,
<a id="__codelineno-45-53" name="__codelineno-45-53"></a><a href="#__codelineno-45-53"><span class="linenos" data-linenos=" 53 "></span></a>        &#39;DIRS&#39;: [],
<a id="__codelineno-45-54" name="__codelineno-45-54"></a><a href="#__codelineno-45-54"><span class="linenos" data-linenos=" 54 "></span></a>        &#39;APP_DIRS&#39;: True,
<a id="__codelineno-45-55" name="__codelineno-45-55"></a><a href="#__codelineno-45-55"><span class="linenos" data-linenos=" 55 "></span></a>        &#39;OPTIONS&#39;: {
<a id="__codelineno-45-56" name="__codelineno-45-56"></a><a href="#__codelineno-45-56"><span class="linenos" data-linenos=" 56 "></span></a>            &#39;context_processors&#39;: [
<a id="__codelineno-45-57" name="__codelineno-45-57"></a><a href="#__codelineno-45-57"><span class="linenos" data-linenos=" 57 "></span></a>                &#39;django.template.context_processors.debug&#39;,
<a id="__codelineno-45-58" name="__codelineno-45-58"></a><a href="#__codelineno-45-58"><span class="linenos" data-linenos=" 58 "></span></a>                &#39;django.template.context_processors.request&#39;,
<a id="__codelineno-45-59" name="__codelineno-45-59"></a><a href="#__codelineno-45-59"><span class="linenos" data-linenos=" 59 "></span></a>                &#39;django.contrib.auth.context_processors.auth&#39;,
<a id="__codelineno-45-60" name="__codelineno-45-60"></a><a href="#__codelineno-45-60"><span class="linenos" data-linenos=" 60 "></span></a>                &#39;django.contrib.messages.context_processors.messages&#39;,
<a id="__codelineno-45-61" name="__codelineno-45-61"></a><a href="#__codelineno-45-61"><span class="linenos" data-linenos=" 61 "></span></a>            ],
<a id="__codelineno-45-62" name="__codelineno-45-62"></a><a href="#__codelineno-45-62"><span class="linenos" data-linenos=" 62 "></span></a>        },
<a id="__codelineno-45-63" name="__codelineno-45-63"></a><a href="#__codelineno-45-63"><span class="linenos" data-linenos=" 63 "></span></a>    },
<a id="__codelineno-45-64" name="__codelineno-45-64"></a><a href="#__codelineno-45-64"><span class="linenos" data-linenos=" 64 "></span></a>]
<a id="__codelineno-45-65" name="__codelineno-45-65"></a><a href="#__codelineno-45-65"><span class="linenos" data-linenos=" 65 "></span></a>
<a id="__codelineno-45-66" name="__codelineno-45-66"></a><a href="#__codelineno-45-66"><span class="linenos" data-linenos=" 66 "></span></a>WSGI_APPLICATION = &#39;myproject.wsgi.application&#39;
<a id="__codelineno-45-67" name="__codelineno-45-67"></a><a href="#__codelineno-45-67"><span class="linenos" data-linenos=" 67 "></span></a>
<a id="__codelineno-45-68" name="__codelineno-45-68"></a><a href="#__codelineno-45-68"><span class="linenos" data-linenos=" 68 "></span></a># 数据库Database，设置为mysql，默认是使用sqlite
<a id="__codelineno-45-69" name="__codelineno-45-69"></a><a href="#__codelineno-45-69"><span class="linenos" data-linenos=" 69 "></span></a>DATABASES = {
<a id="__codelineno-45-70" name="__codelineno-45-70"></a><a href="#__codelineno-45-70"><span class="linenos" data-linenos=" 70 "></span></a>    &#39;default&#39;: {
<a id="__codelineno-45-71" name="__codelineno-45-71"></a><a href="#__codelineno-45-71"><span class="linenos" data-linenos=" 71 "></span></a>        &#39;ENGINE&#39;: &#39;django.db.backends.mysql&#39;,
<a id="__codelineno-45-72" name="__codelineno-45-72"></a><a href="#__codelineno-45-72"><span class="linenos" data-linenos=" 72 "></span></a>        &#39;NAME&#39;: &#39;myproject&#39;,
<a id="__codelineno-45-73" name="__codelineno-45-73"></a><a href="#__codelineno-45-73"><span class="linenos" data-linenos=" 73 "></span></a>        &#39;USER&#39;: &#39;dbuser&#39;,
<a id="__codelineno-45-74" name="__codelineno-45-74"></a><a href="#__codelineno-45-74"><span class="linenos" data-linenos=" 74 "></span></a>        &#39;PASSWORD&#39;: &#39;password&#39;,
<a id="__codelineno-45-75" name="__codelineno-45-75"></a><a href="#__codelineno-45-75"><span class="linenos" data-linenos=" 75 "></span></a>        &#39;HOST&#39;: &#39;db&#39;,  # Use the Docker service name as the hostname
<a id="__codelineno-45-76" name="__codelineno-45-76"></a><a href="#__codelineno-45-76"><span class="linenos" data-linenos=" 76 "></span></a>        &#39;PORT&#39;: &#39;3306&#39;,
<a id="__codelineno-45-77" name="__codelineno-45-77"></a><a href="#__codelineno-45-77"><span class="linenos" data-linenos=" 77 "></span></a>    }
<a id="__codelineno-45-78" name="__codelineno-45-78"></a><a href="#__codelineno-45-78"><span class="linenos" data-linenos=" 78 "></span></a>}
<a id="__codelineno-45-79" name="__codelineno-45-79"></a><a href="#__codelineno-45-79"><span class="linenos" data-linenos=" 79 "></span></a>
<a id="__codelineno-45-80" name="__codelineno-45-80"></a><a href="#__codelineno-45-80"><span class="linenos" data-linenos=" 80 "></span></a># Password validation
<a id="__codelineno-45-81" name="__codelineno-45-81"></a><a href="#__codelineno-45-81"><span class="linenos" data-linenos=" 81 "></span></a>AUTH_PASSWORD_VALIDATORS = [
<a id="__codelineno-45-82" name="__codelineno-45-82"></a><a href="#__codelineno-45-82"><span class="linenos" data-linenos=" 82 "></span></a>    {
<a id="__codelineno-45-83" name="__codelineno-45-83"></a><a href="#__codelineno-45-83"><span class="linenos" data-linenos=" 83 "></span></a>        &#39;NAME&#39;: &#39;django.contrib.auth.password_validation.UserAttributeSimilarityValidator&#39;,
<a id="__codelineno-45-84" name="__codelineno-45-84"></a><a href="#__codelineno-45-84"><span class="linenos" data-linenos=" 84 "></span></a>    },
<a id="__codelineno-45-85" name="__codelineno-45-85"></a><a href="#__codelineno-45-85"><span class="linenos" data-linenos=" 85 "></span></a>    {
<a id="__codelineno-45-86" name="__codelineno-45-86"></a><a href="#__codelineno-45-86"><span class="linenos" data-linenos=" 86 "></span></a>        &#39;NAME&#39;: &#39;django.contrib.auth.password_validation.MinimumLengthValidator&#39;,
<a id="__codelineno-45-87" name="__codelineno-45-87"></a><a href="#__codelineno-45-87"><span class="linenos" data-linenos=" 87 "></span></a>    },
<a id="__codelineno-45-88" name="__codelineno-45-88"></a><a href="#__codelineno-45-88"><span class="linenos" data-linenos=" 88 "></span></a>    {
<a id="__codelineno-45-89" name="__codelineno-45-89"></a><a href="#__codelineno-45-89"><span class="linenos" data-linenos=" 89 "></span></a>        &#39;NAME&#39;: &#39;django.contrib.auth.password_validation.CommonPasswordValidator&#39;,
<a id="__codelineno-45-90" name="__codelineno-45-90"></a><a href="#__codelineno-45-90"><span class="linenos" data-linenos=" 90 "></span></a>    },
<a id="__codelineno-45-91" name="__codelineno-45-91"></a><a href="#__codelineno-45-91"><span class="linenos" data-linenos=" 91 "></span></a>    {
<a id="__codelineno-45-92" name="__codelineno-45-92"></a><a href="#__codelineno-45-92"><span class="linenos" data-linenos=" 92 "></span></a>        &#39;NAME&#39;: &#39;django.contrib.auth.password_validation.NumericPasswordValidator&#39;,
<a id="__codelineno-45-93" name="__codelineno-45-93"></a><a href="#__codelineno-45-93"><span class="linenos" data-linenos=" 93 "></span></a>    },
<a id="__codelineno-45-94" name="__codelineno-45-94"></a><a href="#__codelineno-45-94"><span class="linenos" data-linenos=" 94 "></span></a>]
<a id="__codelineno-45-95" name="__codelineno-45-95"></a><a href="#__codelineno-45-95"><span class="linenos" data-linenos=" 95 "></span></a>
<a id="__codelineno-45-96" name="__codelineno-45-96"></a><a href="#__codelineno-45-96"><span class="linenos" data-linenos=" 96 "></span></a># Internationalization
<a id="__codelineno-45-97" name="__codelineno-45-97"></a><a href="#__codelineno-45-97"><span class="linenos" data-linenos=" 97 "></span></a>
<a id="__codelineno-45-98" name="__codelineno-45-98"></a><a href="#__codelineno-45-98"><span class="linenos" data-linenos=" 98 "></span></a>#设置语言，默认是英文，中文为&#39;zh-hans&#39;
<a id="__codelineno-45-99" name="__codelineno-45-99"></a><a href="#__codelineno-45-99"><span class="linenos" data-linenos=" 99 "></span></a>LANGUAGE_CODE = &#39;en-us&#39;
<a id="__codelineno-45-100" name="__codelineno-45-100"></a><a href="#__codelineno-45-100"><span class="linenos" data-linenos="100 "></span></a>TIME_ZONE = &#39;UTC&#39;
<a id="__codelineno-45-101" name="__codelineno-45-101"></a><a href="#__codelineno-45-101"><span class="linenos" data-linenos="101 "></span></a>USE_I18N = True
<a id="__codelineno-45-102" name="__codelineno-45-102"></a><a href="#__codelineno-45-102"><span class="linenos" data-linenos="102 "></span></a>USE_L10N = True
<a id="__codelineno-45-103" name="__codelineno-45-103"></a><a href="#__codelineno-45-103"><span class="linenos" data-linenos="103 "></span></a>USE_TZ = True
<a id="__codelineno-45-104" name="__codelineno-45-104"></a><a href="#__codelineno-45-104"><span class="linenos" data-linenos="104 "></span></a>
<a id="__codelineno-45-105" name="__codelineno-45-105"></a><a href="#__codelineno-45-105"><span class="linenos" data-linenos="105 "></span></a># Static files (CSS, JavaScript, Images)
<a id="__codelineno-45-106" name="__codelineno-45-106"></a><a href="#__codelineno-45-106"><span class="linenos" data-linenos="106 "></span></a>STATIC_URL = &#39;/static/&#39;
<a id="__codelineno-45-107" name="__codelineno-45-107"></a><a href="#__codelineno-45-107"><span class="linenos" data-linenos="107 "></span></a>STATIC_ROOT = os.path.join(BASE_DIR, &#39;static&#39;)
<a id="__codelineno-45-108" name="__codelineno-45-108"></a><a href="#__codelineno-45-108"><span class="linenos" data-linenos="108 "></span></a>
<a id="__codelineno-45-109" name="__codelineno-45-109"></a><a href="#__codelineno-45-109"><span class="linenos" data-linenos="109 "></span></a># Media files
<a id="__codelineno-45-110" name="__codelineno-45-110"></a><a href="#__codelineno-45-110"><span class="linenos" data-linenos="110 "></span></a>MEDIA_URL = &#39;/media/&#39;
<a id="__codelineno-45-111" name="__codelineno-45-111"></a><a href="#__codelineno-45-111"><span class="linenos" data-linenos="111 "></span></a>MEDIA_ROOT = os.path.join(BASE_DIR, &#39;media&#39;)
<a id="__codelineno-45-112" name="__codelineno-45-112"></a><a href="#__codelineno-45-112"><span class="linenos" data-linenos="112 "></span></a>
<a id="__codelineno-45-113" name="__codelineno-45-113"></a><a href="#__codelineno-45-113"><span class="linenos" data-linenos="113 "></span></a># Redis Configuration
<a id="__codelineno-45-114" name="__codelineno-45-114"></a><a href="#__codelineno-45-114"><span class="linenos" data-linenos="114 "></span></a>CACHES = {
<a id="__codelineno-45-115" name="__codelineno-45-115"></a><a href="#__codelineno-45-115"><span class="linenos" data-linenos="115 "></span></a>    &quot;default&quot;: {
<a id="__codelineno-45-116" name="__codelineno-45-116"></a><a href="#__codelineno-45-116"><span class="linenos" data-linenos="116 "></span></a>        &quot;BACKEND&quot;: &quot;django_redis.cache.RedisCache&quot;,
<a id="__codelineno-45-117" name="__codelineno-45-117"></a><a href="#__codelineno-45-117"><span class="linenos" data-linenos="117 "></span></a>        &quot;LOCATION&quot;: &quot;redis://192.168.42.131:6379/1&quot;,
<a id="__codelineno-45-118" name="__codelineno-45-118"></a><a href="#__codelineno-45-118"><span class="linenos" data-linenos="118 "></span></a>        &quot;OPTIONS&quot;: {
<a id="__codelineno-45-119" name="__codelineno-45-119"></a><a href="#__codelineno-45-119"><span class="linenos" data-linenos="119 "></span></a>            &quot;CLIENT_CLASS&quot;: &quot;django_redis.client.DefaultClient&quot;,
<a id="__codelineno-45-120" name="__codelineno-45-120"></a><a href="#__codelineno-45-120"><span class="linenos" data-linenos="120 "></span></a>            &quot;PASSWORD&quot;: &quot;yourpassword&quot;,  # Use the actual password
<a id="__codelineno-45-121" name="__codelineno-45-121"></a><a href="#__codelineno-45-121"><span class="linenos" data-linenos="121 "></span></a>        },
<a id="__codelineno-45-122" name="__codelineno-45-122"></a><a href="#__codelineno-45-122"><span class="linenos" data-linenos="122 "></span></a>    }
<a id="__codelineno-45-123" name="__codelineno-45-123"></a><a href="#__codelineno-45-123"><span class="linenos" data-linenos="123 "></span></a>}
</code></pre></div>
<h4 id="4managepy">4.manage.py<a class="headerlink" href="#4managepy" title="Permanent link">&para;</a></h4>
<div class="language-text highlight"><span class="filename">Text Only</span><pre><span></span><code><a id="__codelineno-46-1" name="__codelineno-46-1"></a><a href="#__codelineno-46-1"><span class="linenos" data-linenos=" 1 "></span></a>#!/usr/bin/env python
<a id="__codelineno-46-2" name="__codelineno-46-2"></a><a href="#__codelineno-46-2"><span class="linenos" data-linenos=" 2 "></span></a>&quot;&quot;&quot;Django&#39;s command-line utility for administrative tasks.&quot;&quot;&quot;
<a id="__codelineno-46-3" name="__codelineno-46-3"></a><a href="#__codelineno-46-3"><span class="linenos" data-linenos=" 3 "></span></a>import os
<a id="__codelineno-46-4" name="__codelineno-46-4"></a><a href="#__codelineno-46-4"><span class="linenos" data-linenos=" 4 "></span></a>import sys
<a id="__codelineno-46-5" name="__codelineno-46-5"></a><a href="#__codelineno-46-5"><span class="linenos" data-linenos=" 5 "></span></a>
<a id="__codelineno-46-6" name="__codelineno-46-6"></a><a href="#__codelineno-46-6"><span class="linenos" data-linenos=" 6 "></span></a>def main():
<a id="__codelineno-46-7" name="__codelineno-46-7"></a><a href="#__codelineno-46-7"><span class="linenos" data-linenos=" 7 "></span></a>    &quot;&quot;&quot;Run administrative tasks.&quot;&quot;&quot;
<a id="__codelineno-46-8" name="__codelineno-46-8"></a><a href="#__codelineno-46-8"><span class="linenos" data-linenos=" 8 "></span></a>    os.environ.setdefault(&#39;DJANGO_SETTINGS_MODULE&#39;, &#39;myproject.settings&#39;)
<a id="__codelineno-46-9" name="__codelineno-46-9"></a><a href="#__codelineno-46-9"><span class="linenos" data-linenos=" 9 "></span></a>    try:
<a id="__codelineno-46-10" name="__codelineno-46-10"></a><a href="#__codelineno-46-10"><span class="linenos" data-linenos="10 "></span></a>        from django.core.management import execute_from_command_line
<a id="__codelineno-46-11" name="__codelineno-46-11"></a><a href="#__codelineno-46-11"><span class="linenos" data-linenos="11 "></span></a>    except ImportError as exc:
<a id="__codelineno-46-12" name="__codelineno-46-12"></a><a href="#__codelineno-46-12"><span class="linenos" data-linenos="12 "></span></a>        raise ImportError(
<a id="__codelineno-46-13" name="__codelineno-46-13"></a><a href="#__codelineno-46-13"><span class="linenos" data-linenos="13 "></span></a>            &quot;Couldn&#39;t import Django. Are you sure it&#39;s installed and &quot;
<a id="__codelineno-46-14" name="__codelineno-46-14"></a><a href="#__codelineno-46-14"><span class="linenos" data-linenos="14 "></span></a>            &quot;available on your PYTHONPATH environment variable? Did you &quot;
<a id="__codelineno-46-15" name="__codelineno-46-15"></a><a href="#__codelineno-46-15"><span class="linenos" data-linenos="15 "></span></a>            &quot;forget to activate a virtual environment?&quot;
<a id="__codelineno-46-16" name="__codelineno-46-16"></a><a href="#__codelineno-46-16"><span class="linenos" data-linenos="16 "></span></a>        ) from exc
<a id="__codelineno-46-17" name="__codelineno-46-17"></a><a href="#__codelineno-46-17"><span class="linenos" data-linenos="17 "></span></a>    execute_from_command_line(sys.argv)
<a id="__codelineno-46-18" name="__codelineno-46-18"></a><a href="#__codelineno-46-18"><span class="linenos" data-linenos="18 "></span></a>
<a id="__codelineno-46-19" name="__codelineno-46-19"></a><a href="#__codelineno-46-19"><span class="linenos" data-linenos="19 "></span></a>if __name__ == &#39;__main__&#39;:
<a id="__codelineno-46-20" name="__codelineno-46-20"></a><a href="#__codelineno-46-20"><span class="linenos" data-linenos="20 "></span></a>    main()
</code></pre></div>
<h2 id="7脚本部署">（7）脚本部署<a class="headerlink" href="#7脚本部署" title="Permanent link">&para;</a></h2>
<p>脚本执行前提：</p>
<blockquote>
<p>1、确保服务器时间校准后</p>
<p>2、安装docker和docker-compose</p>
<p>3、执行后，自动创建目录，安装镜像，构建镜像、启动容器</p>
</blockquote>
<p>脚本较为粗糙，但是能用，内容如下：</p>
<div class="language-text highlight"><span class="filename">Text Only</span><pre><span></span><code><a id="__codelineno-47-1" name="__codelineno-47-1"></a><a href="#__codelineno-47-1"><span class="linenos" data-linenos="  1 "></span></a>#!/bin/bash
<a id="__codelineno-47-2" name="__codelineno-47-2"></a><a href="#__codelineno-47-2"><span class="linenos" data-linenos="  2 "></span></a>
<a id="__codelineno-47-3" name="__codelineno-47-3"></a><a href="#__codelineno-47-3"><span class="linenos" data-linenos="  3 "></span></a># 创建项目结构
<a id="__codelineno-47-4" name="__codelineno-47-4"></a><a href="#__codelineno-47-4"><span class="linenos" data-linenos="  4 "></span></a>mkdir -p /data/compose/{myproject,mysql/{conf,init},nginx,redis}
<a id="__codelineno-47-5" name="__codelineno-47-5"></a><a href="#__codelineno-47-5"><span class="linenos" data-linenos="  5 "></span></a>mkdir -p /data/compose/nginx/{log,ssl}
<a id="__codelineno-47-6" name="__codelineno-47-6"></a><a href="#__codelineno-47-6"><span class="linenos" data-linenos="  6 "></span></a>mkdir -p /data/compose/myproject/{static,media}
<a id="__codelineno-47-7" name="__codelineno-47-7"></a><a href="#__codelineno-47-7"><span class="linenos" data-linenos="  7 "></span></a>
<a id="__codelineno-47-8" name="__codelineno-47-8"></a><a href="#__codelineno-47-8"><span class="linenos" data-linenos="  8 "></span></a># 创建和写入 Docker-compose 配置
<a id="__codelineno-47-9" name="__codelineno-47-9"></a><a href="#__codelineno-47-9"><span class="linenos" data-linenos="  9 "></span></a>cat &gt; /data/compose/myproject/docker-compose.yml &lt;&lt;EOF
<a id="__codelineno-47-10" name="__codelineno-47-10"></a><a href="#__codelineno-47-10"><span class="linenos" data-linenos=" 10 "></span></a>version: &quot;3&quot;
<a id="__codelineno-47-11" name="__codelineno-47-11"></a><a href="#__codelineno-47-11"><span class="linenos" data-linenos=" 11 "></span></a>
<a id="__codelineno-47-12" name="__codelineno-47-12"></a><a href="#__codelineno-47-12"><span class="linenos" data-linenos=" 12 "></span></a>volumes: 
<a id="__codelineno-47-13" name="__codelineno-47-13"></a><a href="#__codelineno-47-13"><span class="linenos" data-linenos=" 13 "></span></a>  db_vol:
<a id="__codelineno-47-14" name="__codelineno-47-14"></a><a href="#__codelineno-47-14"><span class="linenos" data-linenos=" 14 "></span></a>  redis_vol:
<a id="__codelineno-47-15" name="__codelineno-47-15"></a><a href="#__codelineno-47-15"><span class="linenos" data-linenos=" 15 "></span></a>  media_vol:
<a id="__codelineno-47-16" name="__codelineno-47-16"></a><a href="#__codelineno-47-16"><span class="linenos" data-linenos=" 16 "></span></a>  static_vol:
<a id="__codelineno-47-17" name="__codelineno-47-17"></a><a href="#__codelineno-47-17"><span class="linenos" data-linenos=" 17 "></span></a>
<a id="__codelineno-47-18" name="__codelineno-47-18"></a><a href="#__codelineno-47-18"><span class="linenos" data-linenos=" 18 "></span></a>networks:
<a id="__codelineno-47-19" name="__codelineno-47-19"></a><a href="#__codelineno-47-19"><span class="linenos" data-linenos=" 19 "></span></a>  nginx_network:
<a id="__codelineno-47-20" name="__codelineno-47-20"></a><a href="#__codelineno-47-20"><span class="linenos" data-linenos=" 20 "></span></a>    driver: bridge
<a id="__codelineno-47-21" name="__codelineno-47-21"></a><a href="#__codelineno-47-21"><span class="linenos" data-linenos=" 21 "></span></a>  db_network:
<a id="__codelineno-47-22" name="__codelineno-47-22"></a><a href="#__codelineno-47-22"><span class="linenos" data-linenos=" 22 "></span></a>    driver: bridge
<a id="__codelineno-47-23" name="__codelineno-47-23"></a><a href="#__codelineno-47-23"><span class="linenos" data-linenos=" 23 "></span></a>  redis_network: 
<a id="__codelineno-47-24" name="__codelineno-47-24"></a><a href="#__codelineno-47-24"><span class="linenos" data-linenos=" 24 "></span></a>    driver: bridge
<a id="__codelineno-47-25" name="__codelineno-47-25"></a><a href="#__codelineno-47-25"><span class="linenos" data-linenos=" 25 "></span></a>
<a id="__codelineno-47-26" name="__codelineno-47-26"></a><a href="#__codelineno-47-26"><span class="linenos" data-linenos=" 26 "></span></a>services:
<a id="__codelineno-47-27" name="__codelineno-47-27"></a><a href="#__codelineno-47-27"><span class="linenos" data-linenos=" 27 "></span></a>  redis:
<a id="__codelineno-47-28" name="__codelineno-47-28"></a><a href="#__codelineno-47-28"><span class="linenos" data-linenos=" 28 "></span></a>    image: redis:latest
<a id="__codelineno-47-29" name="__codelineno-47-29"></a><a href="#__codelineno-47-29"><span class="linenos" data-linenos=" 29 "></span></a>    command: redis-server /etc/redis/redis.conf
<a id="__codelineno-47-30" name="__codelineno-47-30"></a><a href="#__codelineno-47-30"><span class="linenos" data-linenos=" 30 "></span></a>    networks:
<a id="__codelineno-47-31" name="__codelineno-47-31"></a><a href="#__codelineno-47-31"><span class="linenos" data-linenos=" 31 "></span></a>      - redis_network
<a id="__codelineno-47-32" name="__codelineno-47-32"></a><a href="#__codelineno-47-32"><span class="linenos" data-linenos=" 32 "></span></a>    volumes:
<a id="__codelineno-47-33" name="__codelineno-47-33"></a><a href="#__codelineno-47-33"><span class="linenos" data-linenos=" 33 "></span></a>      - redis_vol:/data
<a id="__codelineno-47-34" name="__codelineno-47-34"></a><a href="#__codelineno-47-34"><span class="linenos" data-linenos=" 34 "></span></a>      - /data/compose/redis/redis.conf:/etc/redis/redis.conf
<a id="__codelineno-47-35" name="__codelineno-47-35"></a><a href="#__codelineno-47-35"><span class="linenos" data-linenos=" 35 "></span></a>    ports:
<a id="__codelineno-47-36" name="__codelineno-47-36"></a><a href="#__codelineno-47-36"><span class="linenos" data-linenos=" 36 "></span></a>      - &quot;6379:6379&quot;
<a id="__codelineno-47-37" name="__codelineno-47-37"></a><a href="#__codelineno-47-37"><span class="linenos" data-linenos=" 37 "></span></a>    restart: always
<a id="__codelineno-47-38" name="__codelineno-47-38"></a><a href="#__codelineno-47-38"><span class="linenos" data-linenos=" 38 "></span></a>
<a id="__codelineno-47-39" name="__codelineno-47-39"></a><a href="#__codelineno-47-39"><span class="linenos" data-linenos=" 39 "></span></a>  db:
<a id="__codelineno-47-40" name="__codelineno-47-40"></a><a href="#__codelineno-47-40"><span class="linenos" data-linenos=" 40 "></span></a>    image: mysql
<a id="__codelineno-47-41" name="__codelineno-47-41"></a><a href="#__codelineno-47-41"><span class="linenos" data-linenos=" 41 "></span></a>    env_file:  
<a id="__codelineno-47-42" name="__codelineno-47-42"></a><a href="#__codelineno-47-42"><span class="linenos" data-linenos=" 42 "></span></a>      - /data/compose/myproject/.env
<a id="__codelineno-47-43" name="__codelineno-47-43"></a><a href="#__codelineno-47-43"><span class="linenos" data-linenos=" 43 "></span></a>    networks:  
<a id="__codelineno-47-44" name="__codelineno-47-44"></a><a href="#__codelineno-47-44"><span class="linenos" data-linenos=" 44 "></span></a>      - db_network
<a id="__codelineno-47-45" name="__codelineno-47-45"></a><a href="#__codelineno-47-45"><span class="linenos" data-linenos=" 45 "></span></a>    volumes:
<a id="__codelineno-47-46" name="__codelineno-47-46"></a><a href="#__codelineno-47-46"><span class="linenos" data-linenos=" 46 "></span></a>      - db_vol:/var/lib/mysql:rw
<a id="__codelineno-47-47" name="__codelineno-47-47"></a><a href="#__codelineno-47-47"><span class="linenos" data-linenos=" 47 "></span></a>      - /data/compose/mysql/conf/my.cnf:/etc/mysql/my.cnf
<a id="__codelineno-47-48" name="__codelineno-47-48"></a><a href="#__codelineno-47-48"><span class="linenos" data-linenos=" 48 "></span></a>      - /data/compose/mysql/init:/docker-entrypoint-initdb.d/
<a id="__codelineno-47-49" name="__codelineno-47-49"></a><a href="#__codelineno-47-49"><span class="linenos" data-linenos=" 49 "></span></a>    ports:
<a id="__codelineno-47-50" name="__codelineno-47-50"></a><a href="#__codelineno-47-50"><span class="linenos" data-linenos=" 50 "></span></a>      - &quot;3306:3306&quot;
<a id="__codelineno-47-51" name="__codelineno-47-51"></a><a href="#__codelineno-47-51"><span class="linenos" data-linenos=" 51 "></span></a>    restart: always
<a id="__codelineno-47-52" name="__codelineno-47-52"></a><a href="#__codelineno-47-52"><span class="linenos" data-linenos=" 52 "></span></a>
<a id="__codelineno-47-53" name="__codelineno-47-53"></a><a href="#__codelineno-47-53"><span class="linenos" data-linenos=" 53 "></span></a>  web:
<a id="__codelineno-47-54" name="__codelineno-47-54"></a><a href="#__codelineno-47-54"><span class="linenos" data-linenos=" 54 "></span></a>    build: /data/compose/myproject
<a id="__codelineno-47-55" name="__codelineno-47-55"></a><a href="#__codelineno-47-55"><span class="linenos" data-linenos=" 55 "></span></a>    expose:
<a id="__codelineno-47-56" name="__codelineno-47-56"></a><a href="#__codelineno-47-56"><span class="linenos" data-linenos=" 56 "></span></a>      - &quot;8000&quot;
<a id="__codelineno-47-57" name="__codelineno-47-57"></a><a href="#__codelineno-47-57"><span class="linenos" data-linenos=" 57 "></span></a>    volumes:
<a id="__codelineno-47-58" name="__codelineno-47-58"></a><a href="#__codelineno-47-58"><span class="linenos" data-linenos=" 58 "></span></a>      - /data/compose/myproject:/var/www/html/myproject
<a id="__codelineno-47-59" name="__codelineno-47-59"></a><a href="#__codelineno-47-59"><span class="linenos" data-linenos=" 59 "></span></a>      - static_vol:/var/www/html/myproject/static
<a id="__codelineno-47-60" name="__codelineno-47-60"></a><a href="#__codelineno-47-60"><span class="linenos" data-linenos=" 60 "></span></a>      - media_vol:/var/www/html/myproject/media
<a id="__codelineno-47-61" name="__codelineno-47-61"></a><a href="#__codelineno-47-61"><span class="linenos" data-linenos=" 61 "></span></a>      - /data/compose/uwsgi:/tmp
<a id="__codelineno-47-62" name="__codelineno-47-62"></a><a href="#__codelineno-47-62"><span class="linenos" data-linenos=" 62 "></span></a>    networks:
<a id="__codelineno-47-63" name="__codelineno-47-63"></a><a href="#__codelineno-47-63"><span class="linenos" data-linenos=" 63 "></span></a>      - nginx_network
<a id="__codelineno-47-64" name="__codelineno-47-64"></a><a href="#__codelineno-47-64"><span class="linenos" data-linenos=" 64 "></span></a>      - db_network  
<a id="__codelineno-47-65" name="__codelineno-47-65"></a><a href="#__codelineno-47-65"><span class="linenos" data-linenos=" 65 "></span></a>      - redis_network 
<a id="__codelineno-47-66" name="__codelineno-47-66"></a><a href="#__codelineno-47-66"><span class="linenos" data-linenos=" 66 "></span></a>    depends_on:
<a id="__codelineno-47-67" name="__codelineno-47-67"></a><a href="#__codelineno-47-67"><span class="linenos" data-linenos=" 67 "></span></a>      - db
<a id="__codelineno-47-68" name="__codelineno-47-68"></a><a href="#__codelineno-47-68"><span class="linenos" data-linenos=" 68 "></span></a>      - redis
<a id="__codelineno-47-69" name="__codelineno-47-69"></a><a href="#__codelineno-47-69"><span class="linenos" data-linenos=" 69 "></span></a>    restart: always
<a id="__codelineno-47-70" name="__codelineno-47-70"></a><a href="#__codelineno-47-70"><span class="linenos" data-linenos=" 70 "></span></a>    tty: true
<a id="__codelineno-47-71" name="__codelineno-47-71"></a><a href="#__codelineno-47-71"><span class="linenos" data-linenos=" 71 "></span></a>    stdin_open: true
<a id="__codelineno-47-72" name="__codelineno-47-72"></a><a href="#__codelineno-47-72"><span class="linenos" data-linenos=" 72 "></span></a>
<a id="__codelineno-47-73" name="__codelineno-47-73"></a><a href="#__codelineno-47-73"><span class="linenos" data-linenos=" 73 "></span></a>  nginx:
<a id="__codelineno-47-74" name="__codelineno-47-74"></a><a href="#__codelineno-47-74"><span class="linenos" data-linenos=" 74 "></span></a>    build: /data/compose/nginx
<a id="__codelineno-47-75" name="__codelineno-47-75"></a><a href="#__codelineno-47-75"><span class="linenos" data-linenos=" 75 "></span></a>    ports:
<a id="__codelineno-47-76" name="__codelineno-47-76"></a><a href="#__codelineno-47-76"><span class="linenos" data-linenos=" 76 "></span></a>      - &quot;80:80&quot;
<a id="__codelineno-47-77" name="__codelineno-47-77"></a><a href="#__codelineno-47-77"><span class="linenos" data-linenos=" 77 "></span></a>      - &quot;443:443&quot;
<a id="__codelineno-47-78" name="__codelineno-47-78"></a><a href="#__codelineno-47-78"><span class="linenos" data-linenos=" 78 "></span></a>    expose:
<a id="__codelineno-47-79" name="__codelineno-47-79"></a><a href="#__codelineno-47-79"><span class="linenos" data-linenos=" 79 "></span></a>      - &quot;80&quot;
<a id="__codelineno-47-80" name="__codelineno-47-80"></a><a href="#__codelineno-47-80"><span class="linenos" data-linenos=" 80 "></span></a>    volumes:
<a id="__codelineno-47-81" name="__codelineno-47-81"></a><a href="#__codelineno-47-81"><span class="linenos" data-linenos=" 81 "></span></a>      - /data/compose/nginx/nginx.conf:/etc/nginx/conf.d/nginx.conf
<a id="__codelineno-47-82" name="__codelineno-47-82"></a><a href="#__codelineno-47-82"><span class="linenos" data-linenos=" 82 "></span></a>      - /data/compose/nginx/ssl:/usr/share/nginx/ssl
<a id="__codelineno-47-83" name="__codelineno-47-83"></a><a href="#__codelineno-47-83"><span class="linenos" data-linenos=" 83 "></span></a>      - /data/compose/nginx/log:/var/log/nginx
<a id="__codelineno-47-84" name="__codelineno-47-84"></a><a href="#__codelineno-47-84"><span class="linenos" data-linenos=" 84 "></span></a>      - static_vol:/usr/share/nginx/html/static
<a id="__codelineno-47-85" name="__codelineno-47-85"></a><a href="#__codelineno-47-85"><span class="linenos" data-linenos=" 85 "></span></a>      - media_vol:/usr/share/nginx/html/media
<a id="__codelineno-47-86" name="__codelineno-47-86"></a><a href="#__codelineno-47-86"><span class="linenos" data-linenos=" 86 "></span></a>    networks:
<a id="__codelineno-47-87" name="__codelineno-47-87"></a><a href="#__codelineno-47-87"><span class="linenos" data-linenos=" 87 "></span></a>      - nginx_network
<a id="__codelineno-47-88" name="__codelineno-47-88"></a><a href="#__codelineno-47-88"><span class="linenos" data-linenos=" 88 "></span></a>    depends_on:
<a id="__codelineno-47-89" name="__codelineno-47-89"></a><a href="#__codelineno-47-89"><span class="linenos" data-linenos=" 89 "></span></a>      - web
<a id="__codelineno-47-90" name="__codelineno-47-90"></a><a href="#__codelineno-47-90"><span class="linenos" data-linenos=" 90 "></span></a>    restart: always
<a id="__codelineno-47-91" name="__codelineno-47-91"></a><a href="#__codelineno-47-91"><span class="linenos" data-linenos=" 91 "></span></a>EOF
<a id="__codelineno-47-92" name="__codelineno-47-92"></a><a href="#__codelineno-47-92"><span class="linenos" data-linenos=" 92 "></span></a>
<a id="__codelineno-47-93" name="__codelineno-47-93"></a><a href="#__codelineno-47-93"><span class="linenos" data-linenos=" 93 "></span></a># 创建 Django+Uwsgi Dockerfile
<a id="__codelineno-47-94" name="__codelineno-47-94"></a><a href="#__codelineno-47-94"><span class="linenos" data-linenos=" 94 "></span></a># 创建 Django+Uwsgi Dockerfile
<a id="__codelineno-47-95" name="__codelineno-47-95"></a><a href="#__codelineno-47-95"><span class="linenos" data-linenos=" 95 "></span></a>cat &gt; /data/compose/myproject/Dockerfile &lt;&lt;EOF
<a id="__codelineno-47-96" name="__codelineno-47-96"></a><a href="#__codelineno-47-96"><span class="linenos" data-linenos=" 96 "></span></a>FROM centos:7
<a id="__codelineno-47-97" name="__codelineno-47-97"></a><a href="#__codelineno-47-97"><span class="linenos" data-linenos=" 97 "></span></a>
<a id="__codelineno-47-98" name="__codelineno-47-98"></a><a href="#__codelineno-47-98"><span class="linenos" data-linenos=" 98 "></span></a># 更新系统并安装必要的包
<a id="__codelineno-47-99" name="__codelineno-47-99"></a><a href="#__codelineno-47-99"><span class="linenos" data-linenos=" 99 "></span></a>RUN yum -y update &amp;&amp; \
<a id="__codelineno-47-100" name="__codelineno-47-100"></a><a href="#__codelineno-47-100"><span class="linenos" data-linenos="100 "></span></a>    yum -y install epel-release &amp;&amp; \
<a id="__codelineno-47-101" name="__codelineno-47-101"></a><a href="#__codelineno-47-101"><span class="linenos" data-linenos="101 "></span></a>    yum -y install python3 python3-pip nc mysql-devel gcc-c++ python3-devel libjpeg-devel zlib-devel libffi-devel openssl-devel &amp;&amp; \
<a id="__codelineno-47-102" name="__codelineno-47-102"></a><a href="#__codelineno-47-102"><span class="linenos" data-linenos="102 "></span></a>    yum -y groupinstall &quot;Development Tools&quot; &amp;&amp; \
<a id="__codelineno-47-103" name="__codelineno-47-103"></a><a href="#__codelineno-47-103"><span class="linenos" data-linenos="103 "></span></a>    yum clean all
<a id="__codelineno-47-104" name="__codelineno-47-104"></a><a href="#__codelineno-47-104"><span class="linenos" data-linenos="104 "></span></a>
<a id="__codelineno-47-105" name="__codelineno-47-105"></a><a href="#__codelineno-47-105"><span class="linenos" data-linenos="105 "></span></a># 设置Python环境变量
<a id="__codelineno-47-106" name="__codelineno-47-106"></a><a href="#__codelineno-47-106"><span class="linenos" data-linenos="106 "></span></a>ENV PYTHONDONTWRITEBYTECODE 1
<a id="__codelineno-47-107" name="__codelineno-47-107"></a><a href="#__codelineno-47-107"><span class="linenos" data-linenos="107 "></span></a>ENV PYTHONUNBUFFERED 1
<a id="__codelineno-47-108" name="__codelineno-47-108"></a><a href="#__codelineno-47-108"><span class="linenos" data-linenos="108 "></span></a>
<a id="__codelineno-47-109" name="__codelineno-47-109"></a><a href="#__codelineno-47-109"><span class="linenos" data-linenos="109 "></span></a># 配置pip国内源
<a id="__codelineno-47-110" name="__codelineno-47-110"></a><a href="#__codelineno-47-110"><span class="linenos" data-linenos="110 "></span></a>COPY pip.conf /root/.pip/pip.conf
<a id="__codelineno-47-111" name="__codelineno-47-111"></a><a href="#__codelineno-47-111"><span class="linenos" data-linenos="111 "></span></a>
<a id="__codelineno-47-112" name="__codelineno-47-112"></a><a href="#__codelineno-47-112"><span class="linenos" data-linenos="112 "></span></a># 设置应用的工作目录
<a id="__codelineno-47-113" name="__codelineno-47-113"></a><a href="#__codelineno-47-113"><span class="linenos" data-linenos="113 "></span></a>ENV APP_HOME=/var/www/html/myproject
<a id="__codelineno-47-114" name="__codelineno-47-114"></a><a href="#__codelineno-47-114"><span class="linenos" data-linenos="114 "></span></a>RUN mkdir -p \$APP_HOME
<a id="__codelineno-47-115" name="__codelineno-47-115"></a><a href="#__codelineno-47-115"><span class="linenos" data-linenos="115 "></span></a>WORKDIR \$APP_HOME
<a id="__codelineno-47-116" name="__codelineno-47-116"></a><a href="#__codelineno-47-116"><span class="linenos" data-linenos="116 "></span></a>
<a id="__codelineno-47-117" name="__codelineno-47-117"></a><a href="#__codelineno-47-117"><span class="linenos" data-linenos="117 "></span></a># 将当前目录的内容添加到工作目录中
<a id="__codelineno-47-118" name="__codelineno-47-118"></a><a href="#__codelineno-47-118"><span class="linenos" data-linenos="118 "></span></a>ADD . \$APP_HOME
<a id="__codelineno-47-119" name="__codelineno-47-119"></a><a href="#__codelineno-47-119"><span class="linenos" data-linenos="119 "></span></a>
<a id="__codelineno-47-120" name="__codelineno-47-120"></a><a href="#__codelineno-47-120"><span class="linenos" data-linenos="120 "></span></a># 更新pip并安装项目依赖
<a id="__codelineno-47-121" name="__codelineno-47-121"></a><a href="#__codelineno-47-121"><span class="linenos" data-linenos="121 "></span></a>RUN python3 -m pip install --upgrade pip
<a id="__codelineno-47-122" name="__codelineno-47-122"></a><a href="#__codelineno-47-122"><span class="linenos" data-linenos="122 "></span></a>RUN pip install -r requirements.txt
<a id="__codelineno-47-123" name="__codelineno-47-123"></a><a href="#__codelineno-47-123"><span class="linenos" data-linenos="123 "></span></a>
<a id="__codelineno-47-124" name="__codelineno-47-124"></a><a href="#__codelineno-47-124"><span class="linenos" data-linenos="124 "></span></a># 复制并调整start.sh脚本的权限
<a id="__codelineno-47-125" name="__codelineno-47-125"></a><a href="#__codelineno-47-125"><span class="linenos" data-linenos="125 "></span></a>COPY start.sh /data/compose/start.sh
<a id="__codelineno-47-126" name="__codelineno-47-126"></a><a href="#__codelineno-47-126"><span class="linenos" data-linenos="126 "></span></a>RUN chmod +x /data/compose/start.sh &amp;&amp; sed -i &#39;s/\r$//&#39; /data/compose/start.sh
<a id="__codelineno-47-127" name="__codelineno-47-127"></a><a href="#__codelineno-47-127"><span class="linenos" data-linenos="127 "></span></a>
<a id="__codelineno-47-128" name="__codelineno-47-128"></a><a href="#__codelineno-47-128"><span class="linenos" data-linenos="128 "></span></a># 复制uwsgi配置文件
<a id="__codelineno-47-129" name="__codelineno-47-129"></a><a href="#__codelineno-47-129"><span class="linenos" data-linenos="129 "></span></a>COPY uwsgi.ini \$APP_HOME/uwsgi.ini
<a id="__codelineno-47-130" name="__codelineno-47-130"></a><a href="#__codelineno-47-130"><span class="linenos" data-linenos="130 "></span></a>
<a id="__codelineno-47-131" name="__codelineno-47-131"></a><a href="#__codelineno-47-131"><span class="linenos" data-linenos="131 "></span></a># 设置最终的工作目录和入口点
<a id="__codelineno-47-132" name="__codelineno-47-132"></a><a href="#__codelineno-47-132"><span class="linenos" data-linenos="132 "></span></a>WORKDIR /data/compose
<a id="__codelineno-47-133" name="__codelineno-47-133"></a><a href="#__codelineno-47-133"><span class="linenos" data-linenos="133 "></span></a>ENTRYPOINT [&quot;/bin/bash&quot;, &quot;/data/compose/start.sh&quot;]
<a id="__codelineno-47-134" name="__codelineno-47-134"></a><a href="#__codelineno-47-134"><span class="linenos" data-linenos="134 "></span></a>EOF
<a id="__codelineno-47-135" name="__codelineno-47-135"></a><a href="#__codelineno-47-135"><span class="linenos" data-linenos="135 "></span></a>
<a id="__codelineno-47-136" name="__codelineno-47-136"></a><a href="#__codelineno-47-136"><span class="linenos" data-linenos="136 "></span></a>
<a id="__codelineno-47-137" name="__codelineno-47-137"></a><a href="#__codelineno-47-137"><span class="linenos" data-linenos="137 "></span></a>
<a id="__codelineno-47-138" name="__codelineno-47-138"></a><a href="#__codelineno-47-138"><span class="linenos" data-linenos="138 "></span></a># 创建启动脚本
<a id="__codelineno-47-139" name="__codelineno-47-139"></a><a href="#__codelineno-47-139"><span class="linenos" data-linenos="139 "></span></a>cat &gt; /data/compose/myproject/start.sh &lt;&lt;EOF
<a id="__codelineno-47-140" name="__codelineno-47-140"></a><a href="#__codelineno-47-140"><span class="linenos" data-linenos="140 "></span></a>#!/bin/bash
<a id="__codelineno-47-141" name="__codelineno-47-141"></a><a href="#__codelineno-47-141"><span class="linenos" data-linenos="141 "></span></a>MYSQL_HOST=db
<a id="__codelineno-47-142" name="__codelineno-47-142"></a><a href="#__codelineno-47-142"><span class="linenos" data-linenos="142 "></span></a>MYSQL_PORT=3306
<a id="__codelineno-47-143" name="__codelineno-47-143"></a><a href="#__codelineno-47-143"><span class="linenos" data-linenos="143 "></span></a>
<a id="__codelineno-47-144" name="__codelineno-47-144"></a><a href="#__codelineno-47-144"><span class="linenos" data-linenos="144 "></span></a>while ! nc -z $MYSQL_HOST $MYSQL_PORT; do
<a id="__codelineno-47-145" name="__codelineno-47-145"></a><a href="#__codelineno-47-145"><span class="linenos" data-linenos="145 "></span></a>    echo &quot;Waiting for the MySQL Server&quot;
<a id="__codelineno-47-146" name="__codelineno-47-146"></a><a href="#__codelineno-47-146"><span class="linenos" data-linenos="146 "></span></a>    sleep 3
<a id="__codelineno-47-147" name="__codelineno-47-147"></a><a href="#__codelineno-47-147"><span class="linenos" data-linenos="147 "></span></a>done
<a id="__codelineno-47-148" name="__codelineno-47-148"></a><a href="#__codelineno-47-148"><span class="linenos" data-linenos="148 "></span></a>
<a id="__codelineno-47-149" name="__codelineno-47-149"></a><a href="#__codelineno-47-149"><span class="linenos" data-linenos="149 "></span></a>python manage.py migrate --noinput
<a id="__codelineno-47-150" name="__codelineno-47-150"></a><a href="#__codelineno-47-150"><span class="linenos" data-linenos="150 "></span></a>python manage.py collectstatic --noinput
<a id="__codelineno-47-151" name="__codelineno-47-151"></a><a href="#__codelineno-47-151"><span class="linenos" data-linenos="151 "></span></a>
<a id="__codelineno-47-152" name="__codelineno-47-152"></a><a href="#__codelineno-47-152"><span class="linenos" data-linenos="152 "></span></a>uwsgi --ini /var/www/html/myproject/uwsgi.ini
<a id="__codelineno-47-153" name="__codelineno-47-153"></a><a href="#__codelineno-47-153"><span class="linenos" data-linenos="153 "></span></a>
<a id="__codelineno-47-154" name="__codelineno-47-154"></a><a href="#__codelineno-47-154"><span class="linenos" data-linenos="154 "></span></a>tail -f /dev/null
<a id="__codelineno-47-155" name="__codelineno-47-155"></a><a href="#__codelineno-47-155"><span class="linenos" data-linenos="155 "></span></a>
<a id="__codelineno-47-156" name="__codelineno-47-156"></a><a href="#__codelineno-47-156"><span class="linenos" data-linenos="156 "></span></a>exec &quot;\$@&quot;
<a id="__codelineno-47-157" name="__codelineno-47-157"></a><a href="#__codelineno-47-157"><span class="linenos" data-linenos="157 "></span></a>EOF
<a id="__codelineno-47-158" name="__codelineno-47-158"></a><a href="#__codelineno-47-158"><span class="linenos" data-linenos="158 "></span></a>chmod +x /data/compose/myproject/start.sh
<a id="__codelineno-47-159" name="__codelineno-47-159"></a><a href="#__codelineno-47-159"><span class="linenos" data-linenos="159 "></span></a>
<a id="__codelineno-47-160" name="__codelineno-47-160"></a><a href="#__codelineno-47-160"><span class="linenos" data-linenos="160 "></span></a># 创建 uwsgi 配置文件
<a id="__codelineno-47-161" name="__codelineno-47-161"></a><a href="#__codelineno-47-161"><span class="linenos" data-linenos="161 "></span></a>cat &gt; /data/compose/myproject/uwsgi.ini &lt;&lt;EOF
<a id="__codelineno-47-162" name="__codelineno-47-162"></a><a href="#__codelineno-47-162"><span class="linenos" data-linenos="162 "></span></a>[uwsgi]
<a id="__codelineno-47-163" name="__codelineno-47-163"></a><a href="#__codelineno-47-163"><span class="linenos" data-linenos="163 "></span></a>project=myproject
<a id="__codelineno-47-164" name="__codelineno-47-164"></a><a href="#__codelineno-47-164"><span class="linenos" data-linenos="164 "></span></a>uid=www-data
<a id="__codelineno-47-165" name="__codelineno-47-165"></a><a href="#__codelineno-47-165"><span class="linenos" data-linenos="165 "></span></a>gid=www-data
<a id="__codelineno-47-166" name="__codelineno-47-166"></a><a href="#__codelineno-47-166"><span class="linenos" data-linenos="166 "></span></a>base=/var/www/html
<a id="__codelineno-47-167" name="__codelineno-47-167"></a><a href="#__codelineno-47-167"><span class="linenos" data-linenos="167 "></span></a>
<a id="__codelineno-47-168" name="__codelineno-47-168"></a><a href="#__codelineno-47-168"><span class="linenos" data-linenos="168 "></span></a>chdir=%(base)/%(project)
<a id="__codelineno-47-169" name="__codelineno-47-169"></a><a href="#__codelineno-47-169"><span class="linenos" data-linenos="169 "></span></a>module=%(project).wsgi:application
<a id="__codelineno-47-170" name="__codelineno-47-170"></a><a href="#__codelineno-47-170"><span class="linenos" data-linenos="170 "></span></a>master=True
<a id="__codelineno-47-171" name="__codelineno-47-171"></a><a href="#__codelineno-47-171"><span class="linenos" data-linenos="171 "></span></a>processes=2
<a id="__codelineno-47-172" name="__codelineno-47-172"></a><a href="#__codelineno-47-172"><span class="linenos" data-linenos="172 "></span></a>
<a id="__codelineno-47-173" name="__codelineno-47-173"></a><a href="#__codelineno-47-173"><span class="linenos" data-linenos="173 "></span></a>socket=0.0.0.0:8000
<a id="__codelineno-47-174" name="__codelineno-47-174"></a><a href="#__codelineno-47-174"><span class="linenos" data-linenos="174 "></span></a>chown-socket=%(uid):www-data
<a id="__codelineno-47-175" name="__codelineno-47-175"></a><a href="#__codelineno-47-175"><span class="linenos" data-linenos="175 "></span></a>chmod-socket=664
<a id="__codelineno-47-176" name="__codelineno-47-176"></a><a href="#__codelineno-47-176"><span class="linenos" data-linenos="176 "></span></a>
<a id="__codelineno-47-177" name="__codelineno-47-177"></a><a href="#__codelineno-47-177"><span class="linenos" data-linenos="177 "></span></a>vacuum=True
<a id="__codelineno-47-178" name="__codelineno-47-178"></a><a href="#__codelineno-47-178"><span class="linenos" data-linenos="178 "></span></a>max-requests=5000
<a id="__codelineno-47-179" name="__codelineno-47-179"></a><a href="#__codelineno-47-179"><span class="linenos" data-linenos="179 "></span></a>
<a id="__codelineno-47-180" name="__codelineno-47-180"></a><a href="#__codelineno-47-180"><span class="linenos" data-linenos="180 "></span></a>pidfile=/tmp/%(project)-master.pid
<a id="__codelineno-47-181" name="__codelineno-47-181"></a><a href="#__codelineno-47-181"><span class="linenos" data-linenos="181 "></span></a>daemonize=/tmp/%(project)-uwsgi.log
<a id="__codelineno-47-182" name="__codelineno-47-182"></a><a href="#__codelineno-47-182"><span class="linenos" data-linenos="182 "></span></a>
<a id="__codelineno-47-183" name="__codelineno-47-183"></a><a href="#__codelineno-47-183"><span class="linenos" data-linenos="183 "></span></a>harakiri = 60
<a id="__codelineno-47-184" name="__codelineno-47-184"></a><a href="#__codelineno-47-184"><span class="linenos" data-linenos="184 "></span></a>post buffering = 8192
<a id="__codelineno-47-185" name="__codelineno-47-185"></a><a href="#__codelineno-47-185"><span class="linenos" data-linenos="185 "></span></a>buffer-size= 65535
<a id="__codelineno-47-186" name="__codelineno-47-186"></a><a href="#__codelineno-47-186"><span class="linenos" data-linenos="186 "></span></a>harakiri-verbose = true
<a id="__codelineno-47-187" name="__codelineno-47-187"></a><a href="#__codelineno-47-187"><span class="linenos" data-linenos="187 "></span></a>
<a id="__codelineno-47-188" name="__codelineno-47-188"></a><a href="#__codelineno-47-188"><span class="linenos" data-linenos="188 "></span></a>memory-report = true
<a id="__codelineno-47-189" name="__codelineno-47-189"></a><a href="#__codelineno-47-189"><span class="linenos" data-linenos="189 "></span></a>
<a id="__codelineno-47-190" name="__codelineno-47-190"></a><a href="#__codelineno-47-190"><span class="linenos" data-linenos="190 "></span></a>reload-mercy = 10
<a id="__codelineno-47-191" name="__codelineno-47-191"></a><a href="#__codelineno-47-191"><span class="linenos" data-linenos="191 "></span></a>
<a id="__codelineno-47-192" name="__codelineno-47-192"></a><a href="#__codelineno-47-192"><span class="linenos" data-linenos="192 "></span></a>reload-on-as= 1024
<a id="__codelineno-47-193" name="__codelineno-47-193"></a><a href="#__codelineno-47-193"><span class="linenos" data-linenos="193 "></span></a>EOF
<a id="__codelineno-47-194" name="__codelineno-47-194"></a><a href="#__codelineno-47-194"><span class="linenos" data-linenos="194 "></span></a>
<a id="__codelineno-47-195" name="__codelineno-47-195"></a><a href="#__codelineno-47-195"><span class="linenos" data-linenos="195 "></span></a># 创建环境变量文件
<a id="__codelineno-47-196" name="__codelineno-47-196"></a><a href="#__codelineno-47-196"><span class="linenos" data-linenos="196 "></span></a>cat &gt; /data/compose/myproject/.env &lt;&lt;EOF
<a id="__codelineno-47-197" name="__codelineno-47-197"></a><a href="#__codelineno-47-197"><span class="linenos" data-linenos="197 "></span></a>MYSQL_ROOT_PASSWORD=123456
<a id="__codelineno-47-198" name="__codelineno-47-198"></a><a href="#__codelineno-47-198"><span class="linenos" data-linenos="198 "></span></a>MYSQL_USER=dbuser
<a id="__codelineno-47-199" name="__codelineno-47-199"></a><a href="#__codelineno-47-199"><span class="linenos" data-linenos="199 "></span></a>MYSQL_DATABASE=myproject
<a id="__codelineno-47-200" name="__codelineno-47-200"></a><a href="#__codelineno-47-200"><span class="linenos" data-linenos="200 "></span></a>MYSQL_PASSWORD=password
<a id="__codelineno-47-201" name="__codelineno-47-201"></a><a href="#__codelineno-47-201"><span class="linenos" data-linenos="201 "></span></a>EOF
<a id="__codelineno-47-202" name="__codelineno-47-202"></a><a href="#__codelineno-47-202"><span class="linenos" data-linenos="202 "></span></a>
<a id="__codelineno-47-203" name="__codelineno-47-203"></a><a href="#__codelineno-47-203"><span class="linenos" data-linenos="203 "></span></a># 创建 Requirements 文件
<a id="__codelineno-47-204" name="__codelineno-47-204"></a><a href="#__codelineno-47-204"><span class="linenos" data-linenos="204 "></span></a>cat &gt; /data/compose/myproject/requirements.txt &lt;&lt;EOF
<a id="__codelineno-47-205" name="__codelineno-47-205"></a><a href="#__codelineno-47-205"><span class="linenos" data-linenos="205 "></span></a>django==3.2
<a id="__codelineno-47-206" name="__codelineno-47-206"></a><a href="#__codelineno-47-206"><span class="linenos" data-linenos="206 "></span></a>uwsgi==2.0.18
<a id="__codelineno-47-207" name="__codelineno-47-207"></a><a href="#__codelineno-47-207"><span class="linenos" data-linenos="207 "></span></a>mysqlclient==1.4.6
<a id="__codelineno-47-208" name="__codelineno-47-208"></a><a href="#__codelineno-47-208"><span class="linenos" data-linenos="208 "></span></a>django-redis==4.12.1
<a id="__codelineno-47-209" name="__codelineno-47-209"></a><a href="#__codelineno-47-209"><span class="linenos" data-linenos="209 "></span></a>redis==3.5.3
<a id="__codelineno-47-210" name="__codelineno-47-210"></a><a href="#__codelineno-47-210"><span class="linenos" data-linenos="210 "></span></a>Pillow==8.2.0
<a id="__codelineno-47-211" name="__codelineno-47-211"></a><a href="#__codelineno-47-211"><span class="linenos" data-linenos="211 "></span></a>EOF
<a id="__codelineno-47-212" name="__codelineno-47-212"></a><a href="#__codelineno-47-212"><span class="linenos" data-linenos="212 "></span></a>
<a id="__codelineno-47-213" name="__codelineno-47-213"></a><a href="#__codelineno-47-213"><span class="linenos" data-linenos="213 "></span></a># 创建 Nginx 镜像 Dockerfile
<a id="__codelineno-47-214" name="__codelineno-47-214"></a><a href="#__codelineno-47-214"><span class="linenos" data-linenos="214 "></span></a>cat &gt; /data/compose/nginx/Dockerfile &lt;&lt;EOF
<a id="__codelineno-47-215" name="__codelineno-47-215"></a><a href="#__codelineno-47-215"><span class="linenos" data-linenos="215 "></span></a>FROM nginx:latest
<a id="__codelineno-47-216" name="__codelineno-47-216"></a><a href="#__codelineno-47-216"><span class="linenos" data-linenos="216 "></span></a>
<a id="__codelineno-47-217" name="__codelineno-47-217"></a><a href="#__codelineno-47-217"><span class="linenos" data-linenos="217 "></span></a>RUN rm /etc/nginx/conf.d/default.conf \
<a id="__codelineno-47-218" name="__codelineno-47-218"></a><a href="#__codelineno-47-218"><span class="linenos" data-linenos="218 "></span></a>&amp;&amp; mkdir -p /usr/share/nginx/html/static \
<a id="__codelineno-47-219" name="__codelineno-47-219"></a><a href="#__codelineno-47-219"><span class="linenos" data-linenos="219 "></span></a>&amp;&amp; mkdir -p /usr/share/nginx/html/media \
<a id="__codelineno-47-220" name="__codelineno-47-220"></a><a href="#__codelineno-47-220"><span class="linenos" data-linenos="220 "></span></a>&amp;&amp; mkdir -p /usr/share/nginx/ssl
<a id="__codelineno-47-221" name="__codelineno-47-221"></a><a href="#__codelineno-47-221"><span class="linenos" data-linenos="221 "></span></a>
<a id="__codelineno-47-222" name="__codelineno-47-222"></a><a href="#__codelineno-47-222"><span class="linenos" data-linenos="222 "></span></a>RUN chown -R www-data:www-data /usr/share/nginx/html/media \
<a id="__codelineno-47-223" name="__codelineno-47-223"></a><a href="#__codelineno-47-223"><span class="linenos" data-linenos="223 "></span></a>&amp;&amp; chmod -R 775 /usr/share/nginx/html/media
<a id="__codelineno-47-224" name="__codelineno-47-224"></a><a href="#__codelineno-47-224"><span class="linenos" data-linenos="224 "></span></a>
<a id="__codelineno-47-225" name="__codelineno-47-225"></a><a href="#__codelineno-47-225"><span class="linenos" data-linenos="225 "></span></a>ADD ./nginx.conf /etc/nginx/conf.d/
<a id="__codelineno-47-226" name="__codelineno-47-226"></a><a href="#__codelineno-47-226"><span class="linenos" data-linenos="226 "></span></a>
<a id="__codelineno-47-227" name="__codelineno-47-227"></a><a href="#__codelineno-47-227"><span class="linenos" data-linenos="227 "></span></a>CMD [&quot;nginx&quot;, &quot;-g&quot;, &quot;daemon off;&quot;]
<a id="__codelineno-47-228" name="__codelineno-47-228"></a><a href="#__codelineno-47-228"><span class="linenos" data-linenos="228 "></span></a>EOF
<a id="__codelineno-47-229" name="__codelineno-47-229"></a><a href="#__codelineno-47-229"><span class="linenos" data-linenos="229 "></span></a>
<a id="__codelineno-47-230" name="__codelineno-47-230"></a><a href="#__codelineno-47-230"><span class="linenos" data-linenos="230 "></span></a># 创建 Nginx 配置文件
<a id="__codelineno-47-231" name="__codelineno-47-231"></a><a href="#__codelineno-47-231"><span class="linenos" data-linenos="231 "></span></a>cat &gt; /data/compose/nginx/nginx.conf &lt;&lt;EOF
<a id="__codelineno-47-232" name="__codelineno-47-232"></a><a href="#__codelineno-47-232"><span class="linenos" data-linenos="232 "></span></a># nginx配置文件
<a id="__codelineno-47-233" name="__codelineno-47-233"></a><a href="#__codelineno-47-233"><span class="linenos" data-linenos="233 "></span></a># compose/nginx/nginx.conf
<a id="__codelineno-47-234" name="__codelineno-47-234"></a><a href="#__codelineno-47-234"><span class="linenos" data-linenos="234 "></span></a>
<a id="__codelineno-47-235" name="__codelineno-47-235"></a><a href="#__codelineno-47-235"><span class="linenos" data-linenos="235 "></span></a>upstream django {
<a id="__codelineno-47-236" name="__codelineno-47-236"></a><a href="#__codelineno-47-236"><span class="linenos" data-linenos="236 "></span></a>    ip_hash;
<a id="__codelineno-47-237" name="__codelineno-47-237"></a><a href="#__codelineno-47-237"><span class="linenos" data-linenos="237 "></span></a>    server web:8000; # Docker-compose web服务端口
<a id="__codelineno-47-238" name="__codelineno-47-238"></a><a href="#__codelineno-47-238"><span class="linenos" data-linenos="238 "></span></a>}
<a id="__codelineno-47-239" name="__codelineno-47-239"></a><a href="#__codelineno-47-239"><span class="linenos" data-linenos="239 "></span></a>
<a id="__codelineno-47-240" name="__codelineno-47-240"></a><a href="#__codelineno-47-240"><span class="linenos" data-linenos="240 "></span></a># 配置http请求，80端口
<a id="__codelineno-47-241" name="__codelineno-47-241"></a><a href="#__codelineno-47-241"><span class="linenos" data-linenos="241 "></span></a>server {
<a id="__codelineno-47-242" name="__codelineno-47-242"></a><a href="#__codelineno-47-242"><span class="linenos" data-linenos="242 "></span></a>    listen 80; # 监听80端口
<a id="__codelineno-47-243" name="__codelineno-47-243"></a><a href="#__codelineno-47-243"><span class="linenos" data-linenos="243 "></span></a>    server_name 192.168.4; # 可以是nginx容器所在ip地址或127.0.0.1，不能写宿主机外网ip地址
<a id="__codelineno-47-244" name="__codelineno-47-244"></a><a href="#__codelineno-47-244"><span class="linenos" data-linenos="244 "></span></a>
<a id="__codelineno-47-245" name="__codelineno-47-245"></a><a href="#__codelineno-47-245"><span class="linenos" data-linenos="245 "></span></a>    charset utf-8;
<a id="__codelineno-47-246" name="__codelineno-47-246"></a><a href="#__codelineno-47-246"><span class="linenos" data-linenos="246 "></span></a>    client_max_body_size 10M; # 限制用户上传文件大小
<a id="__codelineno-47-247" name="__codelineno-47-247"></a><a href="#__codelineno-47-247"><span class="linenos" data-linenos="247 "></span></a>
<a id="__codelineno-47-248" name="__codelineno-47-248"></a><a href="#__codelineno-47-248"><span class="linenos" data-linenos="248 "></span></a>    access_log /var/log/nginx/access.log main;
<a id="__codelineno-47-249" name="__codelineno-47-249"></a><a href="#__codelineno-47-249"><span class="linenos" data-linenos="249 "></span></a>    error_log /var/log/nginx/error.log warn;
<a id="__codelineno-47-250" name="__codelineno-47-250"></a><a href="#__codelineno-47-250"><span class="linenos" data-linenos="250 "></span></a>
<a id="__codelineno-47-251" name="__codelineno-47-251"></a><a href="#__codelineno-47-251"><span class="linenos" data-linenos="251 "></span></a>    location /static {
<a id="__codelineno-47-252" name="__codelineno-47-252"></a><a href="#__codelineno-47-252"><span class="linenos" data-linenos="252 "></span></a>        alias /usr/share/nginx/html/static; # 静态资源路径
<a id="__codelineno-47-253" name="__codelineno-47-253"></a><a href="#__codelineno-47-253"><span class="linenos" data-linenos="253 "></span></a>    }
<a id="__codelineno-47-254" name="__codelineno-47-254"></a><a href="#__codelineno-47-254"><span class="linenos" data-linenos="254 "></span></a>
<a id="__codelineno-47-255" name="__codelineno-47-255"></a><a href="#__codelineno-47-255"><span class="linenos" data-linenos="255 "></span></a>    location /media {
<a id="__codelineno-47-256" name="__codelineno-47-256"></a><a href="#__codelineno-47-256"><span class="linenos" data-linenos="256 "></span></a>        alias /usr/share/nginx/html/media; # 媒体资源，用户上传文件路径
<a id="__codelineno-47-257" name="__codelineno-47-257"></a><a href="#__codelineno-47-257"><span class="linenos" data-linenos="257 "></span></a>    }
<a id="__codelineno-47-258" name="__codelineno-47-258"></a><a href="#__codelineno-47-258"><span class="linenos" data-linenos="258 "></span></a>
<a id="__codelineno-47-259" name="__codelineno-47-259"></a><a href="#__codelineno-47-259"><span class="linenos" data-linenos="259 "></span></a>    location / {
<a id="__codelineno-47-260" name="__codelineno-47-260"></a><a href="#__codelineno-47-260"><span class="linenos" data-linenos="260 "></span></a>        include /etc/nginx/uwsgi_params;
<a id="__codelineno-47-261" name="__codelineno-47-261"></a><a href="#__codelineno-47-261"><span class="linenos" data-linenos="261 "></span></a>        uwsgi_pass django;
<a id="__codelineno-47-262" name="__codelineno-47-262"></a><a href="#__codelineno-47-262"><span class="linenos" data-linenos="262 "></span></a>        uwsgi_read_timeout 600;
<a id="__codelineno-47-263" name="__codelineno-47-263"></a><a href="#__codelineno-47-263"><span class="linenos" data-linenos="263 "></span></a>        uwsgi_connect_timeout 600;
<a id="__codelineno-47-264" name="__codelineno-47-264"></a><a href="#__codelineno-47-264"><span class="linenos" data-linenos="264 "></span></a>        uwsgi_send_timeout 600;
<a id="__codelineno-47-265" name="__codelineno-47-265"></a><a href="#__codelineno-47-265"><span class="linenos" data-linenos="265 "></span></a>
<a id="__codelineno-47-266" name="__codelineno-47-266"></a><a href="#__codelineno-47-266"><span class="linenos" data-linenos="266 "></span></a>        proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
<a id="__codelineno-47-267" name="__codelineno-47-267"></a><a href="#__codelineno-47-267"><span class="linenos" data-linenos="267 "></span></a>        proxy_redirect off;
<a id="__codelineno-47-268" name="__codelineno-47-268"></a><a href="#__codelineno-47-268"><span class="linenos" data-linenos="268 "></span></a>        proxy_set_header X-Real-IP  $remote_addr;
<a id="__codelineno-47-269" name="__codelineno-47-269"></a><a href="#__codelineno-47-269"><span class="linenos" data-linenos="269 "></span></a>    }
<a id="__codelineno-47-270" name="__codelineno-47-270"></a><a href="#__codelineno-47-270"><span class="linenos" data-linenos="270 "></span></a>}
<a id="__codelineno-47-271" name="__codelineno-47-271"></a><a href="#__codelineno-47-271"><span class="linenos" data-linenos="271 "></span></a>EOF
<a id="__codelineno-47-272" name="__codelineno-47-272"></a><a href="#__codelineno-47-272"><span class="linenos" data-linenos="272 "></span></a>
<a id="__codelineno-47-273" name="__codelineno-47-273"></a><a href="#__codelineno-47-273"><span class="linenos" data-linenos="273 "></span></a># 创建 MySQL 配置文件
<a id="__codelineno-47-274" name="__codelineno-47-274"></a><a href="#__codelineno-47-274"><span class="linenos" data-linenos="274 "></span></a>cat &gt; /data/compose/mysql/conf/my.cnf &lt;&lt;EOF
<a id="__codelineno-47-275" name="__codelineno-47-275"></a><a href="#__codelineno-47-275"><span class="linenos" data-linenos="275 "></span></a>[mysqld]
<a id="__codelineno-47-276" name="__codelineno-47-276"></a><a href="#__codelineno-47-276"><span class="linenos" data-linenos="276 "></span></a>user=mysql
<a id="__codelineno-47-277" name="__codelineno-47-277"></a><a href="#__codelineno-47-277"><span class="linenos" data-linenos="277 "></span></a>default-storage-engine=INNODB
<a id="__codelineno-47-278" name="__codelineno-47-278"></a><a href="#__codelineno-47-278"><span class="linenos" data-linenos="278 "></span></a>character-set-server=utf8
<a id="__codelineno-47-279" name="__codelineno-47-279"></a><a href="#__codelineno-47-279"><span class="linenos" data-linenos="279 "></span></a>secure-file-priv=NULL
<a id="__codelineno-47-280" name="__codelineno-47-280"></a><a href="#__codelineno-47-280"><span class="linenos" data-linenos="280 "></span></a>default-authentication-plugin=mysql_native_password
<a id="__codelineno-47-281" name="__codelineno-47-281"></a><a href="#__codelineno-47-281"><span class="linenos" data-linenos="281 "></span></a>
<a id="__codelineno-47-282" name="__codelineno-47-282"></a><a href="#__codelineno-47-282"><span class="linenos" data-linenos="282 "></span></a>port            = 3306
<a id="__codelineno-47-283" name="__codelineno-47-283"></a><a href="#__codelineno-47-283"><span class="linenos" data-linenos="283 "></span></a>basedir         = /usr
<a id="__codelineno-47-284" name="__codelineno-47-284"></a><a href="#__codelineno-47-284"><span class="linenos" data-linenos="284 "></span></a>datadir         = /var/lib/mysql
<a id="__codelineno-47-285" name="__codelineno-47-285"></a><a href="#__codelineno-47-285"><span class="linenos" data-linenos="285 "></span></a>tmpdir          = /tmp
<a id="__codelineno-47-286" name="__codelineno-47-286"></a><a href="#__codelineno-47-286"><span class="linenos" data-linenos="286 "></span></a>pid-file        = /var/run/mysqld/mysqld.pid
<a id="__codelineno-47-287" name="__codelineno-47-287"></a><a href="#__codelineno-47-287"><span class="linenos" data-linenos="287 "></span></a>socket          = /var/run/mysqld/mysqld.sock
<a id="__codelineno-47-288" name="__codelineno-47-288"></a><a href="#__codelineno-47-288"><span class="linenos" data-linenos="288 "></span></a>skip-name-resolve
<a id="__codelineno-47-289" name="__codelineno-47-289"></a><a href="#__codelineno-47-289"><span class="linenos" data-linenos="289 "></span></a>
<a id="__codelineno-47-290" name="__codelineno-47-290"></a><a href="#__codelineno-47-290"><span class="linenos" data-linenos="290 "></span></a>[client]
<a id="__codelineno-47-291" name="__codelineno-47-291"></a><a href="#__codelineno-47-291"><span class="linenos" data-linenos="291 "></span></a>port = 3306
<a id="__codelineno-47-292" name="__codelineno-47-292"></a><a href="#__codelineno-47-292"><span class="linenos" data-linenos="292 "></span></a>default-character-set=utf8
<a id="__codelineno-47-293" name="__codelineno-47-293"></a><a href="#__codelineno-47-293"><span class="linenos" data-linenos="293 "></span></a>
<a id="__codelineno-47-294" name="__codelineno-47-294"></a><a href="#__codelineno-47-294"><span class="linenos" data-linenos="294 "></span></a>[mysql]
<a id="__codelineno-47-295" name="__codelineno-47-295"></a><a href="#__codelineno-47-295"><span class="linenos" data-linenos="295 "></span></a>no-auto-rehash
<a id="__codelineno-47-296" name="__codelineno-47-296"></a><a href="#__codelineno-47-296"><span class="linenos" data-linenos="296 "></span></a>default-character-set=utf8
<a id="__codelineno-47-297" name="__codelineno-47-297"></a><a href="#__codelineno-47-297"><span class="linenos" data-linenos="297 "></span></a>EOF
<a id="__codelineno-47-298" name="__codelineno-47-298"></a><a href="#__codelineno-47-298"><span class="linenos" data-linenos="298 "></span></a>
<a id="__codelineno-47-299" name="__codelineno-47-299"></a><a href="#__codelineno-47-299"><span class="linenos" data-linenos="299 "></span></a># 创建 MySQL 初始化脚本
<a id="__codelineno-47-300" name="__codelineno-47-300"></a><a href="#__codelineno-47-300"><span class="linenos" data-linenos="300 "></span></a>cat &gt; /data/compose/mysql/init/init.sql &lt;&lt;EOF
<a id="__codelineno-47-301" name="__codelineno-47-301"></a><a href="#__codelineno-47-301"><span class="linenos" data-linenos="301 "></span></a>ALTER USER &#39;dbuser&#39;@&#39;%&#39; IDENTIFIED WITH mysql_native_password BY &#39;password&#39;;
<a id="__codelineno-47-302" name="__codelineno-47-302"></a><a href="#__codelineno-47-302"><span class="linenos" data-linenos="302 "></span></a>GRANT ALL PRIVILEGES ON myproject.* TO &#39;dbuser&#39;@&#39;%&#39;;
<a id="__codelineno-47-303" name="__codelineno-47-303"></a><a href="#__codelineno-47-303"><span class="linenos" data-linenos="303 "></span></a>FLUSH PRIVILEGES;
<a id="__codelineno-47-304" name="__codelineno-47-304"></a><a href="#__codelineno-47-304"><span class="linenos" data-linenos="304 "></span></a>EOF
<a id="__codelineno-47-305" name="__codelineno-47-305"></a><a href="#__codelineno-47-305"><span class="linenos" data-linenos="305 "></span></a>
<a id="__codelineno-47-306" name="__codelineno-47-306"></a><a href="#__codelineno-47-306"><span class="linenos" data-linenos="306 "></span></a># 创建 Redis 配置文件
<a id="__codelineno-47-307" name="__codelineno-47-307"></a><a href="#__codelineno-47-307"><span class="linenos" data-linenos="307 "></span></a>cat &gt; /data/compose/redis/redis.conf &lt;&lt;EOF
<a id="__codelineno-47-308" name="__codelineno-47-308"></a><a href="#__codelineno-47-308"><span class="linenos" data-linenos="308 "></span></a>bind 127.0.0.1
<a id="__codelineno-47-309" name="__codelineno-47-309"></a><a href="#__codelineno-47-309"><span class="linenos" data-linenos="309 "></span></a>requirepass yourpassword
<a id="__codelineno-47-310" name="__codelineno-47-310"></a><a href="#__codelineno-47-310"><span class="linenos" data-linenos="310 "></span></a>EOF
<a id="__codelineno-47-311" name="__codelineno-47-311"></a><a href="#__codelineno-47-311"><span class="linenos" data-linenos="311 "></span></a>
<a id="__codelineno-47-312" name="__codelineno-47-312"></a><a href="#__codelineno-47-312"><span class="linenos" data-linenos="312 "></span></a># 生成 pip 配置文件
<a id="__codelineno-47-313" name="__codelineno-47-313"></a><a href="#__codelineno-47-313"><span class="linenos" data-linenos="313 "></span></a>cat &gt; /data/compose/myproject/pip.conf &lt;&lt;EOF
<a id="__codelineno-47-314" name="__codelineno-47-314"></a><a href="#__codelineno-47-314"><span class="linenos" data-linenos="314 "></span></a>[global]
<a id="__codelineno-47-315" name="__codelineno-47-315"></a><a href="#__codelineno-47-315"><span class="linenos" data-linenos="315 "></span></a>index-url = https://mirrors.aliyun.com/pypi/simple/
<a id="__codelineno-47-316" name="__codelineno-47-316"></a><a href="#__codelineno-47-316"><span class="linenos" data-linenos="316 "></span></a>
<a id="__codelineno-47-317" name="__codelineno-47-317"></a><a href="#__codelineno-47-317"><span class="linenos" data-linenos="317 "></span></a>[install]
<a id="__codelineno-47-318" name="__codelineno-47-318"></a><a href="#__codelineno-47-318"><span class="linenos" data-linenos="318 "></span></a>trusted-host = mirrors.aliyun.com
<a id="__codelineno-47-319" name="__codelineno-47-319"></a><a href="#__codelineno-47-319"><span class="linenos" data-linenos="319 "></span></a>EOF
<a id="__codelineno-47-320" name="__codelineno-47-320"></a><a href="#__codelineno-47-320"><span class="linenos" data-linenos="320 "></span></a>
<a id="__codelineno-47-321" name="__codelineno-47-321"></a><a href="#__codelineno-47-321"><span class="linenos" data-linenos="321 "></span></a># 构建镜像并启动容器
<a id="__codelineno-47-322" name="__codelineno-47-322"></a><a href="#__codelineno-47-322"><span class="linenos" data-linenos="322 "></span></a>cd /data/compose/myproject
<a id="__codelineno-47-323" name="__codelineno-47-323"></a><a href="#__codelineno-47-323"><span class="linenos" data-linenos="323 "></span></a>docker-compose build
<a id="__codelineno-47-324" name="__codelineno-47-324"></a><a href="#__codelineno-47-324"><span class="linenos" data-linenos="324 "></span></a>docker-compose up -d
</code></pre></div>
<h2 id="8django其它操作">（8）django其它操作<a class="headerlink" href="#8django其它操作" title="Permanent link">&para;</a></h2>
<h4 id="1启动django">1.启动django<a class="headerlink" href="#1启动django" title="Permanent link">&para;</a></h4>
<p>连接docker容器</p>
<div class="language-text highlight"><span class="filename">Text Only</span><pre><span></span><code><a id="__codelineno-48-1" name="__codelineno-48-1"></a><a href="#__codelineno-48-1"><span class="linenos" data-linenos="1 "></span></a>docker exec -it id bash
</code></pre></div>
<p>查看版本</p>
<div class="language-text highlight"><span class="filename">Text Only</span><pre><span></span><code><a id="__codelineno-49-1" name="__codelineno-49-1"></a><a href="#__codelineno-49-1"><span class="linenos" data-linenos="1 "></span></a>python3 -m django --version
</code></pre></div>
<p>创建项目</p>
<div class="language-text highlight"><span class="filename">Text Only</span><pre><span></span><code><a id="__codelineno-50-1" name="__codelineno-50-1"></a><a href="#__codelineno-50-1"><span class="linenos" data-linenos="1 "></span></a>django-admin startproject mysite
</code></pre></div>
<p>运行方式，端口可以自定义</p>
<div class="language-text highlight"><span class="filename">Text Only</span><pre><span></span><code><a id="__codelineno-51-1" name="__codelineno-51-1"></a><a href="#__codelineno-51-1"><span class="linenos" data-linenos="1 "></span></a>python3 /var/www/html/myproject/manage.py runserver 0.0.0.0:8000
</code></pre></div>
<p>使用 <code>nohup</code> 命令来后台运行 Django 项目：</p>
<div class="language-bash highlight"><span class="filename">Bash</span><pre><span></span><code><a id="__codelineno-52-1" name="__codelineno-52-1"></a><a href="#__codelineno-52-1"><span class="linenos" data-linenos="1 "></span></a>nohup<span class="w"> </span>python3<span class="w"> </span>/var/www/html/myproject/manage.py<span class="w"> </span>runserver<span class="w"> </span><span class="m">0</span>.0.0.0:8000<span class="w"> </span><span class="p">&amp;</span>
</code></pre></div>
<ul>
<li><code>nohup</code>: 表示忽略挂起信号，允许进程在后台运行。</li>
<li><code>&amp;</code>: 在命令末尾加上 <code>&amp;</code> 表示将进程放到后台运行。</li>
</ul>
<p>使用 <code>ps</code> 命令查找进程 ID（PID）</p>
<div class="language-bash highlight"><span class="filename">Bash</span><pre><span></span><code><a id="__codelineno-53-1" name="__codelineno-53-1"></a><a href="#__codelineno-53-1"><span class="linenos" data-linenos="1 "></span></a>ps<span class="w"> </span>aux<span class="w"> </span><span class="p">|</span><span class="w"> </span>grep<span class="w"> </span>python3
</code></pre></div>
<p>使用 <code>kill</code> 命令终止进程：</p>
<div class="language-bash highlight"><span class="filename">Bash</span><pre><span></span><code><a id="__codelineno-54-1" name="__codelineno-54-1"></a><a href="#__codelineno-54-1"><span class="linenos" data-linenos="1 "></span></a><span class="nb">kill</span><span class="w"> </span>-9<span class="w"> </span>&lt;PID&gt;
</code></pre></div>
<p>成功则返回</p>
<blockquote>
<p>Performing system checks&hellip;</p>
<p>System check identified no issues (0 silenced).</p>
<p>You have 18 unapplied migration(s). Your project may not work properly until you apply the migrations for app(s): admin, auth, contenttypes, sessions.
Run &lsquo;python manage.py migrate&rsquo; to apply them.
April 16, 2024 - 04:02:48
Django version 3.2, using settings &lsquo;myproject.settings&rsquo;
Starting development server at <a href="http://0.0.0.0:8000/">http://0.0.0.0:8000/</a></p>
</blockquote>
<p>通过服务器IP+端口8000进行访问，如返回，在django中，urls.py定义如何请求映射到视图函数。</p>
<p><a class="glightbox" href="https://raw.githubusercontent.com/joshzhong66/Pibced/main/blog-images/2024/04/25/8f2d97a3175c6b112fe91f65a5f5155e-image-20240425171453013-e89ecc.png" data-type="image" data-width="auto" data-height="auto" data-desc-position="bottom"><img alt="image-20240425171453013" src="https://raw.githubusercontent.com/joshzhong66/Pibced/main/blog-images/2024/04/25/8f2d97a3175c6b112fe91f65a5f5155e-image-20240425171453013-e89ecc.png" /></a></p>
<blockquote>
<h1 id="not-found">Not Found<a class="headerlink" href="#not-found" title="Permanent link">&para;</a></h1>
<p>The requested resource was not found on this server.</p>
</blockquote>
<p>通常是未将settings.py的设置为<code>DEBUG = True</code>，如需登录django后台，使用：<a href="http://10.22.51.65:8000/admin进行访问">http://10.22.51.65:8000/admin进行访问</a>，并且需要创建管理员</p>
<p><a class="glightbox" href="https://raw.githubusercontent.com/joshzhong66/Pibced/main/blog-images/2024/04/25/02d49a14a9c05264d92689f851d5e1c8-image-20240425171637023-a95374.png" data-type="image" data-width="auto" data-height="auto" data-desc-position="bottom"><img alt="image-20240425171637023" src="https://raw.githubusercontent.com/joshzhong66/Pibced/main/blog-images/2024/04/25/02d49a14a9c05264d92689f851d5e1c8-image-20240425171637023-a95374.png" /></a></p>
<h4 id="2创建superuser管理员">2.创建superuser管理员<a class="headerlink" href="#2创建superuser管理员" title="Permanent link">&para;</a></h4>
<p>1、确保settings.py的DATABASES与Mysql数据用户密码一致。</p>
<p>在项目目录下，执行命令<code>python3.6 manage.py createsuperuser</code></p>
<div class="language-text highlight"><span class="filename">Text Only</span><pre><span></span><code><a id="__codelineno-55-1" name="__codelineno-55-1"></a><a href="#__codelineno-55-1"><span class="linenos" data-linenos=" 1 "></span></a>[root@11eaf6e23195 myproject]# python3.6 /var/www/html/myproject/manage.py createsuperuser
<a id="__codelineno-55-2" name="__codelineno-55-2"></a><a href="#__codelineno-55-2"><span class="linenos" data-linenos=" 2 "></span></a>
<a id="__codelineno-55-3" name="__codelineno-55-3"></a><a href="#__codelineno-55-3"><span class="linenos" data-linenos=" 3 "></span></a>Username (leave blank to use &#39;root&#39;): josh
<a id="__codelineno-55-4" name="__codelineno-55-4"></a><a href="#__codelineno-55-4"><span class="linenos" data-linenos=" 4 "></span></a>Email address: 980521387@qq.com
<a id="__codelineno-55-5" name="__codelineno-55-5"></a><a href="#__codelineno-55-5"><span class="linenos" data-linenos=" 5 "></span></a>Password: 123456
<a id="__codelineno-55-6" name="__codelineno-55-6"></a><a href="#__codelineno-55-6"><span class="linenos" data-linenos=" 6 "></span></a>Password (again): 123456
<a id="__codelineno-55-7" name="__codelineno-55-7"></a><a href="#__codelineno-55-7"><span class="linenos" data-linenos=" 7 "></span></a>This password is too short. It must contain at least 8 characters.
<a id="__codelineno-55-8" name="__codelineno-55-8"></a><a href="#__codelineno-55-8"><span class="linenos" data-linenos=" 8 "></span></a>This password is too common.
<a id="__codelineno-55-9" name="__codelineno-55-9"></a><a href="#__codelineno-55-9"><span class="linenos" data-linenos=" 9 "></span></a>This password is entirely numeric.
<a id="__codelineno-55-10" name="__codelineno-55-10"></a><a href="#__codelineno-55-10"><span class="linenos" data-linenos="10 "></span></a>Bypass password validation and create user anyway? [y/N]: y
<a id="__codelineno-55-11" name="__codelineno-55-11"></a><a href="#__codelineno-55-11"><span class="linenos" data-linenos="11 "></span></a>Superuser created successfully.
</code></pre></div>
<p>遇到个报错，提示：您有 18 个未应用的迁移。</p>
<blockquote>
<p>You have 18 unapplied migration(s). Your project may not work properly until you apply the migrations for app(s): admin, auth, contenttypes, sessions.
Run &lsquo;python manage.py migrate&rsquo; to apply them.</p>
</blockquote>
<p>解决办法：<strong>应用数据库迁移</strong>，再重新执行创建。</p>
<div class="language-text highlight"><span class="filename">Text Only</span><pre><span></span><code><a id="__codelineno-56-1" name="__codelineno-56-1"></a><a href="#__codelineno-56-1"><span class="linenos" data-linenos="1 "></span></a>python3.6 manage.py makemigrations
<a id="__codelineno-56-2" name="__codelineno-56-2"></a><a href="#__codelineno-56-2"><span class="linenos" data-linenos="2 "></span></a>python3.6 manage.py migrate
</code></pre></div>
<h4 id="3web修改中文">3.web修改中文<a class="headerlink" href="#3web修改中文" title="Permanent link">&para;</a></h4>
<p>编辑vi settings.py，<code>修改参数为：LANGUAGE_CODE = 'zh-hans'</code>，改完刷新页面生效。</p>
<h4 id="4创建应用app"><strong>4.创建应用app</strong><a class="headerlink" href="#4创建应用app" title="Permanent link">&para;</a></h4>
<p>创建jobs的app</p>
<div class="language-text highlight"><span class="filename">Text Only</span><pre><span></span><code><a id="__codelineno-57-1" name="__codelineno-57-1"></a><a href="#__codelineno-57-1"><span class="linenos" data-linenos="1 "></span></a>#创建应用名为jobs
<a id="__codelineno-57-2" name="__codelineno-57-2"></a><a href="#__codelineno-57-2"><span class="linenos" data-linenos="2 "></span></a>python3.6 manage.py startapp jobs
<a id="__codelineno-57-3" name="__codelineno-57-3"></a><a href="#__codelineno-57-3"><span class="linenos" data-linenos="3 "></span></a>
<a id="__codelineno-57-4" name="__codelineno-57-4"></a><a href="#__codelineno-57-4"><span class="linenos" data-linenos="4 "></span></a>#修改settings.py,
<a id="__codelineno-57-5" name="__codelineno-57-5"></a><a href="#__codelineno-57-5"><span class="linenos" data-linenos="5 "></span></a>vi /var/www/html/myproject/myproject/settings.py
</code></pre></div>
<p>在INSTALLED_APPS后，增加jobs</p>
<div class="language-text highlight"><span class="filename">Text Only</span><pre><span></span><code><a id="__codelineno-58-1" name="__codelineno-58-1"></a><a href="#__codelineno-58-1"><span class="linenos" data-linenos="1 "></span></a>INSTALLED_APPS = [
<a id="__codelineno-58-2" name="__codelineno-58-2"></a><a href="#__codelineno-58-2"><span class="linenos" data-linenos="2 "></span></a>    &quot;django.contrib.admin&quot;,
<a id="__codelineno-58-3" name="__codelineno-58-3"></a><a href="#__codelineno-58-3"><span class="linenos" data-linenos="3 "></span></a>    &quot;django.contrib.auth&quot;,
<a id="__codelineno-58-4" name="__codelineno-58-4"></a><a href="#__codelineno-58-4"><span class="linenos" data-linenos="4 "></span></a>    &quot;django.contrib.contenttypes&quot;,
<a id="__codelineno-58-5" name="__codelineno-58-5"></a><a href="#__codelineno-58-5"><span class="linenos" data-linenos="5 "></span></a>    &quot;django.contrib.sessions&quot;,
<a id="__codelineno-58-6" name="__codelineno-58-6"></a><a href="#__codelineno-58-6"><span class="linenos" data-linenos="6 "></span></a>    &quot;django.contrib.messages&quot;,
<a id="__codelineno-58-7" name="__codelineno-58-7"></a><a href="#__codelineno-58-7"><span class="linenos" data-linenos="7 "></span></a>    &quot;django.contrib.staticfiles&quot;,
<a id="__codelineno-58-8" name="__codelineno-58-8"></a><a href="#__codelineno-58-8"><span class="linenos" data-linenos="8 "></span></a>    &quot;jobs&quot;    #此处
<a id="__codelineno-58-9" name="__codelineno-58-9"></a><a href="#__codelineno-58-9"><span class="linenos" data-linenos="9 "></span></a>]
</code></pre></div>







  
    
  
  


  <aside class="md-source-file">
    
      
  <span class="md-source-file__fact">
    <span class="md-icon" title="最后更新">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M21 13.1c-.1 0-.3.1-.4.2l-1 1 2.1 2.1 1-1c.2-.2.2-.6 0-.8l-1.3-1.3c-.1-.1-.2-.2-.4-.2m-1.9 1.8-6.1 6V23h2.1l6.1-6.1-2.1-2M12.5 7v5.2l4 2.4-1 1L11 13V7h1.5M11 21.9c-5.1-.5-9-4.8-9-9.9C2 6.5 6.5 2 12 2c5.3 0 9.6 4.1 10 9.3-.3-.1-.6-.2-1-.2s-.7.1-1 .2C19.6 7.2 16.2 4 12 4c-4.4 0-8 3.6-8 8 0 4.1 3.1 7.5 7.1 7.9l-.1.2v1.8Z"/></svg>
    </span>
    <span class="git-revision-date-localized-plugin git-revision-date-localized-plugin-iso_date">2024-11-21</span>
  </span>

    
    
    
    
  </aside>


  




                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
          <button type="button" class="md-top md-icon" data-md-component="top" hidden>
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12Z"/></svg>
  回到页面顶部
</button>
        
      </main>
      
        <footer class="md-footer">
  
    
      
      <nav class="md-footer__inner md-grid" aria-label="页脚" >
        
          
          <a href="../docker%20%E9%83%A8%E7%BD%B2IT-Tools/" class="md-footer__link md-footer__link--prev" aria-label="上一页: docker 部署IT-Tools">
            <div class="md-footer__button md-icon">
              
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
            </div>
            <div class="md-footer__title">
              <span class="md-footer__direction">
                上一页
              </span>
              <div class="md-ellipsis">
                docker 部署IT-Tools
              </div>
            </div>
          </a>
        
        
          
          <a href="../docker%20%E9%83%A8%E7%BD%B2dockerNAS/" class="md-footer__link md-footer__link--next" aria-label="下一页: docker 部署dockerNAS">
            <div class="md-footer__title">
              <span class="md-footer__direction">
                下一页
              </span>
              <div class="md-ellipsis">
                docker 部署dockerNAS
              </div>
            </div>
            <div class="md-footer__button md-icon">
              
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11H4Z"/></svg>
            </div>
          </a>
        
      </nav>
    
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <!--
  Copyright (c) 2016-2023 Martin Donath <martin.donath@squidfunk.com>

  Permission is hereby granted, free of charge, to any person obtaining a copy
  of this software and associated documentation files (the "Software"), to
  deal in the Software without restriction, including without limitation the
  rights to use, copy, modify, merge, publish, distribute, sublicense, and/or
  sell copies of the Software, and to permit persons to whom the Software is
  furnished to do so, subject to the following conditions:

  The above copyright notice and this permission notice shall be included in
  all copies or substantial portions of the Software.

  THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
  IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
  FITNESS FOR A PARTICULAR PURPOSE AND NON-INFRINGEMENT. IN NO EVENT SHALL THE
  AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
  LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING
  FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS
  IN THE SOFTWARE.
-->

<!-- Copyright and theme information -->
<div class="md-copyright">
  
    <div class="md-copyright__highlight">
      版权所有 © 2023-2024 | <a href="http://beian.miit.gov.cn/" target="_blank" rel="noopener">粤ICP备2024253391号</a>
    </div>
  
  
    <script id="LA-DATA-WIDGET" crossorigin="anonymous" charset="UTF-8" src="https://v6-widget.51.la/v6/3JIbgFniDcGIaNP7/quote.js?theme=#FFFFFF,#808080,#808080,#B3B3B3,#FFFFFF,#1690FF,12&f=12&display=0,0,1,1,1,1,1,1"></script>
    <!--Made with
    <a
      href="https://squidfunk.github.io/mkdocs-material/"
      target="_blank" rel="noopener"
    >
      Material for MkDocs
    </a> | <a href="http://beian.miit.gov.cn/" target="_blank" rel="noopener">粤ICP备16023717号</a-->
  
</div>
      
        <div class="md-social">
  
    
    
    
    
    <a href="https://github.com" target="_blank" rel="noopener" title="GitHub" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><!--! Font Awesome Free 6.6.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"/></svg>
    </a>
  
    
    
    
    
    <a href="https://www.google.com/" target="_blank" rel="noopener" title="Google" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 488 512"><!--! Font Awesome Free 6.6.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M488 261.8C488 403.3 391.1 504 248 504 110.8 504 0 393.2 0 256S110.8 8 248 8c66.8 0 123 24.5 166.3 64.9l-67.5 64.9C258.5 52.6 94.3 116.6 94.3 256c0 86.5 69.1 156.6 153.7 156.6 98.2 0 135-70.4 140.8-106.9H248v-85.3h236.1c2.3 12.7 3.9 24.9 3.9 41.4z"/></svg>
    </a>
  
    
    
    
    
    <a href="https://www.linux.org/" target="_blank" rel="noopener" title="Linux" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.6.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M220.8 123.3c1 .5 1.8 1.7 3 1.7 1.1 0 2.8-.4 2.9-1.5.2-1.4-1.9-2.3-3.2-2.9-1.7-.7-3.9-1-5.5-.1-.4.2-.8.7-.6 1.1.3 1.3 2.3 1.1 3.4 1.7zm-21.9 1.7c1.2 0 2-1.2 3-1.7 1.1-.6 3.1-.4 3.5-1.6.2-.4-.2-.9-.6-1.1-1.6-.9-3.8-.6-5.5.1-1.3.6-3.4 1.5-3.2 2.9.1 1 1.8 1.5 2.8 1.4zM420 403.8c-3.6-4-5.3-11.6-7.2-19.7-1.8-8.1-3.9-16.8-10.5-22.4-1.3-1.1-2.6-2.1-4-2.9-1.3-.8-2.7-1.5-4.1-2 9.2-27.3 5.6-54.5-3.7-79.1-11.4-30.1-31.3-56.4-46.5-74.4-17.1-21.5-33.7-41.9-33.4-72C311.1 85.4 315.7.1 234.8 0 132.4-.2 158 103.4 156.9 135.2c-1.7 23.4-6.4 41.8-22.5 64.7-18.9 22.5-45.5 58.8-58.1 96.7-6 17.9-8.8 36.1-6.2 53.3-6.5 5.8-11.4 14.7-16.6 20.2-4.2 4.3-10.3 5.9-17 8.3s-14 6-18.5 14.5c-2.1 3.9-2.8 8.1-2.8 12.4 0 3.9.6 7.9 1.2 11.8 1.2 8.1 2.5 15.7.8 20.8-5.2 14.4-5.9 24.4-2.2 31.7 3.8 7.3 11.4 10.5 20.1 12.3 17.3 3.6 40.8 2.7 59.3 12.5 19.8 10.4 39.9 14.1 55.9 10.4 11.6-2.6 21.1-9.6 25.9-20.2 12.5-.1 26.3-5.4 48.3-6.6 14.9-1.2 33.6 5.3 55.1 4.1.6 2.3 1.4 4.6 2.5 6.7v.1c8.3 16.7 23.8 24.3 40.3 23 16.6-1.3 34.1-11 48.3-27.9 13.6-16.4 36-23.2 50.9-32.2 7.4-4.5 13.4-10.1 13.9-18.3.4-8.2-4.4-17.3-15.5-29.7zM223.7 87.3c9.8-22.2 34.2-21.8 44-.4 6.5 14.2 3.6 30.9-4.3 40.4-1.6-.8-5.9-2.6-12.6-4.9 1.1-1.2 3.1-2.7 3.9-4.6 4.8-11.8-.2-27-9.1-27.3-7.3-.5-13.9 10.8-11.8 23-4.1-2-9.4-3.5-13-4.4-1-6.9-.3-14.6 2.9-21.8zM183 75.8c10.1 0 20.8 14.2 19.1 33.5-3.5 1-7.1 2.5-10.2 4.6 1.2-8.9-3.3-20.1-9.6-19.6-8.4.7-9.8 21.2-1.8 28.1 1 .8 1.9-.2-5.9 5.5-15.6-14.6-10.5-52.1 8.4-52.1zm-13.6 60.7c6.2-4.6 13.6-10 14.1-10.5 4.7-4.4 13.5-14.2 27.9-14.2 7.1 0 15.6 2.3 25.9 8.9 6.3 4.1 11.3 4.4 22.6 9.3 8.4 3.5 13.7 9.7 10.5 18.2-2.6 7.1-11 14.4-22.7 18.1-11.1 3.6-19.8 16-38.2 14.9-3.9-.2-7-1-9.6-2.1-8-3.5-12.2-10.4-20-15-8.6-4.8-13.2-10.4-14.7-15.3-1.4-4.9 0-9 4.2-12.3zm3.3 334c-2.7 35.1-43.9 34.4-75.3 18-29.9-15.8-68.6-6.5-76.5-21.9-2.4-4.7-2.4-12.7 2.6-26.4v-.2c2.4-7.6.6-16-.6-23.9-1.2-7.8-1.8-15 .9-20 3.5-6.7 8.5-9.1 14.8-11.3 10.3-3.7 11.8-3.4 19.6-9.9 5.5-5.7 9.5-12.9 14.3-18 5.1-5.5 10-8.1 17.7-6.9 8.1 1.2 15.1 6.8 21.9 16l19.6 35.6c9.5 19.9 43.1 48.4 41 68.9zm-1.4-25.9c-4.1-6.6-9.6-13.6-14.4-19.6 7.1 0 14.2-2.2 16.7-8.9 2.3-6.2 0-14.9-7.4-24.9-13.5-18.2-38.3-32.5-38.3-32.5-13.5-8.4-21.1-18.7-24.6-29.9s-3-23.3-.3-35.2c5.2-22.9 18.6-45.2 27.2-59.2 2.3-1.7.8 3.2-8.7 20.8-8.5 16.1-24.4 53.3-2.6 82.4.6-20.7 5.5-41.8 13.8-61.5 12-27.4 37.3-74.9 39.3-112.7 1.1.8 4.6 3.2 6.2 4.1 4.6 2.7 8.1 6.7 12.6 10.3 12.4 10 28.5 9.2 42.4 1.2 6.2-3.5 11.2-7.5 15.9-9 9.9-3.1 17.8-8.6 22.3-15 7.7 30.4 25.7 74.3 37.2 95.7 6.1 11.4 18.3 35.5 23.6 64.6 3.3-.1 7 .4 10.9 1.4 13.8-35.7-11.7-74.2-23.3-84.9-4.7-4.6-4.9-6.6-2.6-6.5 12.6 11.2 29.2 33.7 35.2 59 2.8 11.6 3.3 23.7.4 35.7 16.4 6.8 35.9 17.9 30.7 34.8-2.2-.1-3.2 0-4.2 0 3.2-10.1-3.9-17.6-22.8-26.1-19.6-8.6-36-8.6-38.3 12.5-12.1 4.2-18.3 14.7-21.4 27.3-2.8 11.2-3.6 24.7-4.4 39.9-.5 7.7-3.6 18-6.8 29-32.1 22.9-76.7 32.9-114.3 7.2zm257.4-11.5c-.9 16.8-41.2 19.9-63.2 46.5-13.2 15.7-29.4 24.4-43.6 25.5s-26.5-4.8-33.7-19.3c-4.7-11.1-2.4-23.1 1.1-36.3 3.7-14.2 9.2-28.8 9.9-40.6.8-15.2 1.7-28.5 4.2-38.7 2.6-10.3 6.6-17.2 13.7-21.1.3-.2.7-.3 1-.5.8 13.2 7.3 26.6 18.8 29.5 12.6 3.3 30.7-7.5 38.4-16.3 9-.3 15.7-.9 22.6 5.1 9.9 8.5 7.1 30.3 17.1 41.6 10.6 11.6 14 19.5 13.7 24.6zM173.3 148.7c2 1.9 4.7 4.5 8 7.1 6.6 5.2 15.8 10.6 27.3 10.6 11.6 0 22.5-5.9 31.8-10.8 4.9-2.6 10.9-7 14.8-10.4s5.9-6.3 3.1-6.6-2.6 2.6-6 5.1c-4.4 3.2-9.7 7.4-13.9 9.8-7.4 4.2-19.5 10.2-29.9 10.2s-18.7-4.8-24.9-9.7c-3.1-2.5-5.7-5-7.7-6.9-1.5-1.4-1.9-4.6-4.3-4.9-1.4-.1-1.8 3.7 1.7 6.5z"/></svg>
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    <script id="__config" type="application/json">{"base": "../../..", "features": ["navigation.instant", "navigation.tabs", "navigation.tracking", "navigation.indexes", "navigation.sections", "navigation.expand", "navigation.prune", "navigation.path", "toc.follow", "navigation.top", "search.suggest", "search.highlight", "search.share", "navigation.footer", "content.code.copy", "content.action.view"], "search": "../../../assets/javascripts/workers/search.b8dbb3d2.min.js", "translations": {"clipboard.copied": "\u5df2\u590d\u5236", "clipboard.copy": "\u590d\u5236", "search.result.more.one": "\u5728\u8be5\u9875\u4e0a\u8fd8\u6709 1 \u4e2a\u7b26\u5408\u6761\u4ef6\u7684\u7ed3\u679c", "search.result.more.other": "\u5728\u8be5\u9875\u4e0a\u8fd8\u6709 # \u4e2a\u7b26\u5408\u6761\u4ef6\u7684\u7ed3\u679c", "search.result.none": "\u6ca1\u6709\u627e\u5230\u7b26\u5408\u6761\u4ef6\u7684\u7ed3\u679c", "search.result.one": "\u627e\u5230 1 \u4e2a\u7b26\u5408\u6761\u4ef6\u7684\u7ed3\u679c", "search.result.other": "# \u4e2a\u7b26\u5408\u6761\u4ef6\u7684\u7ed3\u679c", "search.result.placeholder": "\u952e\u5165\u4ee5\u5f00\u59cb\u641c\u7d22", "search.result.term.missing": "\u7f3a\u5c11", "select.version": "\u9009\u62e9\u5f53\u524d\u7248\u672c"}}</script>
    
    
      <script src="../../../assets/javascripts/bundle.af256bd8.min.js"></script>
      
        <script src="../../../js/mathjax.js"></script>
      
        <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
      
        <script src="https://cdn.bootcss.com/mathjax/3.0.5/es5/tex-mml-chtml.js"></script>
      
    
  <script id="init-glightbox">const lightbox = GLightbox({"touchNavigation": true, "loop": false, "zoomable": true, "draggable": true, "openEffect": "zoom", "closeEffect": "zoom", "slideEffect": "slide"});
document$.subscribe(() => { lightbox.reload() });
</script></body>
</html>